<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stylianos Kotsopoulos">
<meta name="dcterms.date" content="2025-10-19">

<title>Session 1: LSTMs for Earth Observation Time Series – CoPhil EO AI/ML Training</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../day4/sessions/session2.html" rel="next">
<link href="../../day4/index.html" rel="prev">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c9822816d3895e59fda95a6fa7545fef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3775014fae9fc394bbda1d6ff89dd45e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-509191933"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-509191933', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="mermaid-theme" content="default">
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/custom.css">
<link rel="stylesheet" href="../../styles/phase2-enhancements.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CoPhil EO AI/ML Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-training-days" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Training Days</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-training-days">    
        <li>
    <a class="dropdown-item" href="../../day1/index.html">
 <span class="dropdown-text">Day 1: EO Data &amp; Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day2/index.html">
 <span class="dropdown-text">Day 2: Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day3/index.html">
 <span class="dropdown-text">Day 3: Deep Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day4/index.html">
 <span class="dropdown-text">Day 4: Advanced Topics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../../resources/setup.html">
 <span class="dropdown-text">Setup Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/philippine-eo.html">
 <span class="dropdown-text">Philippine EO Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/cheatsheets.html">
 <span class="dropdown-text">Cheat Sheets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/faq.html">
 <span class="dropdown-text">FAQ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/glossary.html">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../resources/downloads.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Materials</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day4/sessions/session1.html">Sessions</a></li><li class="breadcrumb-item"><a href="../../day4/sessions/session1.html">Session 1: LSTMs for Earth Observation Time Series</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 4: Time Series Analysis, Emerging Trends, and Sustainable Learning</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Sessions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/sessions/session1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Session 1: LSTMs for Earth Observation Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/sessions/session2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 2: LSTM Drought Monitoring Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/sessions/session3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 3: Emerging AI Trends in Earth Observation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/sessions/session4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 4: Synthesis, Q&amp;A, and Pathway to Continued Learning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/notebooks/day4_session1_lstm_demo_STUDENT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 4, Session 1: LSTMs for Earth Observation Time Series</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day4/notebooks/day4_session2_lstm_drought_lab_STUDENT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 4, Session 2: LSTM Drought Monitoring Lab</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#session-1-lstms-for-earth-observation-time-series" id="toc-session-1-lstms-for-earth-observation-time-series" class="nav-link active" data-scroll-target="#session-1-lstms-for-earth-observation-time-series">Session 1: LSTMs for Earth Observation Time Series</a>
  <ul class="collapse">
  <li><a href="#understanding-recurrent-neural-networks-and-long-short-term-memory-for-temporal-analysis" id="toc-understanding-recurrent-neural-networks-and-long-short-term-memory-for-temporal-analysis" class="nav-link" data-scroll-target="#understanding-recurrent-neural-networks-and-long-short-term-memory-for-temporal-analysis">Understanding Recurrent Neural Networks and Long Short-Term Memory for Temporal Analysis</a></li>
  </ul></li>
  <li><a href="#session-overview" id="toc-session-overview" class="nav-link" data-scroll-target="#session-overview">Session Overview</a></li>
  <li><a href="#presentation-slides" id="toc-presentation-slides" class="nav-link" data-scroll-target="#presentation-slides">Presentation Slides</a></li>
  <li><a href="#session-details" id="toc-session-details" class="nav-link" data-scroll-target="#session-details">Session Details</a></li>
  <li><a href="#part-1-time-series-in-earth-observation-20-minutes" id="toc-part-1-time-series-in-earth-observation-20-minutes" class="nav-link" data-scroll-target="#part-1-time-series-in-earth-observation-20-minutes">Part 1: Time Series in Earth Observation (20 minutes)</a>
  <ul class="collapse">
  <li><a href="#why-time-series-matter" id="toc-why-time-series-matter" class="nav-link" data-scroll-target="#why-time-series-matter">Why Time Series Matter</a></li>
  <li><a href="#common-eo-time-series" id="toc-common-eo-time-series" class="nav-link" data-scroll-target="#common-eo-time-series">Common EO Time Series</a></li>
  <li><a href="#philippine-context-seasonal-patterns" id="toc-philippine-context-seasonal-patterns" class="nav-link" data-scroll-target="#philippine-context-seasonal-patterns">Philippine Context: Seasonal Patterns</a></li>
  <li><a href="#applications-for-lstm-time-series-forecasting" id="toc-applications-for-lstm-time-series-forecasting" class="nav-link" data-scroll-target="#applications-for-lstm-time-series-forecasting">Applications for LSTM Time Series Forecasting</a></li>
  </ul></li>
  <li><a href="#part-2-recurrent-neural-networks-and-their-limitations-20-minutes" id="toc-part-2-recurrent-neural-networks-and-their-limitations-20-minutes" class="nav-link" data-scroll-target="#part-2-recurrent-neural-networks-and-their-limitations-20-minutes">Part 2: Recurrent Neural Networks and Their Limitations (20 minutes)</a>
  <ul class="collapse">
  <li><a href="#why-standard-neural-networks-fail-for-sequences" id="toc-why-standard-neural-networks-fail-for-sequences" class="nav-link" data-scroll-target="#why-standard-neural-networks-fail-for-sequences">Why Standard Neural Networks Fail for Sequences</a></li>
  <li><a href="#recurrent-neural-networks-rnns" id="toc-recurrent-neural-networks-rnns" class="nav-link" data-scroll-target="#recurrent-neural-networks-rnns">Recurrent Neural Networks (RNNs)</a></li>
  <li><a href="#the-vanishing-gradient-problem" id="toc-the-vanishing-gradient-problem" class="nav-link" data-scroll-target="#the-vanishing-gradient-problem">The Vanishing Gradient Problem</a></li>
  </ul></li>
  <li><a href="#part-3-lstm-architecture---the-solution-30-minutes" id="toc-part-3-lstm-architecture---the-solution-30-minutes" class="nav-link" data-scroll-target="#part-3-lstm-architecture---the-solution-30-minutes">Part 3: LSTM Architecture - The Solution (30 minutes)</a>
  <ul class="collapse">
  <li><a href="#what-is-an-lstm" id="toc-what-is-an-lstm" class="nav-link" data-scroll-target="#what-is-an-lstm">What is an LSTM?</a></li>
  <li><a href="#lstm-cell-structure" id="toc-lstm-cell-structure" class="nav-link" data-scroll-target="#lstm-cell-structure">LSTM Cell Structure</a></li>
  <li><a href="#the-three-gates-explained" id="toc-the-three-gates-explained" class="nav-link" data-scroll-target="#the-three-gates-explained">The Three Gates Explained</a></li>
  <li><a href="#cell-state-update" id="toc-cell-state-update" class="nav-link" data-scroll-target="#cell-state-update">Cell State Update</a></li>
  <li><a href="#why-lstms-solve-vanishing-gradients" id="toc-why-lstms-solve-vanishing-gradients" class="nav-link" data-scroll-target="#why-lstms-solve-vanishing-gradients">Why LSTMs Solve Vanishing Gradients</a></li>
  </ul></li>
  <li><a href="#part-4-lstm-for-eo-time-series-20-minutes" id="toc-part-4-lstm-for-eo-time-series-20-minutes" class="nav-link" data-scroll-target="#part-4-lstm-for-eo-time-series-20-minutes">Part 4: LSTM for EO Time Series (20 minutes)</a>
  <ul class="collapse">
  <li><a href="#lstm-network-architecture-for-forecasting" id="toc-lstm-network-architecture-for-forecasting" class="nav-link" data-scroll-target="#lstm-network-architecture-for-forecasting">LSTM Network Architecture for Forecasting</a></li>
  <li><a href="#input-data-preparation" id="toc-input-data-preparation" class="nav-link" data-scroll-target="#input-data-preparation">Input Data Preparation</a></li>
  <li><a href="#training-process" id="toc-training-process" class="nav-link" data-scroll-target="#training-process">Training Process</a></li>
  <li><a href="#hyperparameters-to-tune" id="toc-hyperparameters-to-tune" class="nav-link" data-scroll-target="#hyperparameters-to-tune">Hyperparameters to Tune</a></li>
  </ul></li>
  <li><a href="#philippine-applications" id="toc-philippine-applications" class="nav-link" data-scroll-target="#philippine-applications">Philippine Applications</a>
  <ul class="collapse">
  <li><a href="#case-study-mindanao-drought-monitoring" id="toc-case-study-mindanao-drought-monitoring" class="nav-link" data-scroll-target="#case-study-mindanao-drought-monitoring">Case Study: Mindanao Drought Monitoring</a></li>
  <li><a href="#other-philippine-eo-lstm-applications" id="toc-other-philippine-eo-lstm-applications" class="nav-link" data-scroll-target="#other-philippine-eo-lstm-applications">Other Philippine EO + LSTM Applications</a></li>
  </ul></li>
  <li><a href="#interactive-demo" id="toc-interactive-demo" class="nav-link" data-scroll-target="#interactive-demo">Interactive Demo</a>
  <ul class="collapse">
  <li><a href="#lstm-architecture-visualization" id="toc-lstm-architecture-visualization" class="nav-link" data-scroll-target="#lstm-architecture-visualization">LSTM Architecture Visualization</a></li>
  </ul></li>
  <li><a href="#hands-on-exercise-build-your-first-lstm" id="toc-hands-on-exercise-build-your-first-lstm" class="nav-link" data-scroll-target="#hands-on-exercise-build-your-first-lstm">Hands-On Exercise: Build Your First LSTM</a></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#preparation-for-session-2" id="toc-preparation-for-session-2" class="nav-link" data-scroll-target="#preparation-for-session-2">Preparation for Session 2</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a>
  <ul class="collapse">
  <li><a href="#research-papers" id="toc-research-papers" class="nav-link" data-scroll-target="#research-papers">Research Papers</a></li>
  <li><a href="#tutorials" id="toc-tutorials" class="nav-link" data-scroll-target="#tutorials">Tutorials</a></li>
  <li><a href="#philippine-eo-data" id="toc-philippine-eo-data" class="nav-link" data-scroll-target="#philippine-eo-data">Philippine EO Data</a></li>
  </ul></li>
  <li><a href="#questions-discussion" id="toc-questions-discussion" class="nav-link" data-scroll-target="#questions-discussion">Questions &amp; Discussion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day4/sessions/session1.html">Sessions</a></li><li class="breadcrumb-item"><a href="../../day4/sessions/session1.html">Session 1: LSTMs for Earth Observation Time Series</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Session 1: LSTMs for Earth Observation Time Series</h1>
<p class="subtitle lead">Understanding Recurrent Neural Networks and Long Short-Term Memory for Temporal Analysis</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Instructor</div>
    <div class="quarto-title-meta-contents">
             <p>Stylianos Kotsopoulos </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Date</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 19, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<nav class="breadcrumb" aria-label="Breadcrumb">
<a href="../../index.html">Home</a> <span class="breadcrumb-separator" aria-hidden="true">›</span> <a href="../index.html">Day 4</a> <span class="breadcrumb-separator" aria-hidden="true">›</span> <span class="breadcrumb-current">Session 1</span>
</nav>
<section id="session-1-lstms-for-earth-observation-time-series" class="level1 hero">
<h1>Session 1: LSTMs for Earth Observation Time Series</h1>
<section id="understanding-recurrent-neural-networks-and-long-short-term-memory-for-temporal-analysis" class="level3">
<h3 class="anchored" data-anchor-id="understanding-recurrent-neural-networks-and-long-short-term-memory-for-temporal-analysis">Understanding Recurrent Neural Networks and Long Short-Term Memory for Temporal Analysis</h3>
<p>Master the power of LSTMs for predicting future conditions from time series Earth observation data</p>
</section>
</section>
<section id="session-overview" class="level2">
<h2 class="anchored" data-anchor-id="session-overview">Session Overview</h2>
<p>This 1.5-hour session introduces Long Short-Term Memory (LSTM) networks, a specialized type of recurrent neural network designed to learn patterns in sequential data. You’ll understand why LSTMs are powerful for Earth observation time series analysis and see their architecture in action.</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this session, you will be able to:</p>
<ol type="1">
<li><strong>Explain</strong> why time series analysis is critical for Earth observation applications</li>
<li><strong>Understand</strong> the limitations of standard neural networks for sequential data</li>
<li><strong>Describe</strong> the LSTM architecture and how it solves the vanishing gradient problem</li>
<li><strong>Identify</strong> appropriate EO applications for LSTM-based forecasting</li>
<li><strong>Visualize</strong> how LSTM gates control information flow</li>
<li><strong>Recognize</strong> the advantages of LSTMs over traditional RNNs</li>
</ol>
</div>
</div>
</section>
<section id="presentation-slides" class="level2">
<h2 class="anchored" data-anchor-id="presentation-slides">Presentation Slides</h2>
<iframe src="../presentations/session1_lstm_time_series.html" width="100%" height="600" style="border: 1px solid #ccc; border-radius: 4px;">
</iframe>
<hr>
</section>
<section id="session-details" class="level2">
<h2 class="anchored" data-anchor-id="session-details">Session Details</h2>
<div class="session-info">
<p><strong>Duration:</strong> 1.5 hours (90 minutes) | <strong>Format:</strong> Theory + Interactive Demo | <strong>Difficulty:</strong> Intermediate</p>
<p><strong>Prerequisites:</strong> - Understanding of CNNs from Day 3, Session 3 - Basic knowledge of neural network training - Familiarity with time series concepts - Python fundamentals</p>
<p><strong>Materials Provided:</strong> - Theory presentation slides - Interactive LSTM architecture notebook - Gradient problem demonstration - Philippine EO time series examples</p>
</div>
<hr>
</section>
<section id="part-1-time-series-in-earth-observation-20-minutes" class="level2">
<h2 class="anchored" data-anchor-id="part-1-time-series-in-earth-observation-20-minutes">Part 1: Time Series in Earth Observation (20 minutes)</h2>
<section id="why-time-series-matter" class="level3">
<h3 class="anchored" data-anchor-id="why-time-series-matter">Why Time Series Matter</h3>
<p>Earth observation data is inherently <strong>temporal</strong> - we observe the same locations repeatedly over time. This temporal dimension unlocks powerful insights:</p>
<p><strong>Static Analysis (Single Date):</strong> - Land cover classification - Feature detection - Snapshot assessments</p>
<p><strong>Time Series Analysis (Multi-Date):</strong> - Vegetation phenology and growth cycles - Drought onset and recovery - Crop yield forecasting - Deforestation detection - Seasonal pattern analysis - Climate change trend identification</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Time Series: The Fourth Dimension of EO
</div>
</div>
<div class="callout-body-container callout-body">
<p>While CNNs excel at extracting spatial patterns from individual satellite images, <strong>LSTMs excel at extracting temporal patterns</strong> from sequences of observations. Together, they form powerful tools for spatiotemporal analysis.</p>
</div>
</div>
</section>
<section id="common-eo-time-series" class="level3">
<h3 class="anchored" data-anchor-id="common-eo-time-series">Common EO Time Series</h3>
<p><strong>Vegetation Indices:</strong> - <strong>NDVI (Normalized Difference Vegetation Index):</strong> Tracks vegetation health, crop growth stages, drought stress - <strong>EVI (Enhanced Vegetation Index):</strong> Better for high-biomass areas like tropical forests - <strong>SAVI (Soil-Adjusted Vegetation Index):</strong> Reduces soil background effects</p>
<p><strong>Backscatter Time Series (SAR):</strong> - <strong>VV, VH polarization:</strong> Changes indicate flooding, harvest, vegetation structure changes - <strong>Coherence:</strong> Measures surface stability over time</p>
<p><strong>Biophysical Parameters:</strong> - <strong>LAI (Leaf Area Index):</strong> Crop canopy development - <strong>FPAR (Fraction of Photosynthetically Active Radiation):</strong> Productivity indicator - <strong>LST (Land Surface Temperature):</strong> Heat stress, urban heat island</p>
<p><strong>Precipitation and Climate Variables:</strong> - Rainfall accumulation - Soil moisture - Temperature anomalies</p>
</section>
<section id="philippine-context-seasonal-patterns" class="level3">
<h3 class="anchored" data-anchor-id="philippine-context-seasonal-patterns">Philippine Context: Seasonal Patterns</h3>
<p><strong>Mindanao Agricultural Cycles:</strong></p>
<p>The Philippines exhibits distinct seasonal patterns critical for agricultural monitoring:</p>
<p><strong>Dry Season (November - April):</strong> - Lower NDVI values in rain-fed areas - Reduced soil moisture - Increased drought risk in Mindanao</p>
<p><strong>Wet Season (May - October):</strong> - Peak NDVI during vegetative growth - Rice planting and growing seasons - Flood risk in typhoon-prone areas</p>
<p><strong>El Niño/La Niña Impacts:</strong> - <strong>El Niño:</strong> Prolonged dry conditions, delayed planting, reduced yields - <strong>La Niña:</strong> Enhanced rainfall, potential flooding, pest outbreaks</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Mindanao Case Study
</div>
</div>
<div class="callout-body-container callout-body">
<p>Bukidnon and South Cotabato provinces in Mindanao are major agricultural regions producing: - Corn (maize) - Rice - Pineapple - Coffee - Sugarcane</p>
<p>These areas experienced severe drought during the <strong>2015-2016 El Niño</strong>, causing significant crop losses. Predicting drought conditions 1-3 months in advance enables early interventions (irrigation, crop insurance, food security planning).</p>
</div>
</div>
</section>
<section id="applications-for-lstm-time-series-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="applications-for-lstm-time-series-forecasting">Applications for LSTM Time Series Forecasting</h3>
<p><strong>1. Drought Forecasting</strong> - <strong>Input:</strong> Historical NDVI, rainfall, temperature sequences - <strong>Output:</strong> Predicted NDVI or drought severity 1-3 months ahead - <strong>Benefit:</strong> Early warning for agricultural planning</p>
<p><strong>2. Crop Yield Prediction</strong> - <strong>Input:</strong> In-season NDVI, weather, SAR time series - <strong>Output:</strong> Estimated yield at harvest - <strong>Benefit:</strong> Food security planning, market forecasting</p>
<p><strong>3. Flood Risk Assessment</strong> - <strong>Input:</strong> Precipitation sequences, river discharge, soil moisture - <strong>Output:</strong> Predicted flood probability - <strong>Benefit:</strong> Disaster preparedness</p>
<p><strong>4. Land Cover Change Detection</strong> - <strong>Input:</strong> Multi-temporal optical and SAR data - <strong>Output:</strong> Change probability, anomaly detection - <strong>Benefit:</strong> Deforestation monitoring, illegal land use detection</p>
<p><strong>5. Phenology Monitoring</strong> - <strong>Input:</strong> NDVI/EVI time series across growing season - <strong>Output:</strong> Predicted crop stage, harvest date - <strong>Benefit:</strong> Precision agriculture, crop insurance</p>
<hr>
</section>
</section>
<section id="part-2-recurrent-neural-networks-and-their-limitations-20-minutes" class="level2">
<h2 class="anchored" data-anchor-id="part-2-recurrent-neural-networks-and-their-limitations-20-minutes">Part 2: Recurrent Neural Networks and Their Limitations (20 minutes)</h2>
<section id="why-standard-neural-networks-fail-for-sequences" class="level3">
<h3 class="anchored" data-anchor-id="why-standard-neural-networks-fail-for-sequences">Why Standard Neural Networks Fail for Sequences</h3>
<p><strong>Feedforward Neural Networks</strong> (including CNNs) have a critical limitation: they assume inputs are <strong>independent</strong>.</p>
<p><strong>Problem with Sequential Data:</strong> - Each input depends on previous inputs - Context matters: The meaning of today’s NDVI value depends on the trend over the past weeks - Fixed input size: How do you handle variable-length sequences?</p>
<p><strong>Example:</strong> Predicting next month’s vegetation health</p>
<p>A feedforward network treats each month independently: - March NDVI → Prediction (no memory) - April NDVI → Prediction (no memory of March)</p>
<p>But we know: - If NDVI has been declining for 3 months, drought is likely worsening - If NDVI declined then recovered, conditions improved</p>
<p><strong>Solution:</strong> Networks that maintain <strong>memory</strong> of previous inputs.</p>
</section>
<section id="recurrent-neural-networks-rnns" class="level3">
<h3 class="anchored" data-anchor-id="recurrent-neural-networks-rnns">Recurrent Neural Networks (RNNs)</h3>
<p><strong>Key Idea:</strong> Add a <strong>feedback loop</strong> so the network remembers previous inputs.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    X1[Input t-1] --&gt; H1[Hidden State]
    H1 --&gt; O1[Output t-1]
    H1 -.-&gt;|Memory| H2[Hidden State]
    X2[Input t] --&gt; H2
    H2 --&gt; O2[Output t]
    H2 -.-&gt;|Memory| H3[Hidden State]
    X3[Input t+1] --&gt; H3
    H3 --&gt; O3[Output t+1]

    style H1 fill:#4A90E2
    style H2 fill:#4A90E2
    style H3 fill:#4A90E2
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>How RNNs Work:</strong></p>
<p>At each time step <code>t</code>: 1. Receive input <code>x_t</code> (e.g., current month’s NDVI) 2. Combine with previous hidden state <code>h_{t-1}</code> (memory) 3. Compute new hidden state <code>h_t</code> 4. Produce output <code>y_t</code> 5. Pass <code>h_t</code> to next time step</p>
<p><strong>Mathematical Formulation:</strong> <span class="math display">\[
h_t = \text{tanh}(W_{hh} \cdot h_{t-1} + W_{xh} \cdot x_t + b_h)
\]</span> <span class="math display">\[
y_t = W_{hy} \cdot h_t + b_y
\]</span></p>
<p><strong>RNN Advantages:</strong> - Handles variable-length sequences - Maintains memory across time steps - Shares weights across time (parameter efficiency)</p>
</section>
<section id="the-vanishing-gradient-problem" class="level3">
<h3 class="anchored" data-anchor-id="the-vanishing-gradient-problem">The Vanishing Gradient Problem</h3>
<p><strong>Critical Flaw of Standard RNNs:</strong></p>
<p>When training on long sequences (e.g., 24 months of NDVI data), gradients become extremely small as they propagate backward through time.</p>
<p><strong>Why This Happens:</strong></p>
<p>During backpropagation through time, gradients are multiplied repeatedly: <span class="math display">\[
\frac{\partial L}{\partial h_1} = \frac{\partial L}{\partial h_T} \cdot \frac{\partial h_T}{\partial h_{T-1}} \cdot \ldots \cdot \frac{\partial h_2}{\partial h_1}
\]</span></p>
<p>If each derivative term is &lt; 1, the product shrinks exponentially.</p>
<p><strong>Consequences:</strong> - <strong>Vanishing gradients:</strong> Network cannot learn long-term dependencies (e.g., drought conditions from 6 months ago) - <strong>Exploding gradients:</strong> Less common, but gradients can also grow exponentially</p>
<p><strong>Impact on EO Applications:</strong></p>
<p>Imagine predicting drought in August based on: - Recent data (July): RNN learns this easily - Medium-term data (April-June): Partially learned - Long-term data (January-March): <strong>Lost due to vanishing gradients</strong></p>
<p>But the January-March dry season conditions are critical for August drought prediction!</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>🎯 Mini-Challenge 1: Calculate Gradient Decay
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Task:</strong> Calculate how many time steps it takes for a gradient of 0.9 to shrink below 0.01.</p>
<p><strong>Formula:</strong> <span class="math inline">\(0.9^n &lt; 0.01\)</span></p>
<p><strong>Solve for n:</strong> How many steps?</p>
<p><strong>Interpretation:</strong> What does this mean for analyzing a full year (12 months) of NDVI data with a standard RNN?</p>
<p><em>Hint: Use logarithms or trial-and-error in Python</em></p>
<details>
<summary>
Click to reveal answer
</summary>
<p><span class="math inline">\(n = \frac{\log(0.01)}{\log(0.9)} \approx 44\)</span> time steps</p>
<p><strong>Meaning:</strong> A standard RNN can only effectively learn patterns from the most recent ~44 time steps. For monthly data, that’s less than 4 years. For 10-day composites, less than 15 months. <strong>This is why LSTMs are essential for long-term EO analysis!</strong></p>
</details>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Vanishing Gradient Demonstration
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the interactive notebook, you’ll visualize: - Gradient magnitude decay over 50 time steps - How standard RNN fails to learn dependencies beyond ~10 steps - Why this prevents accurate long-term forecasting</p>
</div>
</div>
<hr>
</section>
</section>
<section id="part-3-lstm-architecture---the-solution-30-minutes" class="level2">
<h2 class="anchored" data-anchor-id="part-3-lstm-architecture---the-solution-30-minutes">Part 3: LSTM Architecture - The Solution (30 minutes)</h2>
<section id="what-is-an-lstm" class="level3">
<h3 class="anchored" data-anchor-id="what-is-an-lstm">What is an LSTM?</h3>
<p><strong>Long Short-Term Memory (LSTM)</strong> networks were designed specifically to solve the vanishing gradient problem.</p>
<p><strong>Key Innovation:</strong> Replace simple hidden state with a <strong>memory cell</strong> controlled by learnable <strong>gates</strong>.</p>
<p><strong>LSTM Advantages:</strong> - Learn long-term dependencies (100+ time steps) - Selective memory: Remember important information, forget irrelevant - Gradient flow preserved through time</p>
</section>
<section id="lstm-cell-structure" class="level3">
<h3 class="anchored" data-anchor-id="lstm-cell-structure">LSTM Cell Structure</h3>
<p>An LSTM cell has: - <strong>Cell State (C_t):</strong> Long-term memory “conveyor belt” - <strong>Hidden State (h_t):</strong> Short-term memory and output - <strong>Three Gates:</strong> Control information flow</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    subgraph LSTM["LSTM Cell at time t"]
        Input[Input x_t]
        PrevH[Previous h_{t-1}]
        PrevC[Previous C_{t-1}]

        FG[Forget Gate&lt;br/&gt;σ]
        IG[Input Gate&lt;br/&gt;σ]
        CT[Cell Candidate&lt;br/&gt;tanh]
        OG[Output Gate&lt;br/&gt;σ]

        NewC[New Cell State C_t]
        NewH[New Hidden State h_t]

        Input --&gt; FG
        Input --&gt; IG
        Input --&gt; CT
        Input --&gt; OG

        PrevH --&gt; FG
        PrevH --&gt; IG
        PrevH --&gt; CT
        PrevH --&gt; OG

        PrevC --&gt; FG
        FG --&gt;|Forget| NewC
        IG --&gt;|Add| NewC
        CT --&gt;|Scaled| NewC

        NewC --&gt; OG
        OG --&gt; NewH
    end

    NewC -.-&gt;|To next cell| PrevC
    NewH -.-&gt;|To next cell| PrevH

    style FG fill:#E74C3C
    style IG fill:#3498DB
    style OG fill:#2ECC71
    style NewC fill:#F39C12
    style NewH fill:#9B59B6
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="the-three-gates-explained" class="level3">
<h3 class="anchored" data-anchor-id="the-three-gates-explained">The Three Gates Explained</h3>
<p><strong>1. Forget Gate</strong></p>
<p><strong>Purpose:</strong> Decide what information to discard from cell state</p>
<p><strong>Question:</strong> “Should I forget old information?”</p>
<p><strong>Example:</strong> Dry season ended, so forget drought stress patterns</p>
<p><strong>Equation:</strong> <span class="math display">\[
f_t = \sigma(W_f \cdot [h_{t-1}, x_t] + b_f)
\]</span></p>
<p>Output: 0 (forget) to 1 (keep) for each memory dimension</p>
<p><strong>2. Input Gate</strong></p>
<p><strong>Purpose:</strong> Decide what new information to add to cell state</p>
<p><strong>Question:</strong> “What new information should I remember?”</p>
<p><strong>Example:</strong> Wet season started, remember increasing rainfall pattern</p>
<p><strong>Equations:</strong> <span class="math display">\[
i_t = \sigma(W_i \cdot [h_{t-1}, x_t] + b_i)
\]</span> <span class="math display">\[
\tilde{C}_t = \text{tanh}(W_C \cdot [h_{t-1}, x_t] + b_C)
\]</span></p>
<ul>
<li><code>i_t</code>: How much to add (0 to 1)</li>
<li><code>C_tilde_t</code>: Candidate values to add</li>
</ul>
<p><strong>3. Output Gate</strong></p>
<p><strong>Purpose:</strong> Decide what to output based on cell state</p>
<p><strong>Question:</strong> “What should I output this time step?”</p>
<p><strong>Example:</strong> Output current drought risk based on accumulated evidence</p>
<p><strong>Equation:</strong> <span class="math display">\[
o_t = \sigma(W_o \cdot [h_{t-1}, x_t] + b_o)
\]</span> <span class="math display">\[
h_t = o_t \cdot \text{tanh}(C_t)
\]</span></p>
</section>
<section id="cell-state-update" class="level3">
<h3 class="anchored" data-anchor-id="cell-state-update">Cell State Update</h3>
<p><strong>Step 1: Forget old information</strong> <span class="math display">\[
C_t = f_t \cdot C_{t-1}
\]</span></p>
<p><strong>Step 2: Add new information</strong> <span class="math display">\[
C_t = C_t + i_t \cdot \tilde{C}_t
\]</span></p>
<p><strong>Combined:</strong> <span class="math display">\[
C_t = f_t \cdot C_{t-1} + i_t \cdot \tilde{C}_t
\]</span></p>
</section>
<section id="why-lstms-solve-vanishing-gradients" class="level3">
<h3 class="anchored" data-anchor-id="why-lstms-solve-vanishing-gradients">Why LSTMs Solve Vanishing Gradients</h3>
<p><strong>Key Insight:</strong> Cell state acts as a <strong>gradient highway</strong></p>
<p><strong>Standard RNN:</strong> Gradient multiplied by weight matrix at each step → decay</p>
<p><strong>LSTM:</strong> Gradient flows through cell state with only <strong>element-wise operations</strong> (addition, multiplication by gate values)</p>
<p>Since gate values are learned and can be close to 1, gradients flow backward through time with minimal decay.</p>
<p><strong>Result:</strong> - Learn dependencies over 100+ time steps - Remember important events from months ago - Forget irrelevant short-term fluctuations</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>💭 Think-Through Discussion
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Question:</strong> In drought monitoring for Mindanao agriculture, what kind of information might the <strong>forget gate</strong> discard and what might the <strong>input gate</strong> preserve?</p>
<p><strong>Consider:</strong> - Seasonal patterns (wet season → dry season transitions) - Short-term weather noise vs.&nbsp;long-term climate trends - El Niño indicators appearing months before drought onset - Normal year-to-year NDVI fluctuations vs.&nbsp;anomalies</p>
<p><strong>Reflection:</strong> How would the gates behave differently when processing: 1. A typical seasonal NDVI decline (expected) 2. An anomalous drought event (unexpected)</p>
<p><em>Discuss with your peers or reflect on this in the notebook exercises</em></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Interactive Visualization
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the demo notebook, you’ll manipulate gate values and see: - How forget gate controls memory retention - How input gate decides what to memorize - How output gate controls predictions - Cell state evolution over a 24-month NDVI sequence</p>
</div>
</div>
<hr>
</section>
</section>
<section id="part-4-lstm-for-eo-time-series-20-minutes" class="level2">
<h2 class="anchored" data-anchor-id="part-4-lstm-for-eo-time-series-20-minutes">Part 4: LSTM for EO Time Series (20 minutes)</h2>
<section id="lstm-network-architecture-for-forecasting" class="level3">
<h3 class="anchored" data-anchor-id="lstm-network-architecture-for-forecasting">LSTM Network Architecture for Forecasting</h3>
<p><strong>Typical LSTM Setup for EO:</strong></p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TB
    Input[Input Sequence&lt;br/&gt;NDVI for 12 months]

    LSTM1[LSTM Layer 1&lt;br/&gt;64 units]
    LSTM2[LSTM Layer 2&lt;br/&gt;32 units]

    Dense1[Dense Layer&lt;br/&gt;16 units, ReLU]
    Dense2[Dense Layer&lt;br/&gt;1 unit, linear]

    Output[Output&lt;br/&gt;Predicted NDVI month 13]

    Input --&gt; LSTM1
    LSTM1 --&gt; LSTM2
    LSTM2 --&gt; Dense1
    Dense1 --&gt; Dense2
    Dense2 --&gt; Output

    style LSTM1 fill:#4A90E2
    style LSTM2 fill:#4A90E2
    style Output fill:#2ECC71
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><strong>Components:</strong> - <strong>Input Layer:</strong> Sequence of observations (e.g., 12 months of NDVI) - <strong>LSTM Layers:</strong> Extract temporal patterns (1-2 layers typical) - <strong>Dense Layers:</strong> Map LSTM output to prediction - <strong>Output Layer:</strong> Predicted value(s)</p>
</section>
<section id="input-data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="input-data-preparation">Input Data Preparation</h3>
<p><strong>Sequence Creation (Sliding Window):</strong></p>
<p>Given monthly NDVI data from 2015-2021, create training sequences:</p>
<p><strong>Lookback Window:</strong> 12 months (1 year) <strong>Forecast Horizon:</strong> 1 month ahead</p>
<p><strong>Example:</strong> - Sequence 1: [Jan 2015, Feb 2015, …, Dec 2015] → Predict Jan 2016 - Sequence 2: [Feb 2015, Mar 2015, …, Jan 2016] → Predict Feb 2016 - Sequence 3: [Mar 2015, Apr 2015, …, Feb 2016] → Predict Mar 2016 - …and so on</p>
<p><strong>Result:</strong> Hundreds or thousands of training sequences from a multi-year time series</p>
<p><strong>Multivariate Inputs:</strong></p>
<p>LSTMs can use multiple features per time step: - NDVI (vegetation health) - Rainfall (water availability) - Temperature (heat stress) - Soil moisture - Previous year same month (seasonal context)</p>
<p><strong>Input Shape:</strong> <code>(samples, time_steps, features)</code></p>
<p>Example: <code>(5000, 12, 4)</code> = 5000 sequences, 12 months lookback, 4 features</p>
</section>
<section id="training-process" class="level3">
<h3 class="anchored" data-anchor-id="training-process">Training Process</h3>
<p><strong>1. Data Splitting:</strong> - Training set: 2015-2019 (80%) - Validation set: 2020 (10%) - Test set: 2021 (10%)</p>
<p><strong>Important:</strong> Use temporal splits (not random) to avoid data leakage</p>
<p><strong>2. Normalization:</strong> Scale features to [0, 1] or standardize to mean=0, std=1</p>
<p><strong>3. Model Compilation:</strong> - <strong>Loss function:</strong> Mean Squared Error (MSE) for regression - <strong>Optimizer:</strong> Adam (adaptive learning rate) - <strong>Metrics:</strong> RMSE, MAE</p>
<p><strong>4. Training:</strong> - Batch size: 32-128 - Epochs: 50-200 (with early stopping) - Monitor validation loss to prevent overfitting</p>
<p><strong>5. Evaluation:</strong> - Test set predictions vs.&nbsp;actual values - Visualize time series predictions - Calculate error metrics</p>
</section>
<section id="hyperparameters-to-tune" class="level3">
<h3 class="anchored" data-anchor-id="hyperparameters-to-tune">Hyperparameters to Tune</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Typical Range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>LSTM units</strong></td>
<td>Hidden state dimensionality</td>
<td>32-256 per layer</td>
</tr>
<tr class="even">
<td><strong>Number of layers</strong></td>
<td>Depth of LSTM stack</td>
<td>1-3</td>
</tr>
<tr class="odd">
<td><strong>Lookback window</strong></td>
<td>How many time steps to use</td>
<td>6-24 months</td>
</tr>
<tr class="even">
<td><strong>Dropout</strong></td>
<td>Regularization to prevent overfitting</td>
<td>0.1-0.3</td>
</tr>
<tr class="odd">
<td><strong>Learning rate</strong></td>
<td>Optimization step size</td>
<td>0.0001-0.01</td>
</tr>
<tr class="even">
<td><strong>Batch size</strong></td>
<td>Samples per gradient update</td>
<td>32-128</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="philippine-applications" class="level2">
<h2 class="anchored" data-anchor-id="philippine-applications">Philippine Applications</h2>
<section id="case-study-mindanao-drought-monitoring" class="level3">
<h3 class="anchored" data-anchor-id="case-study-mindanao-drought-monitoring">Case Study: Mindanao Drought Monitoring</h3>
<p><strong>Objective:</strong> Predict drought conditions 1-3 months ahead for Bukidnon and South Cotabato provinces</p>
<p><strong>Data Sources:</strong> - <strong>Sentinel-2 NDVI:</strong> 2015-2021 (every 10 days, cloud-masked) - <strong>PAGASA rainfall:</strong> Monthly accumulation - <strong>PAGASA temperature:</strong> Monthly mean - <strong>Historical El Niño index (ONI):</strong> NOAA data</p>
<p><strong>Model Setup:</strong> - <strong>Input:</strong> 12-month sequences (NDVI, rainfall, temperature, ONI) - <strong>Output:</strong> NDVI prediction 1 month ahead - <strong>LSTM architecture:</strong> 2 layers (64, 32 units), dropout 0.2</p>
<p><strong>Training:</strong> - Historical data 2015-2019 - Validation on 2020 - Test on 2021</p>
<p><strong>Expected Results:</strong> - RMSE &lt; 0.05 on NDVI scale [0-1] - Early detection of drought onset 1-3 months in advance - Correlation with reported crop losses</p>
<p><strong>Operational Deployment:</strong> - Monthly predictions updated as new Sentinel-2 data arrives - Alerts sent to DA, PAGASA, LGUs when drought risk exceeds threshold - Integration with existing agricultural advisory systems</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Session 2 Lab Preview
</div>
</div>
<div class="callout-body-container callout-body">
<p>Tomorrow’s hands-on lab (Session 2) will implement this full workflow: - Download Sentinel-2 NDVI time series for Mindanao - Prepare sequences and training data - Build and train LSTM model - Evaluate predictions and visualize results - Discuss operational deployment considerations</p>
</div>
</div>
</section>
<section id="other-philippine-eo-lstm-applications" class="level3">
<h3 class="anchored" data-anchor-id="other-philippine-eo-lstm-applications">Other Philippine EO + LSTM Applications</h3>
<p><strong>1. Rice Yield Forecasting (Luzon)</strong> - Input: SAR backscatter (Sentinel-1) + NDVI time series - Output: Yield estimate 1 month before harvest - Benefit: DA food security planning</p>
<p><strong>2. Typhoon Impact Prediction (Visayas)</strong> - Input: Pre-typhoon NDVI, rainfall forecast, wind speed - Output: Expected NDVI drop (damage proxy) - Benefit: Pre-position relief supplies</p>
<p><strong>3. Coral Bleaching Prediction (Palawan)</strong> - Input: Sea surface temperature time series - Output: Bleaching risk 2-4 weeks ahead - Benefit: DENR early warning for marine protected areas</p>
<p><strong>4. Urban Growth Forecasting (Metro Manila)</strong> - Input: Historical built-up area time series - Output: Urban expansion locations - Benefit: MMDA infrastructure planning</p>
<hr>
</section>
</section>
<section id="interactive-demo" class="level2">
<h2 class="anchored" data-anchor-id="interactive-demo">Interactive Demo</h2>
<section id="lstm-architecture-visualization" class="level3">
<h3 class="anchored" data-anchor-id="lstm-architecture-visualization">LSTM Architecture Visualization</h3>
<p><strong>Demo 1: Gate Behavior</strong></p>
<p>Interactive notebook allows you to: - Set gate values (forget, input, output) manually - Observe cell state evolution - See how gates control information flow - Understand selective memory</p>
<p><strong>Demo 2: Vanishing Gradient Problem</strong></p>
<p>Side-by-side comparison: - Standard RNN gradient decay over 50 time steps - LSTM gradient preservation over 50 time steps - Visualization of why LSTMs learn long-term patterns</p>
<p><strong>Demo 3: NDVI Sequence Prediction</strong></p>
<p>Pre-trained LSTM model: - Input: 12 months of synthetic Mindanao NDVI data - Visualize predictions vs.&nbsp;actual for next 3 months - Explore impact of drought vs.&nbsp;normal conditions - See how model captures seasonal patterns</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Notebook Access
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Interactive LSTM Demo Notebook</strong> (includes all demonstrations): - LSTM architecture visualization - Gradient problem demonstration<br>
- Mindanao NDVI time series generation - Complete model building and training</p>
<p>📓 <a href="../../day4/notebooks/day4_session1_lstm_demo_STUDENT.html">Download Student Version</a></p>
<p>📓 <a href="../../day4/notebooks/day4_session1_lstm_demo_INSTRUCTOR.html">Download Instructor Solution</a></p>
<p><strong>Requirements:</strong> - TensorFlow 2.x or PyTorch - NumPy, Matplotlib, Pandas, Scikit-learn - Jupyter Notebook or Google Colab (GPU recommended)</p>
</div>
</div>
<hr>
</section>
</section>
<section id="hands-on-exercise-build-your-first-lstm" class="level2">
<h2 class="anchored" data-anchor-id="hands-on-exercise-build-your-first-lstm">Hands-On Exercise: Build Your First LSTM</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>🎯 Practical Application
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now that you understand the theory, it’s time to build your own LSTM model! The interactive notebook guides you through:</p>
<p><strong>Step 1: Data Preparation</strong> - Generate synthetic Mindanao NDVI time series (2019-2024) - Visualize seasonal patterns and drought events - Create sliding window sequences for LSTM input</p>
<p><strong>Step 2: Understanding Gradients</strong> - Calculate vanishing gradient decay numerically - Compare RNN vs LSTM gradient flow - Visualize why LSTMs work for long sequences</p>
<p><strong>Step 3: Build and Train LSTM</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Creating a simple LSTM model</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential([</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    LSTM(<span class="dv">64</span>, return_sequences<span class="op">=</span><span class="va">True</span>, input_shape<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">1</span>)),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.2</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    LSTM(<span class="dv">32</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    Dropout(<span class="fl">0.2</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">16</span>, activation<span class="op">=</span><span class="st">'relu'</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    Dense(<span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Step 4: Evaluate Predictions</strong> - Compare predictions vs actual NDVI - Calculate RMSE and MAE metrics - Visualize drought prediction accuracy</p>
<p><strong>Expected Results:</strong> - Prediction accuracy: MAE &lt; 0.05 NDVI units - Drought detection: 80%+ accuracy - Training time: ~3-5 minutes on CPU</p>
<p>📓 Open the Student Notebook above to begin!</p>
</div>
</div>
<hr>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Session 1 Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Time Series in EO:</strong> - Time series analysis unlocks temporal patterns invisible in single-date images - Philippine agriculture exhibits strong seasonal cycles (dry/wet seasons, El Niño impacts) - Applications: drought forecasting, crop yield, phenology, change detection</p>
<p><strong>RNNs and Limitations:</strong> - Standard feedforward networks cannot handle sequential dependencies - RNNs add memory through recurrent connections - Vanishing gradient problem prevents learning long-term dependencies (&gt;10 time steps)</p>
<p><strong>LSTM Architecture:</strong> - Three gates (forget, input, output) control information flow - Cell state acts as long-term memory “conveyor belt” - Gradients flow through cell state without decay → learn 100+ time step dependencies - Selective memory: remember important patterns, forget noise</p>
<p><strong>LSTM for EO Forecasting:</strong> - Input: Sequences of observations (sliding windows) - Architecture: Stacked LSTM layers + dense layers - Output: Predicted values 1-N steps ahead - Training: Temporal splits, MSE loss, Adam optimizer</p>
<p><strong>Philippine Context:</strong> - Mindanao drought monitoring: predict NDVI 1-3 months ahead - Multivariate inputs: NDVI + rainfall + temperature + climate indices - Operational potential: early warning for DA, PAGASA, LGUs</p>
<p><strong>Next Session:</strong> Session 2 (tomorrow) implements the full LSTM drought monitoring lab for Mindanao with real Sentinel-2 data!</p>
</div>
</div>
<hr>
</section>
<section id="preparation-for-session-2" class="level2">
<h2 class="anchored" data-anchor-id="preparation-for-session-2">Preparation for Session 2</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Get Ready for Tomorrow’s Lab
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Session 2</strong> is a 2.5-hour hands-on lab implementing LSTM drought forecasting for Mindanao.</p>
<p><strong>To Prepare:</strong> 1. Ensure Python environment is set up with TensorFlow/Keras 2. Review LSTM architecture concepts from today 3. Familiarize yourself with sequence data preparation 4. Think about potential drought indicators beyond NDVI</p>
<p><strong>Software Requirements:</strong> - Python 3.8+ - TensorFlow 2.x (GPU optional but recommended) - Google Earth Engine account (for data download) - Libraries: numpy, pandas, matplotlib, scikit-learn</p>
<p><strong>Data:</strong> Pre-processed Sentinel-2 NDVI time series will be provided, but optional data download instructions included.</p>
<p><a href="../../day4/sessions/session2.html" class="btn btn-outline-primary">Session 2 Preview →</a></p>
</div>
</div>
<hr>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<section id="research-papers" class="level3">
<h3 class="anchored" data-anchor-id="research-papers">Research Papers</h3>
<ul>
<li>Hochreiter &amp; Schmidhuber (1997). “Long Short-Term Memory.” <em>Neural Computation</em>. <a href="https://doi.org/10.1162/neco.1997.9.8.1735">DOI: 10.1162/neco.1997.9.8.1735</a></li>
<li>Gers et al.&nbsp;(2000). “Learning to Forget: Continual Prediction with LSTM.” <em>Neural Computation</em>.</li>
<li>Ndikumana et al.&nbsp;(2018). “Deep Recurrent Neural Network for Agricultural Classification using multitemporal SAR Sentinel-1 for Camargue, France.” <em>Remote Sensing</em>.</li>
</ul>
</section>
<section id="tutorials" class="level3">
<h3 class="anchored" data-anchor-id="tutorials">Tutorials</h3>
<ul>
<li><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">Understanding LSTM Networks (colah’s blog)</a></li>
<li><a href="https://keras.io/examples/timeseries/">Keras LSTM Tutorial</a></li>
<li><a href="https://www.tensorflow.org/tutorials/structured_data/time_series">TensorFlow Time Series Forecasting</a></li>
</ul>
</section>
<section id="philippine-eo-data" class="level3">
<h3 class="anchored" data-anchor-id="philippine-eo-data">Philippine EO Data</h3>
<ul>
<li><a href="https://www.pagasa.dost.gov.ph">PAGASA Climate Data</a></li>
<li><a href="https://infra.copphil.philsa.gov.ph">CoPhil Infrastructure</a></li>
<li><a href="https://earthengine.google.com">Google Earth Engine</a></li>
</ul>
<hr>
</section>
</section>
<section id="questions-discussion" class="level2">
<h2 class="anchored" data-anchor-id="questions-discussion">Questions &amp; Discussion</h2>
<p><strong>Think About:</strong> - What time series problems in your work could benefit from LSTM forecasting? - What input features (beyond NDVI) might improve drought prediction? - How far ahead can we realistically forecast with LSTMs? - What are the limitations and uncertainties?</p>
<p><strong>Instructor Contact:</strong> Email questions to: <a href="mailto:skotsopoulos@neuralio.ai">skotsopoulos@neuralio.ai</a></p>
<hr>
<p><em>This session is part of Day 4: Time Series Analysis, Emerging Trends, and Sustainable Learning - CoPhil 4-Day Advanced Training on AI/ML for Earth Observation, funded by the European Union under the Global Gateway initiative.</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="cophil-training-v1.0" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../day4/index.html" class="pagination-link" aria-label="Day 4: Time Series Analysis, Emerging Trends, and Sustainable Learning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Day 4: Time Series Analysis, Emerging Trends, and Sustainable Learning</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../day4/sessions/session2.html" class="pagination-link" aria-label="Session 2: LSTM Drought Monitoring Lab">
        <span class="nav-page-text">Session 2: LSTM Drought Monitoring Lab</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>CoPhil EO AI/ML Training Programme</p>
</div>   
    <div class="nav-footer-center">
<p>Funded by the European Union - Global Gateway Initiative</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:skotsopoulos@neuralio.ai">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://philsa.gov.ph">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>