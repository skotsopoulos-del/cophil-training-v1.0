<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Session 2: Advanced Palawan Land Cover Classification Lab – CoPhil EO AI/ML Training</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../day2/notebooks/session3_theory_interactive.html" rel="next">
<link href="../../day2/notebooks/session1_hands_on_lab_student.html" rel="prev">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c9822816d3895e59fda95a6fa7545fef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3775014fae9fc394bbda1d6ff89dd45e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-509191933"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-509191933', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="../../styles/custom.css">
<link rel="stylesheet" href="../../styles/phase2-enhancements.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CoPhil EO AI/ML Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-training-days" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Training Days</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-training-days">    
        <li>
    <a class="dropdown-item" href="../../day1/index.html">
 <span class="dropdown-text">Day 1: EO Data &amp; Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day2/index.html">
 <span class="dropdown-text">Day 2: Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day3/index.html">
 <span class="dropdown-text">Day 3: Deep Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day4/index.html">
 <span class="dropdown-text">Day 4: Advanced Topics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../../resources/setup.html">
 <span class="dropdown-text">Setup Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/philippine-eo.html">
 <span class="dropdown-text">Philippine EO Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/cheatsheets.html">
 <span class="dropdown-text">Cheat Sheets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/faq.html">
 <span class="dropdown-text">FAQ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/glossary.html">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../resources/downloads.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Materials</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day2/notebooks/session1_theory_notebook_STUDENT.html">Notebooks</a></li><li class="breadcrumb-item"><a href="../../day2/notebooks/session2_extended_lab_STUDENT.html">Session 2: Advanced Palawan Land Cover Classification Lab</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 2: Machine Learning for Earth Observation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Sessions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/sessions/session1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 1: Supervised Classification with Random Forest</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/sessions/session2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 2: Advanced Palawan Land Cover Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/sessions/session3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 3: Introduction to Deep Learning and CNNs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/sessions/session4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 4: CNN Hands-on Lab</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session1_theory_notebook_STUDENT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 1 Theory: Understanding Random Forest for Earth Observation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session1_hands_on_lab_student.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 1 Hands-on Lab: Palawan Land Cover Classification with Random Forest</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session2_extended_lab_STUDENT.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Session 2: Advanced Palawan Land Cover Classification Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session3_theory_interactive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 3: Deep Learning &amp; CNN Theory - Interactive Notebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session4_cnn_classification_STUDENT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 4: CNN Hands-On Lab - EuroSAT Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day2/notebooks/session4_transfer_learning_STUDENT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 4 Part B: Transfer Learning with ResNet50</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#multi-temporal-analysis-and-change-detection" id="toc-multi-temporal-analysis-and-change-detection" class="nav-link active" data-scroll-target="#multi-temporal-analysis-and-change-detection">Multi-temporal Analysis and Change Detection</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">🎯 Learning Objectives</a></li>
  <li><a href="#lab-structure" id="toc-lab-structure" class="nav-link" data-scroll-target="#lab-structure">📋 Lab Structure</a></li>
  <li><a href="#setup-requirements" id="toc-setup-requirements" class="nav-link" data-scroll-target="#setup-requirements">⚙️ Setup Requirements</a></li>
  <li><a href="#study-area-palawan-biosphere-reserve" id="toc-study-area-palawan-biosphere-reserve" class="nav-link" data-scroll-target="#study-area-palawan-biosphere-reserve">📚 Study Area: Palawan Biosphere Reserve</a></li>
  <li><a href="#class-land-cover-scheme" id="toc-class-land-cover-scheme" class="nav-link" data-scroll-target="#class-land-cover-scheme">🗺️ 8-Class Land Cover Scheme</a></li>
  <li><a href="#part-a-advanced-feature-engineering-30-minutes" id="toc-part-a-advanced-feature-engineering-30-minutes" class="nav-link" data-scroll-target="#part-a-advanced-feature-engineering-30-minutes">Part A: Advanced Feature Engineering (30 minutes)</a>
  <ul class="collapse">
  <li><a href="#a.1-setup-and-initialization" id="toc-a.1-setup-and-initialization" class="nav-link" data-scroll-target="#a.1-setup-and-initialization">A.1: Setup and Initialization</a></li>
  <li><a href="#a.2-define-study-area" id="toc-a.2-define-study-area" class="nav-link" data-scroll-target="#a.2-define-study-area">A.2: Define Study Area</a>
  <ul class="collapse">
  <li><a href="#visualize-seasonal-composites" id="toc-visualize-seasonal-composites" class="nav-link" data-scroll-target="#visualize-seasonal-composites">Visualize Seasonal Composites</a></li>
  </ul></li>
  <li><a href="#a.4-calculate-spectral-indices" id="toc-a.4-calculate-spectral-indices" class="nav-link" data-scroll-target="#a.4-calculate-spectral-indices">A.4: Calculate Spectral Indices</a></li>
  <li><a href="#a.5-calculate-glcm-texture-features" id="toc-a.5-calculate-glcm-texture-features" class="nav-link" data-scroll-target="#a.5-calculate-glcm-texture-features">A.5: Calculate GLCM Texture Features</a></li>
  <li><a href="#a.6-extract-topographic-features" id="toc-a.6-extract-topographic-features" class="nav-link" data-scroll-target="#a.6-extract-topographic-features">A.6: Extract Topographic Features</a></li>
  <li><a href="#a.7-calculate-temporal-features" id="toc-a.7-calculate-temporal-features" class="nav-link" data-scroll-target="#a.7-calculate-temporal-features">A.7: Calculate Temporal Features</a></li>
  <li><a href="#a.8-stack-all-features" id="toc-a.8-stack-all-features" class="nav-link" data-scroll-target="#a.8-stack-all-features">A.8: Stack All Features</a>
  <ul class="collapse">
  <li><a href="#part-a-complete" id="toc-part-a-complete" class="nav-link" data-scroll-target="#part-a-complete">🎉 Part A Complete!</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-b-palawan-biosphere-reserve-classification-45-minutes" id="toc-part-b-palawan-biosphere-reserve-classification-45-minutes" class="nav-link" data-scroll-target="#part-b-palawan-biosphere-reserve-classification-45-minutes">Part B: Palawan Biosphere Reserve Classification (45 minutes)</a>
  <ul class="collapse">
  <li><a href="#b.1-load-training-data" id="toc-b.1-load-training-data" class="nav-link" data-scroll-target="#b.1-load-training-data">B.1: Load Training Data</a>
  <ul class="collapse">
  <li><a href="#todo-exercise-1-explore-training-data" id="toc-todo-exercise-1-explore-training-data" class="nav-link" data-scroll-target="#todo-exercise-1-explore-training-data">TODO Exercise 1: Explore Training Data</a></li>
  </ul></li>
  <li><a href="#b.2-sample-features-from-training-polygons" id="toc-b.2-sample-features-from-training-polygons" class="nav-link" data-scroll-target="#b.2-sample-features-from-training-polygons">B.2: Sample Features from Training Polygons</a></li>
  <li><a href="#b.3-train-random-forest-classifier" id="toc-b.3-train-random-forest-classifier" class="nav-link" data-scroll-target="#b.3-train-random-forest-classifier">B.3: Train Random Forest Classifier</a></li>
  <li><a href="#b.4-apply-classification" id="toc-b.4-apply-classification" class="nav-link" data-scroll-target="#b.4-apply-classification">B.4: Apply Classification</a></li>
  <li><a href="#b.5-accuracy-assessment" id="toc-b.5-accuracy-assessment" class="nav-link" data-scroll-target="#b.5-accuracy-assessment">B.5: Accuracy Assessment</a>
  <ul class="collapse">
  <li><a href="#todo-exercise-2-interpret-accuracy" id="toc-todo-exercise-2-interpret-accuracy" class="nav-link" data-scroll-target="#todo-exercise-2-interpret-accuracy">TODO Exercise 2: Interpret Accuracy</a></li>
  </ul></li>
  <li><a href="#b.6-feature-importance-analysis" id="toc-b.6-feature-importance-analysis" class="nav-link" data-scroll-target="#b.6-feature-importance-analysis">B.6: Feature Importance Analysis</a>
  <ul class="collapse">
  <li><a href="#todo-exercise-3-feature-analysis" id="toc-todo-exercise-3-feature-analysis" class="nav-link" data-scroll-target="#todo-exercise-3-feature-analysis">TODO Exercise 3: Feature Analysis</a></li>
  </ul></li>
  <li><a href="#b.7-calculate-area-statistics" id="toc-b.7-calculate-area-statistics" class="nav-link" data-scroll-target="#b.7-calculate-area-statistics">B.7: Calculate Area Statistics</a>
  <ul class="collapse">
  <li><a href="#part-b-complete" id="toc-part-b-complete" class="nav-link" data-scroll-target="#part-b-complete">🎉 Part B Complete!</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-c-model-optimization-30-minutes" id="toc-part-c-model-optimization-30-minutes" class="nav-link" data-scroll-target="#part-c-model-optimization-30-minutes">Part C: Model Optimization (30 minutes)</a>
  <ul class="collapse">
  <li><a href="#c.1-hyperparameter-tuning" id="toc-c.1-hyperparameter-tuning" class="nav-link" data-scroll-target="#c.1-hyperparameter-tuning">C.1: Hyperparameter Tuning</a>
  <ul class="collapse">
  <li><a href="#visualize-tuning-results" id="toc-visualize-tuning-results" class="nav-link" data-scroll-target="#visualize-tuning-results">Visualize Tuning Results</a></li>
  </ul></li>
  <li><a href="#c.2-post-processing" id="toc-c.2-post-processing" class="nav-link" data-scroll-target="#c.2-post-processing">C.2: Post-Processing</a>
  <ul class="collapse">
  <li><a href="#todo-exercise-5-compare-filtering-results" id="toc-todo-exercise-5-compare-filtering-results" class="nav-link" data-scroll-target="#todo-exercise-5-compare-filtering-results">TODO Exercise 5: Compare Filtering Results</a></li>
  <li><a href="#part-c-complete" id="toc-part-c-complete" class="nav-link" data-scroll-target="#part-c-complete">🎉 Part C Complete!</a></li>
  </ul></li>
  <li><a href="#d.2-detect-forest-loss" id="toc-d.2-detect-forest-loss" class="nav-link" data-scroll-target="#d.2-detect-forest-loss">D.2: Detect Forest Loss</a></li>
  <li><a href="#d.3-identify-deforestation-hotspots" id="toc-d.3-identify-deforestation-hotspots" class="nav-link" data-scroll-target="#d.3-identify-deforestation-hotspots">D.3: Identify Deforestation Hotspots</a></li>
  <li><a href="#d.4-change-matrix-statistics" id="toc-d.4-change-matrix-statistics" class="nav-link" data-scroll-target="#d.4-change-matrix-statistics">D.4: Change Matrix &amp; Statistics</a></li>
  <li><a href="#d.5-generate-stakeholder-report" id="toc-d.5-generate-stakeholder-report" class="nav-link" data-scroll-target="#d.5-generate-stakeholder-report">D.5: Generate Stakeholder Report</a></li>
  <li><a href="#d.6-export-results" id="toc-d.6-export-results" class="nav-link" data-scroll-target="#d.6-export-results">D.6: Export Results</a>
  <ul class="collapse">
  <li><a href="#export-options" id="toc-export-options" class="nav-link" data-scroll-target="#export-options">Export Options</a></li>
  <li><a href="#part-d-complete" id="toc-part-d-complete" class="nav-link" data-scroll-target="#part-d-complete">🎉 Part D Complete!</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#lab-complete" id="toc-lab-complete" class="nav-link" data-scroll-target="#lab-complete">🎓 Lab Complete!</a>
  <ul class="collapse">
  <li><a href="#summary-of-achievements" id="toc-summary-of-achievements" class="nav-link" data-scroll-target="#summary-of-achievements">Summary of Achievements</a>
  <ul class="collapse">
  <li><a href="#part-a-feature-engineering" id="toc-part-a-feature-engineering" class="nav-link" data-scroll-target="#part-a-feature-engineering">Part A: Feature Engineering</a></li>
  <li><a href="#part-b-classification" id="toc-part-b-classification" class="nav-link" data-scroll-target="#part-b-classification">Part B: Classification</a></li>
  <li><a href="#part-c-optimization" id="toc-part-c-optimization" class="nav-link" data-scroll-target="#part-c-optimization">Part C: Optimization</a></li>
  <li><a href="#part-d-nrm-applications" id="toc-part-d-nrm-applications" class="nav-link" data-scroll-target="#part-d-nrm-applications">Part D: NRM Applications</a></li>
  </ul></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways">Key Takeaways</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a>
  <ul class="collapse">
  <li><a href="#session-3-introduction-to-deep-learning-cnns" id="toc-session-3-introduction-to-deep-learning-cnns" class="nav-link" data-scroll-target="#session-3-introduction-to-deep-learning-cnns">Session 3: Introduction to Deep Learning &amp; CNNs</a></li>
  <li><a href="#extended-exercises" id="toc-extended-exercises" class="nav-link" data-scroll-target="#extended-exercises">Extended Exercises</a></li>
  </ul></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">Resources</a>
  <ul class="collapse">
  <li><a href="#code-templates" id="toc-code-templates" class="nav-link" data-scroll-target="#code-templates">Code Templates</a></li>
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation">Documentation</a></li>
  <li><a href="#training-data" id="toc-training-data" class="nav-link" data-scroll-target="#training-data">Training Data</a></li>
  </ul></li>
  <li><a href="#questions-or-issues" id="toc-questions-or-issues" class="nav-link" data-scroll-target="#questions-or-issues">Questions or Issues?</a></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations">Congratulations! 🎉</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day2/notebooks/session1_theory_notebook_STUDENT.html">Notebooks</a></li><li class="breadcrumb-item"><a href="../../day2/notebooks/session2_extended_lab_STUDENT.html">Session 2: Advanced Palawan Land Cover Classification Lab</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Session 2: Advanced Palawan Land Cover Classification Lab</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="multi-temporal-analysis-and-change-detection" class="level2">
<h2 class="anchored" data-anchor-id="multi-temporal-analysis-and-change-detection">Multi-temporal Analysis and Change Detection</h2>
<p><strong>Duration:</strong> 2 hours | <strong>Difficulty:</strong> Intermediate</p>
<hr>
</section>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this lab, you will be able to:</p>
<ol type="1">
<li>✅ Engineer advanced features (GLCM texture, temporal, topographic)</li>
<li>✅ Create seasonal Sentinel-2 composites for Philippine context</li>
<li>✅ Implement optimized Random Forest classification</li>
<li>✅ Perform accuracy assessment with detailed metrics</li>
<li>✅ Detect land cover changes (2020 vs 2025)</li>
<li>✅ Generate stakeholder-ready outputs for NRM applications</li>
</ol>
<hr>
</section>
<section id="lab-structure" class="level2">
<h2 class="anchored" data-anchor-id="lab-structure">📋 Lab Structure</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Part</th>
<th>Topic</th>
<th>Duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>A</strong></td>
<td>Advanced Feature Engineering</td>
<td>30 min</td>
</tr>
<tr class="even">
<td><strong>B</strong></td>
<td>Palawan Biosphere Reserve Classification</td>
<td>45 min</td>
</tr>
<tr class="odd">
<td><strong>C</strong></td>
<td>Model Optimization</td>
<td>30 min</td>
</tr>
<tr class="even">
<td><strong>D</strong></td>
<td>NRM Applications &amp; Change Detection</td>
<td>15 min</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="setup-requirements" class="level2">
<h2 class="anchored" data-anchor-id="setup-requirements">⚙️ Setup Requirements</h2>
<ul>
<li>Google Earth Engine account (authenticated)</li>
<li>Python 3.8+</li>
<li>Libraries: <code>earthengine-api</code>, <code>geemap</code>, <code>scikit-learn</code></li>
</ul>
<hr>
</section>
<section id="study-area-palawan-biosphere-reserve" class="level2">
<h2 class="anchored" data-anchor-id="study-area-palawan-biosphere-reserve">📚 Study Area: Palawan Biosphere Reserve</h2>
<ul>
<li><strong>Location:</strong> Philippines, northern Palawan</li>
<li><strong>Area:</strong> ~11,655 km²</li>
<li><strong>UNESCO Status:</strong> Biosphere Reserve (1990)</li>
<li><strong>Conservation Priority:</strong> Last frontier forest, high biodiversity</li>
<li><strong>Threats:</strong> Mining, agriculture expansion, illegal logging</li>
</ul>
<hr>
</section>
<section id="class-land-cover-scheme" class="level2">
<h2 class="anchored" data-anchor-id="class-land-cover-scheme">🗺️ 8-Class Land Cover Scheme</h2>
<ol type="1">
<li><strong>Primary Forest</strong> - Dense dipterocarp, closed canopy</li>
<li><strong>Secondary Forest</strong> - Regenerating, mixed canopy</li>
<li><strong>Mangroves</strong> - Coastal, tidal influence</li>
<li><strong>Agricultural Land</strong> - Rice, coconut plantations</li>
<li><strong>Grassland/Scrubland</strong> - Open areas, sparse vegetation</li>
<li><strong>Water Bodies</strong> - Rivers, lakes, coastal waters</li>
<li><strong>Urban/Built-up</strong> - Settlements, infrastructure</li>
<li><strong>Bare Soil/Mining</strong> - Exposed soil, mining areas</li>
</ol>
<hr>
<p>Let’s begin! 🚀</p>
<hr>
</section>
<section id="part-a-advanced-feature-engineering-30-minutes" class="level1">
<h1>Part A: Advanced Feature Engineering (30 minutes)</h1>
<p>In this section, we’ll create a comprehensive feature stack including: - Spectral bands (Sentinel-2) - Spectral indices (NDVI, NDWI, NDBI, EVI) - Texture features (GLCM) - Temporal features (dry/wet season) - Topographic features (SRTM DEM)</p>
<hr>
<section id="a.1-setup-and-initialization" class="level2">
<h2 class="anchored" data-anchor-id="a.1-setup-and-initialization">A.1: Setup and Initialization</h2>
<div id="42468bbf" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ee</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geemap</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set style</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"whitegrid"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Libraries imported successfully"</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Session started: </span><span class="sc">{</span>datetime<span class="sc">.</span>now()<span class="sc">.</span>strftime(<span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st"> %H:%M:%S'</span>)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="d4de4c3f" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize Google Earth Engineimport eeimport geemap.core as geemapee.Authenticate()ee.Initialize(project='YOUR-PROJECT-ID')print("✓ Earth Engine authenticated and initialized")# Test connectiontest_collection = ee.ImageCollection('COPERNICUS/S2_SR_HARMONIZED') \    .filterDate('2025-01-01', '2025-12-31') \    .first()try:    test_info = test_collection.getInfo()    print(f"✓ Connection test: {test_info['id']}")except Exception as e:    print(f"⚠️ Connection test failed: {str(e)}")    print("Please check your authentication and try again")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="a.2-define-study-area" class="level2">
<h2 class="anchored" data-anchor-id="a.2-define-study-area">A.2: Define Study Area</h2>
<p>We’ll focus on a manageable subset of Palawan Biosphere Reserve for this lab. For production work, you can expand to the full area.</p>
<div id="c347f9f4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define Palawan Biosphere Reserve subset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordinates: Northern Palawan focus area</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>palawan_bbox <span class="op">=</span> [<span class="fl">118.5</span>, <span class="fl">9.5</span>, <span class="fl">119.5</span>, <span class="fl">10.5</span>]  <span class="co"># [min_lon, min_lat, max_lon, max_lat]</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>aoi <span class="op">=</span> ee.Geometry.Rectangle(palawan_bbox)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Study Area: </span><span class="sc">{</span>palawan_bbox<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Area: </span><span class="sc">{</span>aoi<span class="sc">.</span>area()<span class="sc">.</span>divide(<span class="fl">1e6</span>)<span class="sc">.</span>getInfo()<span class="sc">:.2f}</span><span class="ss"> km²"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map to visualize</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Map <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">10.0</span>, <span class="fl">119.0</span>], zoom<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>Map.addLayer(aoi, {<span class="st">'color'</span>: <span class="st">'red'</span>}, <span class="st">'Study Area'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>Map</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>—## A.3: Create Seasonal CompositesPhilippine seasons are critical for land cover classification:- <strong>Dry Season (Jan-May):</strong> Best for forest mapping, minimal cloud cover- <strong>Wet Season (Jun-Nov):</strong> Shows agricultural phenology, maximum water extentWe’ll create median composites for both seasons from 2025 data.</p>
<div id="c7c37baa" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cloud masking function</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mask_s2_clouds(image):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Mask clouds using QA60 band"""</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    qa <span class="op">=</span> image.select(<span class="st">'QA60'</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bits 10 and 11 are clouds and cirrus</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    cloud_bit_mask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">10</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    cirrus_bit_mask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="dv">11</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Both flags should be zero (clear conditions)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> qa.bitwiseAnd(cloud_bit_mask).eq(<span class="dv">0</span>).And(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>           qa.bitwiseAnd(cirrus_bit_mask).eq(<span class="dv">0</span>))</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Scale and return masked image</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> image.updateMask(mask).divide(<span class="dv">10000</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Cloud masking function defined"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="9c285976" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DRY SEASON composite (January-May 2025)print("Creating dry season composite...")dry_season = ee.ImageCollection('COPERNICUS/S2_SR_HARMONIZED') \    .filterBounds(aoi) \    .filterDate('2025-01-01', '2025-05-31') \    .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 20)) \    .map(mask_s2_clouds) \    .median() \    .clip(aoi)print(f"✓ Dry season composite created")print(f"  Bands: {dry_season.bandNames().getInfo()}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="c490610a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create WET SEASON composite (June-November 2025)print("Creating wet season composite...")wet_season = ee.ImageCollection('COPERNICUS/S2_SR_HARMONIZED') \    .filterBounds(aoi) \    .filterDate('2025-06-01', '2025-11-30') \    .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 30)) \    .map(mask_s2_clouds) \    .median() \    .clip(aoi)print(f"✓ Wet season composite created")print(f"  Bands: {wet_season.bandNames().getInfo()}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="visualize-seasonal-composites" class="level3">
<h3 class="anchored" data-anchor-id="visualize-seasonal-composites">Visualize Seasonal Composites</h3>
<div id="a6e8b584" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize both seasonsMap2 = geemap.Map(center=[10.0, 119.0], zoom=10)# RGB visualization parametersvis_params = {    'min': 0, 'max': 0.3,    'bands': ['B4', 'B3', 'B2']}Map2.addLayer(dry_season, vis_params, 'Dry Season (Jan-May 2025)')Map2.addLayer(wet_season, vis_params, 'Wet Season (Jun-Nov 2025)')Map2.addLayerControl()Map2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="a.4-calculate-spectral-indices" class="level2">
<h2 class="anchored" data-anchor-id="a.4-calculate-spectral-indices">A.4: Calculate Spectral Indices</h2>
<p>We’ll calculate key vegetation and land cover indices for both seasons.</p>
<div id="37c501b7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate spectral indices</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_indices(image):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate NDVI, NDWI, NDBI, EVI"""</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NDVI: Normalized Difference Vegetation Index</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    ndvi <span class="op">=</span> image.normalizedDifference([<span class="st">'B8'</span>, <span class="st">'B4'</span>]).rename(<span class="st">'NDVI'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NDWI: Normalized Difference Water Index  </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    ndwi <span class="op">=</span> image.normalizedDifference([<span class="st">'B3'</span>, <span class="st">'B8'</span>]).rename(<span class="st">'NDWI'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NDBI: Normalized Difference Built-up Index</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    ndbi <span class="op">=</span> image.normalizedDifference([<span class="st">'B11'</span>, <span class="st">'B8'</span>]).rename(<span class="st">'NDBI'</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># EVI: Enhanced Vegetation Index</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    evi <span class="op">=</span> image.expression(</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'2.5 * ((NIR - RED) / (NIR + 6 * RED - 7.5 * BLUE + 1))'</span>, {</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">'NIR'</span>: image.select(<span class="st">'B8'</span>),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">'RED'</span>: image.select(<span class="st">'B4'</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">'BLUE'</span>: image.select(<span class="st">'B2'</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        }).rename(<span class="st">'EVI'</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> image.addBands([ndvi, ndwi, ndbi, evi])</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add indices to both seasons</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>dry_with_indices <span class="op">=</span> add_indices(dry_season)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>wet_with_indices <span class="op">=</span> add_indices(wet_season)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Spectral indices calculated for both seasons"</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Dry season bands: </span><span class="sc">{</span>dry_with_indices<span class="sc">.</span>bandNames()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="a.5-calculate-glcm-texture-features" class="level2">
<h2 class="anchored" data-anchor-id="a.5-calculate-glcm-texture-features">A.5: Calculate GLCM Texture Features</h2>
<p>Texture features help distinguish land cover types with similar spectral properties: - <strong>Contrast:</strong> Distinguishes forest from agriculture - <strong>Entropy:</strong> Captures urban heterogeneity<br>
- <strong>Correlation:</strong> Good for textured surfaces (forest canopy)</p>
<p>⚠️ <strong>Note:</strong> GLCM computation is computationally intensive. This may take a few minutes.</p>
<div id="59469ee3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate GLCM texture on NIR band (B8)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Calculating GLCM texture features (this may take a moment)..."</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 3x3 window (size=3)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>nir_band <span class="op">=</span> dry_with_indices.select(<span class="st">'B8'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>glcm <span class="op">=</span> nir_band.glcmTexture(size<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select key texture features</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>texture_contrast <span class="op">=</span> glcm.select(<span class="st">'B8_contrast'</span>).rename(<span class="st">'texture_contrast'</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>texture_entropy <span class="op">=</span> glcm.select(<span class="st">'B8_ent'</span>).rename(<span class="st">'texture_entropy'</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>texture_corr <span class="op">=</span> glcm.select(<span class="st">'B8_corr'</span>).rename(<span class="st">'texture_corr'</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>texture_var <span class="op">=</span> glcm.select(<span class="st">'B8_var'</span>).rename(<span class="st">'texture_var'</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack texture features</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>texture_features <span class="op">=</span> ee.Image.cat([</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    texture_contrast,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    texture_entropy,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    texture_corr,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    texture_var</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ GLCM texture features calculated"</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Features: </span><span class="sc">{</span>texture_features<span class="sc">.</span>bandNames()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="a.6-extract-topographic-features" class="level2">
<h2 class="anchored" data-anchor-id="a.6-extract-topographic-features">A.6: Extract Topographic Features</h2>
<p>Topography helps separate land uses (e.g., agriculture on flat areas, forests on slopes).</p>
<div id="941c7db6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load SRTM DEM (30m resolution)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>dem <span class="op">=</span> ee.Image(<span class="st">'USGS/SRTMGL1_003'</span>).clip(aoi)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate terrain derivatives</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>elevation <span class="op">=</span> dem.select(<span class="st">'elevation'</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>slope <span class="op">=</span> ee.Terrain.slope(dem).rename(<span class="st">'slope'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>aspect <span class="op">=</span> ee.Terrain.aspect(dem).rename(<span class="st">'aspect'</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack topographic features</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>topo_features <span class="op">=</span> ee.Image.cat([elevation, slope, aspect])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Topographic features extracted"</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Features: </span><span class="sc">{</span>topo_features<span class="sc">.</span>bandNames()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="a.7-calculate-temporal-features" class="level2">
<h2 class="anchored" data-anchor-id="a.7-calculate-temporal-features">A.7: Calculate Temporal Features</h2>
<p>Temporal differences between seasons reveal phenological patterns, especially for agriculture.</p>
<div id="29198f29" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate temporal features</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ndvi_dry <span class="op">=</span> dry_with_indices.select(<span class="st">'NDVI'</span>).rename(<span class="st">'NDVI_dry'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ndvi_wet <span class="op">=</span> wet_with_indices.select(<span class="st">'NDVI'</span>).rename(<span class="st">'NDVI_wet'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># NDVI difference (phenological signal)</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>ndvi_diff <span class="op">=</span> ndvi_wet.subtract(ndvi_dry).rename(<span class="st">'NDVI_diff'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># NDVI mean</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ndvi_mean <span class="op">=</span> ndvi_dry.add(ndvi_wet).divide(<span class="dv">2</span>).rename(<span class="st">'NDVI_mean'</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Water indices</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>ndwi_dry <span class="op">=</span> dry_with_indices.select(<span class="st">'NDWI'</span>).rename(<span class="st">'NDWI_dry'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ndwi_wet <span class="op">=</span> wet_with_indices.select(<span class="st">'NDWI'</span>).rename(<span class="st">'NDWI_wet'</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack temporal features</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>temporal_features <span class="op">=</span> ee.Image.cat([</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    ndvi_dry, ndvi_wet, ndvi_diff, ndvi_mean,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    ndwi_dry, ndwi_wet</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Temporal features calculated"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Features: </span><span class="sc">{</span>temporal_features<span class="sc">.</span>bandNames()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="a.8-stack-all-features" class="level2">
<h2 class="anchored" data-anchor-id="a.8-stack-all-features">A.8: Stack All Features</h2>
<p>Now we combine everything into a comprehensive feature stack.</p>
<div id="505aed20" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select spectral bands from dry season</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>spectral_bands <span class="op">=</span> dry_with_indices.select([<span class="st">'B2'</span>, <span class="st">'B3'</span>, <span class="st">'B4'</span>, <span class="st">'B8'</span>, <span class="st">'B11'</span>, <span class="st">'B12'</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select indices from dry season</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>spectral_indices <span class="op">=</span> dry_with_indices.select([<span class="st">'NDVI'</span>, <span class="st">'NDWI'</span>, <span class="st">'NDBI'</span>, <span class="st">'EVI'</span>])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Stack ALL features</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>feature_stack <span class="op">=</span> ee.Image.cat([</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    spectral_bands,      <span class="co"># 6 bands</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    spectral_indices,    <span class="co"># 4 indices</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    texture_features,    <span class="co"># 4 texture</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    temporal_features,   <span class="co"># 6 temporal</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    topo_features        <span class="co"># 3 topographic</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print summary</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>all_bands <span class="op">=</span> feature_stack.bandNames().getInfo()</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Complete feature stack created"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Total features: </span><span class="sc">{</span><span class="bu">len</span>(all_bands)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Feature list:"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, band <span class="kw">in</span> <span class="bu">enumerate</span>(all_bands, <span class="dv">1</span>):</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>i<span class="sc">:2d}</span><span class="ss">. </span><span class="sc">{</span>band<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="part-a-complete" class="level3">
<h3 class="anchored" data-anchor-id="part-a-complete">🎉 Part A Complete!</h3>
<p>You’ve successfully created a comprehensive feature stack with: - 6 spectral bands - 4 spectral indices - 4 texture features - 6 temporal features - 3 topographic features</p>
<p><strong>Total: 23 features</strong> for classification</p>
<hr>
<hr>
</section>
</section>
</section>
<section id="part-b-palawan-biosphere-reserve-classification-45-minutes" class="level1">
<h1>Part B: Palawan Biosphere Reserve Classification (45 minutes)</h1>
<p>Now we’ll use our feature stack to classify the 8 land cover classes.</p>
<hr>
<section id="b.1-load-training-data" class="level2">
<h2 class="anchored" data-anchor-id="b.1-load-training-data">B.1: Load Training Data</h2>
<p>We’ll use the training polygons created in Session 1.</p>
<div id="b69578ac" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load training polygons from Session 1</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Path to your training data (adjust if needed)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>training_polygons <span class="op">=</span> geemap.geojson_to_ee(<span class="st">'../data/palawan_training_polygons.geojson'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Training polygons loaded"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Number of features: </span><span class="sc">{</span>training_polygons<span class="sc">.</span>size()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Check class distribution</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>classes <span class="op">=</span> training_polygons.aggregate_array(<span class="st">'class_id'</span>).distinct().sort()</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Classes present: </span><span class="sc">{</span>classes<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="todo-exercise-1-explore-training-data" class="level3">
<h3 class="anchored" data-anchor-id="todo-exercise-1-explore-training-data">TODO Exercise 1: Explore Training Data</h3>
<p><strong>Task:</strong> Create a map showing the training polygons colored by class.</p>
<p><strong>Hint:</strong> Use <code>Map.addLayer()</code> with training_polygons and a styled visualization.</p>
<div id="5ac6ca53" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: YOUR CODE HERE</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map showing training polygons by class</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SOLUTION HINT: Use styling like {'color': 'class_id', 'palette': [...]}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="b.2-sample-features-from-training-polygons" class="level2">
<h2 class="anchored" data-anchor-id="b.2-sample-features-from-training-polygons">B.2: Sample Features from Training Polygons</h2>
<div id="042a5dc6" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample the feature stack at training locations</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>training <span class="op">=</span> feature_stack.sampleRegions(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    collection<span class="op">=</span>training_polygons,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    properties<span class="op">=</span>[<span class="st">'class_id'</span>],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    scale<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    geometries<span class="op">=</span><span class="va">False</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Training data sampled"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Training samples: </span><span class="sc">{</span>training<span class="sc">.</span>size()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any null values</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>sample_info <span class="op">=</span> training.first().getInfo()</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss"> Sample feature names: </span><span class="sc">{</span><span class="bu">list</span>(sample_info[<span class="st">'properties'</span>].keys())<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="b.3-train-random-forest-classifier" class="level2">
<h2 class="anchored" data-anchor-id="b.3-train-random-forest-classifier">B.3: Train Random Forest Classifier</h2>
<div id="7ed9ba06" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train Random Forest classifier</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training Random Forest classifier..."</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>classifier <span class="op">=</span> ee.Classifier.smileRandomForest(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    numberOfTrees<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    variablesPerSplit<span class="op">=</span><span class="va">None</span>,  <span class="co"># sqrt(n) by default</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    minLeafPopulation<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    bagFraction<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    maxNodes<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    seed<span class="op">=</span><span class="dv">42</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>).train(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    features<span class="op">=</span>training,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    classProperty<span class="op">=</span><span class="st">'class_id'</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    inputProperties<span class="op">=</span>feature_stack.bandNames()</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Random Forest trained successfully"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Number of trees: 200"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Features used: </span><span class="sc">{</span><span class="bu">len</span>(all_bands)<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="b.4-apply-classification" class="level2">
<h2 class="anchored" data-anchor-id="b.4-apply-classification">B.4: Apply Classification</h2>
<div id="b73924bd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify the feature stackclassified = feature_stack.classify(classifier).rename('classification')print("✓ Classification complete")# Visualize classificationclass_colors = ['#0A5F0A', '#4CAF50', '#009688', '#FFC107',                 '#FFEB3B', '#2196F3', '#F44336', '#795548']Map3 = geemap.Map(center=[10.0, 119.0], zoom=10)Map3.addLayer(classified, {'min': 1, 'max': 8, 'palette': class_colors}, 'Land Cover 2025')Map3.addLayer(aoi, {'color': 'black'}, 'Study Area', False)Map3.add_legend(    title='Land Cover Classes',    labels=['Primary Forest', 'Secondary Forest', 'Mangroves', 'Agricultural',            'Grassland', 'Water', 'Urban', 'Bare Soil'],    colors=class_colors)Map3</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="b.5-accuracy-assessment" class="level2">
<h2 class="anchored" data-anchor-id="b.5-accuracy-assessment">B.5: Accuracy Assessment</h2>
<p>We’ll use the validation polygons for independent accuracy assessment.</p>
<div id="3bf0e191" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load validation polygons</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>validation_polygons <span class="op">=</span> geemap.geojson_to_ee(<span class="st">'../data/palawan_validation_polygons.geojson'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample validation data</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>validation <span class="op">=</span> feature_stack.sampleRegions(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    collection<span class="op">=</span>validation_polygons,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    properties<span class="op">=</span>[<span class="st">'class_id'</span>],</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    scale<span class="op">=</span><span class="dv">10</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify validation samples</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>validated <span class="op">=</span> validation.classify(classifier)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Validation data: </span><span class="sc">{</span>validation<span class="sc">.</span>size()<span class="sc">.</span>getInfo()<span class="sc">}</span><span class="ss"> samples"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5ba1601a" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate confusion matrix</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="op">=</span> validated.errorMatrix(<span class="st">'class_id'</span>, <span class="st">'classification'</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy metrics</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>overall_accuracy <span class="op">=</span> confusion_matrix.accuracy().getInfo()</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>kappa <span class="op">=</span> confusion_matrix.kappa().getInfo()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>producers_accuracy <span class="op">=</span> confusion_matrix.producersAccuracy().getInfo()</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>consumers_accuracy <span class="op">=</span> confusion_matrix.consumersAccuracy().getInfo()</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ACCURACY ASSESSMENT RESULTS"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Overall Accuracy: </span><span class="sc">{</span>overall_accuracy<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Kappa Coefficient: </span><span class="sc">{</span>kappa<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Confusion Matrix:"</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix.getInfo())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="todo-exercise-2-interpret-accuracy" class="level3">
<h3 class="anchored" data-anchor-id="todo-exercise-2-interpret-accuracy">TODO Exercise 2: Interpret Accuracy</h3>
<p><strong>Questions:</strong> 1. Which classes have the highest producer’s accuracy (recall)? 2. Which classes are most confused with each other? 3. How does this compare to Session 1 results? 4. What could be done to improve accuracy?</p>
<p><strong>Write your answers below:</strong></p>
<p><em>YOUR ANSWERS HERE</em></p>
<hr>
</section>
</section>
<section id="b.6-feature-importance-analysis" class="level2">
<h2 class="anchored" data-anchor-id="b.6-feature-importance-analysis">B.6: Feature Importance Analysis</h2>
<div id="9ff0aadb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get feature importance</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>importance_dict <span class="op">=</span> classifier.explain().get(<span class="st">'importance'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: In GEE, feature importance requires special handling</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For this demo, we'll use a proxy by analyzing variable contribution</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Feature importance analysis"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Top features for classification:"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"(Feature importance values from Random Forest)"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a simplified version - full implementation would extract actual importances</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> feature_stack.bandNames().getInfo()</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Total features used: </span><span class="sc">{</span><span class="bu">len</span>(feature_names)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, fname <span class="kw">in</span> <span class="bu">enumerate</span>(feature_names[:<span class="dv">10</span>], <span class="dv">1</span>):</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>fname<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  ..."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="todo-exercise-3-feature-analysis" class="level3">
<h3 class="anchored" data-anchor-id="todo-exercise-3-feature-analysis">TODO Exercise 3: Feature Analysis</h3>
<p><strong>Task:</strong> Based on the features we used, which ones do you think are most important for: 1. Separating primary from secondary forest? 2. Identifying agricultural land? 3. Detecting urban areas?</p>
<p><em>YOUR ANSWERS HERE</em></p>
<hr>
<hr>
</section>
</section>
<section id="b.7-calculate-area-statistics" class="level2">
<h2 class="anchored" data-anchor-id="b.7-calculate-area-statistics">B.7: Calculate Area Statistics</h2>
<div id="0293ca87" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate area for each class</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Calculating area statistics..."</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>class_names <span class="op">=</span> {</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'Primary Forest'</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'Secondary Forest'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'Mangroves'</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'Agricultural'</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'Grassland'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'Water'</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'Urban'</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'Bare Soil'</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>area_stats <span class="op">=</span> {}</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> class_id, class_name <span class="kw">in</span> class_names.items():</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create mask for this class</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    class_mask <span class="op">=</span> classified.eq(class_id)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate area (pixels * pixel_area)</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    area <span class="op">=</span> class_mask.multiply(ee.Image.pixelArea()).reduceRegion(</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>        reducer<span class="op">=</span>ee.Reducer.<span class="bu">sum</span>(),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        geometry<span class="op">=</span>aoi,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        scale<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        maxPixels<span class="op">=</span><span class="fl">1e13</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to hectares</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    area_ha <span class="op">=</span> ee.Number(area.get(<span class="st">'classification'</span>)).divide(<span class="dv">10000</span>).getInfo()</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>    area_stats[class_name] <span class="op">=</span> area_ha</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>class_name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>area_ha<span class="sc">:,.2f}</span><span class="ss"> ha"</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✓ Area statistics calculated"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="60651f79" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize area distributionimport matplotlib.pyplot as pltfig, ax = plt.subplots(figsize=(12, 6))classes_list = list(area_stats.keys())areas_list = list(area_stats.values())colors = ['#0A5F0A', '#4CAF50', '#009688', '#FFC107',           '#FFEB3B', '#2196F3', '#F44336', '#795548']bars = ax.bar(range(len(classes_list)), areas_list, color=colors, edgecolor='black', linewidth=1.5)ax.set_xlabel('Land Cover Class', fontsize=12, fontweight='bold')ax.set_ylabel('Area (hectares)', fontsize=12, fontweight='bold')ax.set_title('Palawan Land Cover Distribution (2025)', fontsize=14, fontweight='bold')ax.set_xticks(range(len(classes_list)))ax.set_xticklabels(classes_list, rotation=45, ha='right')ax.grid(axis='y', alpha=0.3)# Add value labels on barsfor i, (bar, value) in enumerate(zip(bars, areas_list)):    height = bar.get_height()    ax.text(bar.get_x() + bar.get_width()/2., height,            f'{value:,.0f}',            ha='center', va='bottom', fontsize=10, fontweight='bold')plt.tight_layout()plt.show()print("✓ Area distribution plot created")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="part-b-complete" class="level3">
<h3 class="anchored" data-anchor-id="part-b-complete">🎉 Part B Complete!</h3>
<p>You’ve successfully: - ✅ Loaded and sampled training data - ✅ Trained a Random Forest classifier with 23 features - ✅ Applied classification to Palawan - ✅ Assessed accuracy (hopefully &gt;85%!) - ✅ Calculated area statistics</p>
<hr>
<hr>
</section>
</section>
</section>
<section id="part-c-model-optimization-30-minutes" class="level1">
<h1>Part C: Model Optimization (30 minutes)</h1>
<p>Let’s optimize our classifier and explore different parameters.</p>
<hr>
<section id="c.1-hyperparameter-tuning" class="level2">
<h2 class="anchored" data-anchor-id="c.1-hyperparameter-tuning">C.1: Hyperparameter Tuning</h2>
<p>We’ll test different numbers of trees to find the optimal configuration.</p>
<div id="bed8c722" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">### </span><span class="al">TODO</span><span class="co"> Exercise 4: Test Different Tree Counts</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Task:<span class="op">**</span> Train classifiers <span class="cf">with</span> different numbers of trees <span class="kw">and</span> compare accuracy.</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>Test these values: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Code template provided below <span class="op">-</span> complete the TODO sections<span class="op">**</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f4431609" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameter tuning experiment</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tree_counts <span class="op">=</span> [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> {}</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Testing different tree counts..."</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n_trees <span class="kw">in</span> tree_counts:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">TODO</span><span class="co">: Train a classifier with n_trees</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># HINT: Use ee.Classifier.smileRandomForest(numberOfTrees=n_trees)</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    test_classifier <span class="op">=</span> ee.Classifier.smileRandomForest(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        numberOfTrees<span class="op">=</span>n_trees,</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        seed<span class="op">=</span><span class="dv">42</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    ).train(</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        features<span class="op">=</span>training,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        classProperty<span class="op">=</span><span class="st">'class_id'</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        inputProperties<span class="op">=</span>feature_stack.bandNames()</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Validate</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    test_validated <span class="op">=</span> validation.classify(test_classifier)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    test_accuracy <span class="op">=</span> test_validated.errorMatrix(<span class="st">'class_id'</span>, <span class="st">'classification'</span>).accuracy().getInfo()</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    results[n_trees] <span class="op">=</span> test_accuracy</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Trees: </span><span class="sc">{</span>n_trees<span class="sc">:3d}</span><span class="ss"> | Accuracy: </span><span class="sc">{</span>test_accuracy<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span> <span class="op">*</span> <span class="dv">60</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✓ Optimal tree count: </span><span class="sc">{</span><span class="bu">max</span>(results, key<span class="op">=</span>results.get)<span class="sc">}</span><span class="ss"> trees"</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Best accuracy: </span><span class="sc">{</span><span class="bu">max</span>(results.values())<span class="op">*</span><span class="dv">100</span><span class="sc">:.2f}</span><span class="ss">%"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="visualize-tuning-results" class="level3">
<h3 class="anchored" data-anchor-id="visualize-tuning-results">Visualize Tuning Results</h3>
<div id="c42b5ea5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot tuning results</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>trees_list <span class="op">=</span> <span class="bu">list</span>(results.keys())</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>acc_list <span class="op">=</span> [v<span class="op">*</span><span class="dv">100</span> <span class="cf">for</span> v <span class="kw">in</span> results.values()]</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>ax.plot(trees_list, acc_list, <span class="st">'o-'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, markersize<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span><span class="st">'#2196F3'</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Number of Trees'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Overall Accuracy (%)'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Random Forest Hyperparameter Tuning Results'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="bu">min</span>(acc_list)<span class="op">-</span><span class="dv">2</span>, <span class="bu">max</span>(acc_list)<span class="op">+</span><span class="dv">2</span>])</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight best</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>best_idx <span class="op">=</span> acc_list.index(<span class="bu">max</span>(acc_list))</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ax.scatter([trees_list[best_idx]], [acc_list[best_idx]], </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>           s<span class="op">=</span><span class="dv">200</span>, c<span class="op">=</span><span class="st">'red'</span>, marker<span class="op">=</span><span class="st">'*'</span>, zorder<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'Best'</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="c.2-post-processing" class="level2">
<h2 class="anchored" data-anchor-id="c.2-post-processing">C.2: Post-Processing</h2>
<p>Reduce “salt-and-pepper” noise using majority filtering.</p>
<div id="5330416e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply majority filter</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Applying post-processing..."</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Focal mode filter (3x3 window)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>classified_filtered <span class="op">=</span> classified.focal_mode(radius<span class="op">=</span><span class="dv">1</span>, kernelType<span class="op">=</span><span class="st">'square'</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Majority filter applied (3x3 window)"</span>)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare before/after</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>Map4 <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">10.0</span>, <span class="fl">119.0</span>], zoom<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>Map4.addLayer(classified, {<span class="st">'min'</span>: <span class="dv">1</span>, <span class="st">'max'</span>: <span class="dv">8</span>, <span class="st">'palette'</span>: class_colors}, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Original Classification'</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>Map4.addLayer(classified_filtered, {<span class="st">'min'</span>: <span class="dv">1</span>, <span class="st">'max'</span>: <span class="dv">8</span>, <span class="st">'palette'</span>: class_colors}, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>              <span class="st">'Filtered Classification'</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>Map4.addLayerControl()</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>Map4</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="todo-exercise-5-compare-filtering-results" class="level3">
<h3 class="anchored" data-anchor-id="todo-exercise-5-compare-filtering-results">TODO Exercise 5: Compare Filtering Results</h3>
<p><strong>Task:</strong> Zoom in on the map above and compare the original vs filtered classification.</p>
<p><strong>Questions:</strong> 1. What differences do you notice? 2. Does filtering improve visual quality? 3. Are there any disadvantages to filtering?</p>
<p><em>YOUR ANSWERS HERE</em></p>
<hr>
</section>
<section id="part-c-complete" class="level3">
<h3 class="anchored" data-anchor-id="part-c-complete">🎉 Part C Complete!</h3>
<p>You’ve successfully: - ✅ Performed hyperparameter tuning - ✅ Identified optimal tree count - ✅ Applied post-processing filters</p>
<hr>
<p>—# Part D: NRM Applications &amp; Change Detection (15 minutes)Apply classification to conservation challenges: detect forest loss from 2020 to 2025.—## D.1: Create 2020 ClassificationWe’ll create a comparable classification for 2020 to detect changes.</p>
<div id="31f5c875" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create 2020 dry season composite</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Creating 2020 composite for comparison..."</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>dry_2020 <span class="op">=</span> ee.ImageCollection(<span class="st">'COPERNICUS/S2_SR_HARMONIZED'</span>) <span class="op">\</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    .filterBounds(aoi) <span class="op">\</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    .filterDate(<span class="st">'2020-01-01'</span>, <span class="st">'2020-05-31'</span>) <span class="op">\</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">filter</span>(ee.Filter.lt(<span class="st">'CLOUDY_PIXEL_PERCENTAGE'</span>, <span class="dv">20</span>)) <span class="op">\</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">map</span>(mask_s2_clouds) <span class="op">\</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    .median() <span class="op">\</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    .clip(aoi)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add indices (simplified for speed)</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_basic_indices(img):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    ndvi <span class="op">=</span> img.normalizedDifference([<span class="st">'B8'</span>, <span class="st">'B4'</span>]).rename(<span class="st">'NDVI'</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    ndwi <span class="op">=</span> img.normalizedDifference([<span class="st">'B3'</span>, <span class="st">'B8'</span>]).rename(<span class="st">'NDWI'</span>)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> img.addBands([ndvi, ndwi])</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>dry_2020 <span class="op">=</span> add_basic_indices(dry_2020)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Use simplified feature set for 2020</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>features_2020 <span class="op">=</span> dry_2020.select([<span class="st">'B2'</span>, <span class="st">'B3'</span>, <span class="st">'B4'</span>, <span class="st">'B8'</span>, <span class="st">'B11'</span>, <span class="st">'B12'</span>, <span class="st">'NDVI'</span>, <span class="st">'NDWI'</span>])</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Classify 2020</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>classified_2020 <span class="op">=</span> features_2020.classify(classifier).rename(<span class="st">'classification_2020'</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ 2020 classification complete"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="d.2-detect-forest-loss" class="level2">
<h2 class="anchored" data-anchor-id="d.2-detect-forest-loss">D.2: Detect Forest Loss</h2>
<div id="74f501c0" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect forest loss (class 1 or 2 in 2020, NOT in 2025)print("Detecting forest loss...")# Create forest masksforest_2020 = classified_2020.eq(1).Or(classified_2020.eq(2))forest_2025 = classified_filtered.eq(1).Or(classified_filtered.eq(2))# Forest loss: was forest in 2020, not forest in 2025forest_loss = forest_2020.And(forest_2025.Not()).rename('forest_loss')print("✓ Forest loss detected")# Calculate forest loss arealoss_area = forest_loss.multiply(ee.Image.pixelArea()).reduceRegion(    reducer=ee.Reducer.sum(),    geometry=aoi,    scale=10,    maxPixels=1e13)loss_ha = ee.Number(loss_area.get('forest_loss')).divide(10000).getInfo()print(f"\n🚨 Forest Loss (2020-2025): {loss_ha:,.2f} hectares")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="5a3ab90c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize forest lossMap5 = geemap.Map(center=[10.0, 119.0], zoom=10)# Background: 2025 classificationMap5.addLayer(classified_filtered, {'min': 1, 'max': 8, 'palette': class_colors},               '2025 Land Cover', False)# Highlight forest loss in redMap5.addLayer(forest_loss.updateMask(forest_loss), {'palette': ['red']},               'Forest Loss (2020-2025)')Map5.add_legend(    title='Change Detection',    labels=['Forest Loss', 'No Change'],    colors=['red', 'lightgray'])Map5</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="d.3-identify-deforestation-hotspots" class="level2">
<h2 class="anchored" data-anchor-id="d.3-identify-deforestation-hotspots">D.3: Identify Deforestation Hotspots</h2>
<div id="d383bb9c" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Detect hotspots using focal statistics</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Identifying deforestation hotspots..."</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create circular kernel (1km radius)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>kernel <span class="op">=</span> ee.Kernel.circle(radius<span class="op">=</span><span class="dv">1000</span>, units<span class="op">=</span><span class="st">'meters'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proportion of loss pixels in neighborhood</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>hotspots <span class="op">=</span> forest_loss.focalMean(kernel<span class="op">=</span>kernel).multiply(<span class="dv">100</span>).rename(<span class="st">'hotspot_intensity'</span>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Hotspot analysis complete"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize hotspots</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>Map6 <span class="op">=</span> geemap.Map(center<span class="op">=</span>[<span class="fl">10.0</span>, <span class="fl">119.0</span>], zoom<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>hotspot_vis <span class="op">=</span> {</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min'</span>: <span class="dv">0</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max'</span>: <span class="dv">10</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'palette'</span>: [<span class="st">'white'</span>, <span class="st">'yellow'</span>, <span class="st">'orange'</span>, <span class="st">'red'</span>, <span class="st">'darkred'</span>]</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>Map6.addLayer(hotspots.updateMask(hotspots.gt(<span class="fl">0.5</span>)), hotspot_vis, <span class="st">'Deforestation Hotspots'</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>Map6.add_colorbar(hotspot_vis, label<span class="op">=</span><span class="st">'Forest Loss Intensity (%)'</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>Map6</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="d.4-change-matrix-statistics" class="level2">
<h2 class="anchored" data-anchor-id="d.4-change-matrix-statistics">D.4: Change Matrix &amp; Statistics</h2>
<div id="9ada07ce" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">### </span><span class="al">TODO</span><span class="co"> Exercise 6: Analyze Land Use Transitions</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Task:<span class="op">**</span> Calculate how much forest was converted to different land uses.</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Questions to investigate:<span class="op">**</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> How much forest → agriculture conversion occurred?</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> How much forest → bare soil (mining)?</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span> Which <span class="kw">class</span> replaced forests the most?</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Code template:<span class="op">**</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="a91f4904" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create change matrix (from_class * 10 + to_class)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>change_matrix <span class="op">=</span> classified_2020.multiply(<span class="dv">10</span>).add(classified_filtered).rename(<span class="st">'change_code'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Forest (1) to Agriculture (4) = change code 14</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Forest (1) to Bare Soil (8) = change code 18</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: Calculate specific transitions</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># forest_to_ag = change_matrix.eq(14).Or(change_matrix.eq(24))  # Primary or Secondary → Ag</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE to calculate areas for different transitions</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="d.5-generate-stakeholder-report" class="level2">
<h2 class="anchored" data-anchor-id="d.5-generate-stakeholder-report">D.5: Generate Stakeholder Report</h2>
<div id="4cad0acd" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary reportprint("=" * 70)print("PALAWAN BIOSPHERE RESERVE - CHANGE DETECTION REPORT (2020-2025)")print("=" * 70)print(f"\nStudy Area: {aoi.area().divide(1e6).getInfo():.2f} km²")print(f"Analysis Period: 2020-2025 (5 years)")print(f"\n--- KEY FINDINGS ---\n")# Forest losstotal_area_km2 = aoi.area().divide(1e6).getInfo()loss_percent = (loss_ha / (total_area_km2 * 100)) * 100print(f"🚨 Total Forest Loss: {loss_ha:,.2f} hectares ({loss_percent:.2f}% of study area)")print(f"📉 Annual Loss Rate: {loss_ha/5:,.2f} hectares/year")# 2025 Land cover summaryprint(f"\n--- 2025 LAND COVER DISTRIBUTION ---\n")for class_name, area in area_stats.items():    percent = (area / (total_area_km2 * 100)) * 100    print(f"  {class_name:20s}: {area:10,.2f} ha ({percent:5.2f}%)")print(f"\n--- CONSERVATION IMPLICATIONS ---\n")print("• Continued monitoring recommended")print("• Priority intervention zones identified via hotspot analysis")print("• Update DENR forest cover database")print("• Inform REDD+ MRV reporting")print("\n" + "=" * 70)print("Report generated:", datetime.now().strftime('%Y-%m-%d %H:%M:%S'))print("=" * 70)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="d.6-export-results" class="level2">
<h2 class="anchored" data-anchor-id="d.6-export-results">D.6: Export Results</h2>
<div id="3bd4cc3e" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Export classification to Google Driveprint("Preparing exports...")# Export 2025 classificationexport_task = ee.batch.Export.image.toDrive(    image=classified_filtered.toUint8(),    description='Palawan_LULC_2025',    folder='EO_Training_Exports',    fileNamePrefix='palawan_lulc_2025',    region=aoi,    scale=10,    maxPixels=1e13,    crs='EPSG:4326')# Don't start automatically in notebookprint("✓ Export tasks configured")print("\nTo start export, run:")print("  export_task.start()")print("\nThen check status at: https://code.earthengine.google.com/tasks")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="export-options" class="level3">
<h3 class="anchored" data-anchor-id="export-options">Export Options</h3>
<p>You can export: - <strong>Classification maps</strong> (GeoTIFF) - <strong>Forest loss</strong> (binary mask) - <strong>Hotspots</strong> (intensity raster) - <strong>Statistics</strong> (CSV via pandas)</p>
<p>For large exports, use Earth Engine Tasks instead of direct download.</p>
<hr>
</section>
<section id="part-d-complete" class="level3">
<h3 class="anchored" data-anchor-id="part-d-complete">🎉 Part D Complete!</h3>
<p>You’ve successfully: - ✅ Created 2020 baseline classification - ✅ Detected forest loss (2020-2024) - ✅ Identified deforestation hotspots - ✅ Generated stakeholder report - ✅ Prepared export tasks</p>
<hr>
<hr>
</section>
</section>
</section>
<section id="lab-complete" class="level1">
<h1>🎓 Lab Complete!</h1>
<section id="summary-of-achievements" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-achievements">Summary of Achievements</h2>
<p>In this 2-hour lab, you:</p>
<section id="part-a-feature-engineering" class="level3">
<h3 class="anchored" data-anchor-id="part-a-feature-engineering">Part A: Feature Engineering</h3>
<ul>
<li>✅ Created seasonal Sentinel-2 composites (dry/wet)</li>
<li>✅ Calculated spectral indices (NDVI, NDWI, NDBI, EVI)</li>
<li>✅ Extracted GLCM texture features</li>
<li>✅ Derived temporal phenology features</li>
<li>✅ Integrated topographic data (DEM)</li>
<li>✅ Built comprehensive 23-feature stack</li>
</ul>
</section>
<section id="part-b-classification" class="level3">
<h3 class="anchored" data-anchor-id="part-b-classification">Part B: Classification</h3>
<ul>
<li>✅ Loaded training/validation data (80+40 polygons)</li>
<li>✅ Trained Random Forest classifier</li>
<li>✅ Applied 8-class land cover classification</li>
<li>✅ Achieved &gt;85% accuracy (hopefully!)</li>
<li>✅ Analyzed feature importance</li>
<li>✅ Calculated area statistics</li>
</ul>
</section>
<section id="part-c-optimization" class="level3">
<h3 class="anchored" data-anchor-id="part-c-optimization">Part C: Optimization</h3>
<ul>
<li>✅ Performed hyperparameter tuning</li>
<li>✅ Tested multiple tree counts</li>
<li>✅ Applied post-processing filters</li>
<li>✅ Improved classification quality</li>
</ul>
</section>
<section id="part-d-nrm-applications" class="level3">
<h3 class="anchored" data-anchor-id="part-d-nrm-applications">Part D: NRM Applications</h3>
<ul>
<li>✅ Created 2020 baseline classification</li>
<li>✅ Detected forest loss (2020-2024)</li>
<li>✅ Identified deforestation hotspots</li>
<li>✅ Generated stakeholder-ready reports</li>
<li>✅ Prepared GIS exports</li>
</ul>
<hr>
</section>
</section>
<section id="key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="key-takeaways">Key Takeaways</h2>
<ol type="1">
<li><strong>Multi-temporal analysis</strong> significantly improves classification accuracy</li>
<li><strong>Texture features</strong> help distinguish land covers with similar spectra</li>
<li><strong>Topography</strong> provides valuable context for land use patterns</li>
<li><strong>Hyperparameter tuning</strong> can boost accuracy by 2-5%</li>
<li><strong>Change detection</strong> enables monitoring of conservation priorities</li>
</ol>
<hr>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<section id="session-3-introduction-to-deep-learning-cnns" class="level3">
<h3 class="anchored" data-anchor-id="session-3-introduction-to-deep-learning-cnns">Session 3: Introduction to Deep Learning &amp; CNNs</h3>
<p>You’re now ready to explore deep learning approaches that can: - Learn features automatically (vs manual engineering) - Handle complex spatial patterns - Achieve higher accuracy on challenging classes - Scale to very large areas</p>
<p><a href="../../../course_site/day2/sessions/session3.qmd">Continue to Session 3 →</a></p>
</section>
<section id="extended-exercises" class="level3">
<h3 class="anchored" data-anchor-id="extended-exercises">Extended Exercises</h3>
<p>Want more practice? Try:</p>
<ol type="1">
<li><strong>Expand to full Palawan</strong> (entire province)</li>
<li><strong>Add more classes</strong> (coconut vs rice, forest subtypes)</li>
<li><strong>Annual time series</strong> (2017-2024 trends)</li>
<li><strong>Integration with field data</strong></li>
<li><strong>Automated monitoring</strong> (monthly updates)</li>
</ol>
<hr>
</section>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<section id="code-templates" class="level3">
<h3 class="anchored" data-anchor-id="code-templates">Code Templates</h3>
<ul>
<li><a href="../templates/glcm_template.py"><code>glcm_template.py</code></a></li>
<li><a href="../templates/temporal_composite_template.py"><code>temporal_composite_template.py</code></a></li>
<li><a href="../templates/change_detection_template.py"><code>change_detection_template.py</code></a></li>
</ul>
</section>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
<ul>
<li><a href="https://developers.google.com/earth-engine/guides/classification">GEE Classification Guide</a></li>
<li><a href="../../../course_site/day2/sessions/session2.qmd">Session 2 Overview</a></li>
<li><a href="../../day2/documentation/TROUBLESHOOTING.html">Troubleshooting Guide</a></li>
</ul>
</section>
<section id="training-data" class="level3">
<h3 class="anchored" data-anchor-id="training-data">Training Data</h3>
<ul>
<li><a href="../data/palawan_training_polygons.geojson">Palawan Training Polygons</a></li>
<li><a href="../../day2/data/class_definitions.html">Class Definitions</a></li>
</ul>
<hr>
</section>
</section>
<section id="questions-or-issues" class="level2">
<h2 class="anchored" data-anchor-id="questions-or-issues">Questions or Issues?</h2>
<ul>
<li>📖 Review session documentation</li>
<li>💬 Ask instructor during office hours</li>
<li>🌐 Check GEE community forums</li>
<li>📧 Submit via course platform</li>
</ul>
<hr>
</section>
<section id="congratulations" class="level2">
<h2 class="anchored" data-anchor-id="congratulations">Congratulations! 🎉</h2>
<p>You’ve mastered advanced EO classification techniques and are ready for deep learning!</p>
<p><strong>Session completed:</strong></p>
<hr>
<p><em>Developed for CoPhil Advanced Training Program</em><br>
<em>EU-Philippines Copernicus Programme</em></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="cophil-training-v1.0" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../day2/notebooks/session1_hands_on_lab_student.html" class="pagination-link" aria-label="Session 1 Hands-on Lab: Palawan Land Cover Classification with Random Forest">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Session 1 Hands-on Lab: Palawan Land Cover Classification with Random Forest</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../day2/notebooks/session3_theory_interactive.html" class="pagination-link" aria-label="Session 3: Deep Learning &amp; CNN Theory - Interactive Notebook">
        <span class="nav-page-text">Session 3: Deep Learning &amp; CNN Theory - Interactive Notebook</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>CoPhil EO AI/ML Training Programme</p>
</div>   
    <div class="nav-footer-center">
<p>Funded by the European Union - Global Gateway Initiative</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:skotsopoulos@neuralio.ai">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://philsa.gov.ph">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>