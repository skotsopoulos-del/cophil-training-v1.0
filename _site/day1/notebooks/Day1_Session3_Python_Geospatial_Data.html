<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Day 1, Session 3: Python for Geospatial Data – CoPhil EO AI/ML Training</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../day1/notebooks/Day1_Session4_Google_Earth_Engine.html" rel="next">
<link href="../../day1/notebooks/notebook2.html" rel="prev">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-c9822816d3895e59fda95a6fa7545fef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3775014fae9fc394bbda1d6ff89dd45e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-509191933"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-509191933', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles/custom.css">
<link rel="stylesheet" href="../../styles/phase2-enhancements.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">CoPhil EO AI/ML Training</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-training-days" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Training Days</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-training-days">    
        <li>
    <a class="dropdown-item" href="../../day1/index.html">
 <span class="dropdown-text">Day 1: EO Data &amp; Fundamentals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day2/index.html">
 <span class="dropdown-text">Day 2: Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day3/index.html">
 <span class="dropdown-text">Day 3: Deep Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../day4/index.html">
 <span class="dropdown-text">Day 4: Advanced Topics</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../../resources/setup.html">
 <span class="dropdown-text">Setup Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/philippine-eo.html">
 <span class="dropdown-text">Philippine EO Links</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/cheatsheets.html">
 <span class="dropdown-text">Cheat Sheets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/faq.html">
 <span class="dropdown-text">FAQ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../resources/glossary.html">
 <span class="dropdown-text">Glossary</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../resources/downloads.html"> <i class="bi bi-download" role="img">
</i> 
<span class="menu-text">Materials</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day1/notebooks/notebook1.html">Notebooks</a></li><li class="breadcrumb-item"><a href="../../day1/notebooks/Day1_Session3_Python_Geospatial_Data.html">Day 1, Session 3: Python for Geospatial Data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 1: EO Data &amp; AI/ML Fundamentals</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Sessions</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/sessions/session1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 1: Copernicus Sentinel Data Deep Dive &amp; Philippine EO Ecosystem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/sessions/session2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 2: Core Concepts of AI/ML for Earth Observation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/sessions/session3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 3: Hands-on Python for Geospatial Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/sessions/session4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Session 4: Introduction to Google Earth Engine</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Notebooks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/notebooks/notebook1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook 1: Python for Geospatial Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/notebooks/notebook2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Notebook 2: Google Earth Engine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/notebooks/Day1_Session3_Python_Geospatial_Data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Day 1, Session 3: Python for Geospatial Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../day1/notebooks/Day1_Session4_Google_Earth_Engine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Day 1, Session 4: Google Earth Engine Python API</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">On This Page</h2>
   
  <ul>
  <li><a href="#cophil-4-day-advanced-training-on-aiml-for-earth-observation" id="toc-cophil-4-day-advanced-training-on-aiml-for-earth-observation" class="nav-link active" data-scroll-target="#cophil-4-day-advanced-training-on-aiml-for-earth-observation">CoPhil 4-Day Advanced Training on AI/ML for Earth Observation</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#why-this-session-matters" id="toc-why-this-session-matters" class="nav-link" data-scroll-target="#why-this-session-matters">Why This Session Matters</a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">Prerequisites</a></li>
  <li><a href="#session-structure" id="toc-session-structure" class="nav-link" data-scroll-target="#session-structure">Session Structure</a></li>
  <li><a href="#part-1-environment-setup" id="toc-part-1-environment-setup" class="nav-link" data-scroll-target="#part-1-environment-setup">Part 1: Environment Setup</a>
  <ul class="collapse">
  <li><a href="#mount-google-drive" id="toc-mount-google-drive" class="nav-link" data-scroll-target="#mount-google-drive">1.1 Mount Google Drive</a></li>
  <li><a href="#install-required-packagescore-geospatial-libraries--geopandas---vector-data-shapefiles-geojson--rasterio---raster-data-geotiff-satellite-imagery--shapely---geometric-operations--pyproj---coordinate-reference-systems--pystac-client---search-satellite-imagery-catalogs-stac-api--planetary-computer---access-microsoft-planetary-computer-datainstallation-time-1-2-minutes" id="toc-install-required-packagescore-geospatial-libraries--geopandas---vector-data-shapefiles-geojson--rasterio---raster-data-geotiff-satellite-imagery--shapely---geometric-operations--pyproj---coordinate-reference-systems--pystac-client---search-satellite-imagery-catalogs-stac-api--planetary-computer---access-microsoft-planetary-computer-datainstallation-time-1-2-minutes" class="nav-link" data-scroll-target="#install-required-packagescore-geospatial-libraries--geopandas---vector-data-shapefiles-geojson--rasterio---raster-data-geotiff-satellite-imagery--shapely---geometric-operations--pyproj---coordinate-reference-systems--pystac-client---search-satellite-imagery-catalogs-stac-api--planetary-computer---access-microsoft-planetary-computer-datainstallation-time-1-2-minutes">1.2 Install Required Packages<strong>Core geospatial libraries:</strong>- <strong><code>geopandas</code></strong> - Vector data (shapefiles, GeoJSON)- <strong><code>rasterio</code></strong> - Raster data (GeoTIFF, satellite imagery)- <strong><code>shapely</code></strong> - Geometric operations- <strong><code>pyproj</code></strong> - Coordinate reference systems- <strong><code>pystac-client</code></strong> - Search satellite imagery catalogs (STAC API)- <strong><code>planetary-computer</code></strong> - Access Microsoft Planetary Computer data<strong>Installation time:</strong> 1-2 minutes</a></li>
  <li><a href="#import-libraries-and-verify-installation" id="toc-import-libraries-and-verify-installation" class="nav-link" data-scroll-target="#import-libraries-and-verify-installation">1.3 Import Libraries and Verify Installation</a></li>
  </ul></li>
  <li><a href="#part-2-python-basics-quick-recap" id="toc-part-2-python-basics-quick-recap" class="nav-link" data-scroll-target="#part-2-python-basics-quick-recap">Part 2: Python Basics Quick Recap</a>
  <ul class="collapse">
  <li><a href="#data-types-and-structures" id="toc-data-types-and-structures" class="nav-link" data-scroll-target="#data-types-and-structures">2.1 Data Types and Structures</a></li>
  <li><a href="#control-structures---loops-and-conditionals" id="toc-control-structures---loops-and-conditionals" class="nav-link" data-scroll-target="#control-structures---loops-and-conditionals">2.2 Control Structures - Loops and Conditionals</a></li>
  <li><a href="#functions---reusable-code-blocks" id="toc-functions---reusable-code-blocks" class="nav-link" data-scroll-target="#functions---reusable-code-blocks">2.3 Functions - Reusable Code Blocks</a></li>
  <li><a href="#inspecting-the-geodataframe" id="toc-inspecting-the-geodataframe" class="nav-link" data-scroll-target="#inspecting-the-geodataframe">3.2 Inspecting the GeoDataFrame</a></li>
  <li><a href="#filtering-and-querying-vector-data" id="toc-filtering-and-querying-vector-data" class="nav-link" data-scroll-target="#filtering-and-querying-vector-data">3.3 Filtering and Querying Vector Data</a></li>
  <li><a href="#spatial-operations" id="toc-spatial-operations" class="nav-link" data-scroll-target="#spatial-operations">3.4 Spatial Operations</a></li>
  <li><a href="#visualizing-vector-data" id="toc-visualizing-vector-data" class="nav-link" data-scroll-target="#visualizing-vector-data">3.5 Visualizing Vector Data</a></li>
  <li><a href="#exercise-1-select-and-plot-your-home-province" id="toc-exercise-1-select-and-plot-your-home-province" class="nav-link" data-scroll-target="#exercise-1-select-and-plot-your-home-province">📝 Exercise 1: Select and Plot Your Home Province</a></li>
  <li><a href="#writing-real-sentinel-2-subset-to-local-filelets-save-this-subset-as-a-multi-band-geotiff-for-later-use." id="toc-writing-real-sentinel-2-subset-to-local-filelets-save-this-subset-as-a-multi-band-geotiff-for-later-use." class="nav-link" data-scroll-target="#writing-real-sentinel-2-subset-to-local-filelets-save-this-subset-as-a-multi-band-geotiff-for-later-use.">4.2 Writing Real Sentinel-2 Subset to Local FileLet’s save this subset as a multi-band GeoTIFF for later use.</a></li>
  <li><a href="#saving-real-data-subset-as-local-geotifffor-convenience-and-to-demonstrate-file-io-operations-lets-save-this-real-sentinel-2-subset-as-a-local-geotiff-file." id="toc-saving-real-data-subset-as-local-geotifffor-convenience-and-to-demonstrate-file-io-operations-lets-save-this-real-sentinel-2-subset-as-a-local-geotiff-file." class="nav-link" data-scroll-target="#saving-real-data-subset-as-local-geotifffor-convenience-and-to-demonstrate-file-io-operations-lets-save-this-real-sentinel-2-subset-as-a-local-geotiff-file.">4.3 Saving Real Data Subset as Local GeoTIFFFor convenience and to demonstrate file I/O operations, let’s save this real Sentinel-2 subset as a local GeoTIFF file.</a></li>
  <li><a href="#reading-raster-data-as-numpy-arrays" id="toc-reading-raster-data-as-numpy-arrays" class="nav-link" data-scroll-target="#reading-raster-data-as-numpy-arrays">4.5 Reading Raster Data as NumPy Arrays</a></li>
  <li><a href="#calculating-band-statisticslets-examine-the-real-spectral-signatures-from-palawan" id="toc-calculating-band-statisticslets-examine-the-real-spectral-signatures-from-palawan" class="nav-link" data-scroll-target="#calculating-band-statisticslets-examine-the-real-spectral-signatures-from-palawan">4.6 Calculating Band StatisticsLet’s examine the real spectral signatures from Palawan:</a></li>
  <li><a href="#visualizing-single-bands" id="toc-visualizing-single-bands" class="nav-link" data-scroll-target="#visualizing-single-bands">4.7 Visualizing Single Bands</a></li>
  <li><a href="#visualizing-single-bands-1" id="toc-visualizing-single-bands-1" class="nav-link" data-scroll-target="#visualizing-single-bands-1">4.6 Visualizing Single Bands</a></li>
  <li><a href="#false-color-compositesfalse-color-composites-use-non-visible-bands-to-highlight-specific-features." id="toc-false-color-compositesfalse-color-composites-use-non-visible-bands-to-highlight-specific-features." class="nav-link" data-scroll-target="#false-color-compositesfalse-color-composites-use-non-visible-bands-to-highlight-specific-features.">4.9 False Color CompositesFalse color composites use <strong>non-visible</strong> bands to highlight specific features.</a></li>
  <li><a href="#calculating-ndvi-normalized-difference-vegetation-indexndvi-is-the-most-important-vegetation-index-in-remote-sensing.ndvi-fracnir---rednir-redinterpretation---1-to-0-water-bare-soil-snow--0-to-0.2-sparse-vegetation-rock--0.2-to-0.5-shrubs-grassland--0.5-to-0.8-dense-vegetation-healthy-crops--0.8-to-1-very-dense-vegetation-tropical-forest" id="toc-calculating-ndvi-normalized-difference-vegetation-indexndvi-is-the-most-important-vegetation-index-in-remote-sensing.ndvi-fracnir---rednir-redinterpretation---1-to-0-water-bare-soil-snow--0-to-0.2-sparse-vegetation-rock--0.2-to-0.5-shrubs-grassland--0.5-to-0.8-dense-vegetation-healthy-crops--0.8-to-1-very-dense-vegetation-tropical-forest" class="nav-link" data-scroll-target="#calculating-ndvi-normalized-difference-vegetation-indexndvi-is-the-most-important-vegetation-index-in-remote-sensing.ndvi-fracnir---rednir-redinterpretation---1-to-0-water-bare-soil-snow--0-to-0.2-sparse-vegetation-rock--0.2-to-0.5-shrubs-grassland--0.5-to-0.8-dense-vegetation-healthy-crops--0.8-to-1-very-dense-vegetation-tropical-forest">4.10 Calculating NDVI (Normalized Difference Vegetation Index)<strong>NDVI is THE most important vegetation index in remote sensing.</strong><span class="math display">\[NDVI = \frac{NIR - Red}{NIR + Red}\]</span><strong>Interpretation:</strong>- <strong>-1 to 0</strong>: Water, bare soil, snow- <strong>0 to 0.2</strong>: Sparse vegetation, rock- <strong>0.2 to 0.5</strong>: Shrubs, grassland- <strong>0.5 to 0.8</strong>: Dense vegetation, healthy crops- <strong>0.8 to 1</strong>: Very dense vegetation (tropical forest)</a></li>
  <li><a href="#calculating-ndvi-normalized-difference-vegetation-index" id="toc-calculating-ndvi-normalized-difference-vegetation-index" class="nav-link" data-scroll-target="#calculating-ndvi-normalized-difference-vegetation-index">4.9 Calculating NDVI (Normalized Difference Vegetation Index)</a></li>
  <li><a href="#ndvi-histogram-and-distribution-analysis" id="toc-ndvi-histogram-and-distribution-analysis" class="nav-link" data-scroll-target="#ndvi-histogram-and-distribution-analysis">4.10 NDVI Histogram and Distribution Analysis</a></li>
  <li><a href="#exercise-2-calculate-and-visualize-ndwi-water-index" id="toc-exercise-2-calculate-and-visualize-ndwi-water-index" class="nav-link" data-scroll-target="#exercise-2-calculate-and-visualize-ndwi-water-index">📝 Exercise 2: Calculate and Visualize NDWI (Water Index)</a></li>
  </ul></li>
  <li><a href="#part-5-combined-operations---vector-and-raster-integration" id="toc-part-5-combined-operations---vector-and-raster-integration" class="nav-link" data-scroll-target="#part-5-combined-operations---vector-and-raster-integration">Part 5: Combined Operations - Vector and Raster Integration</a>
  <ul class="collapse">
  <li><a href="#clipping-raster-to-vector-boundary" id="toc-clipping-raster-to-vector-boundary" class="nav-link" data-scroll-target="#clipping-raster-to-vector-boundary">5.1 Clipping Raster to Vector Boundary</a></li>
  <li><a href="#overlay-vector-boundaries-on-raster" id="toc-overlay-vector-boundaries-on-raster" class="nav-link" data-scroll-target="#overlay-vector-boundaries-on-raster">5.2 Overlay Vector Boundaries on Raster</a></li>
  <li><a href="#zonal-statistics---calculate-mean-ndvi-per-province" id="toc-zonal-statistics---calculate-mean-ndvi-per-province" class="nav-link" data-scroll-target="#zonal-statistics---calculate-mean-ndvi-per-province">5.3 Zonal Statistics - Calculate Mean NDVI per Province</a></li>
  <li><a href="#saving-results" id="toc-saving-results" class="nav-link" data-scroll-target="#saving-results">5.4 Saving Results</a></li>
  </ul></li>
  <li><a href="#part-6-best-practices-and-common-pitfalls" id="toc-part-6-best-practices-and-common-pitfalls" class="nav-link" data-scroll-target="#part-6-best-practices-and-common-pitfalls">Part 6: Best Practices and Common Pitfalls</a>
  <ul class="collapse">
  <li><a href="#memory-management" id="toc-memory-management" class="nav-link" data-scroll-target="#memory-management">6.1 Memory Management</a></li>
  <li><a href="#crs-alignment---critical" id="toc-crs-alignment---critical" class="nav-link" data-scroll-target="#crs-alignment---critical">6.2 CRS Alignment - CRITICAL!</a></li>
  <li><a href="#handling-nodata-values" id="toc-handling-nodata-values" class="nav-link" data-scroll-target="#handling-nodata-values">6.3 Handling NoData Values</a></li>
  <li><a href="#common-errors-and-solutions" id="toc-common-errors-and-solutions" class="nav-link" data-scroll-target="#common-errors-and-solutions">6.4 Common Errors and Solutions</a></li>
  </ul></li>
  <li><a href="#summary-and-key-takeaways" id="toc-summary-and-key-takeaways" class="nav-link" data-scroll-target="#summary-and-key-takeaways">Summary and Key Takeaways</a>
  <ul class="collapse">
  <li><a href="#what-youve-learned-today" id="toc-what-youve-learned-today" class="nav-link" data-scroll-target="#what-youve-learned-today">What You’ve Learned Today:</a></li>
  <li><a href="#why-this-matters-for-aiml" id="toc-why-this-matters-for-aiml" class="nav-link" data-scroll-target="#why-this-matters-for-aiml">Why This Matters for AI/ML</a></li>
  <li><a href="#philippine-eo-applications" id="toc-philippine-eo-applications" class="nav-link" data-scroll-target="#philippine-eo-applications">Philippine EO Applications</a></li>
  </ul></li>
  <li><a href="#next-session-google-earth-engine-python-api" id="toc-next-session-google-earth-engine-python-api" class="nav-link" data-scroll-target="#next-session-google-earth-engine-python-api">Next Session: Google Earth Engine Python API</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a>
  <ul class="collapse">
  <li><a href="#documentation" id="toc-documentation" class="nav-link" data-scroll-target="#documentation">Documentation</a></li>
  <li><a href="#tutorials" id="toc-tutorials" class="nav-link" data-scroll-target="#tutorials">Tutorials</a></li>
  <li><a href="#philippine-data-sources" id="toc-philippine-data-sources" class="nav-link" data-scroll-target="#philippine-data-sources">Philippine Data Sources</a></li>
  <li><a href="#books" id="toc-books" class="nav-link" data-scroll-target="#books">Books</a></li>
  </ul></li>
  <li><a href="#practice-exercises-optional-homework" id="toc-practice-exercises-optional-homework" class="nav-link" data-scroll-target="#practice-exercises-optional-homework">Practice Exercises (Optional Homework)</a>
  <ul class="collapse">
  <li><a href="#exercise-a-multi-province-analysis" id="toc-exercise-a-multi-province-analysis" class="nav-link" data-scroll-target="#exercise-a-multi-province-analysis">Exercise A: Multi-Province Analysis</a></li>
  <li><a href="#exercise-b-time-series-simulation" id="toc-exercise-b-time-series-simulation" class="nav-link" data-scroll-target="#exercise-b-time-series-simulation">Exercise B: Time-Series Simulation</a></li>
  <li><a href="#exercise-c-custom-index" id="toc-exercise-c-custom-index" class="nav-link" data-scroll-target="#exercise-c-custom-index">Exercise C: Custom Index</a></li>
  <li><a href="#exercise-d-real-data" id="toc-exercise-d-real-data" class="nav-link" data-scroll-target="#exercise-d-real-data">Exercise D: Real Data</a></li>
  <li><a href="#exercise-e-water-detection" id="toc-exercise-e-water-detection" class="nav-link" data-scroll-target="#exercise-e-water-detection">Exercise E: Water Detection</a></li>
  </ul></li>
  <li><a href="#clean-up" id="toc-clean-up" class="nav-link" data-scroll-target="#clean-up">Clean Up</a></li>
  <li><a href="#congratulations" id="toc-congratulations" class="nav-link" data-scroll-target="#congratulations">🎉 Congratulations!</a>
  <ul class="collapse">
  <li><a href="#you-now-have-the-skills-to" id="toc-you-now-have-the-skills-to" class="nav-link" data-scroll-target="#you-now-have-the-skills-to">You now have the skills to:</a></li>
  <li><a href="#these-are-the-foundational-skills-for-all-aiml-work-in-earth-observation" id="toc-these-are-the-foundational-skills-for-all-aiml-work-in-earth-observation" class="nav-link" data-scroll-target="#these-are-the-foundational-skills-for-all-aiml-work-in-earth-observation">These are the <strong>foundational skills</strong> for ALL AI/ML work in Earth Observation!</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../day1/notebooks/notebook1.html">Notebooks</a></li><li class="breadcrumb-item"><a href="../../day1/notebooks/Day1_Session3_Python_Geospatial_Data.html">Day 1, Session 3: Python for Geospatial Data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Day 1, Session 3: Python for Geospatial Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="cophil-4-day-advanced-training-on-aiml-for-earth-observation" class="level2">
<h2 class="anchored" data-anchor-id="cophil-4-day-advanced-training-on-aiml-for-earth-observation">CoPhil 4-Day Advanced Training on AI/ML for Earth Observation</h2>
<p><strong>EU-Philippines Copernicus Capacity Support Programme</strong></p>
<hr>
</section>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>By the end of this session, you will be able to:</p>
<ol type="1">
<li><strong>Set up</strong> a Python geospatial environment in Google Colab</li>
<li><strong>Load, inspect, and visualize</strong> vector data using <strong>GeoPandas</strong></li>
<li><strong>Load, inspect, and visualize</strong> raster data using <strong>Rasterio</strong></li>
<li><strong>Perform</strong> basic geospatial operations (filtering, clipping, cropping)</li>
<li><strong>Calculate</strong> vegetation indices (NDVI, NDWI) from Sentinel-2 imagery</li>
<li><strong>Combine</strong> vector and raster data for integrated analysis</li>
<li><strong>Apply</strong> these skills to Philippine EO applications (DRR, CCA, NRM)</li>
</ol>
<hr>
</section>
<section id="why-this-session-matters" class="level2">
<h2 class="anchored" data-anchor-id="why-this-session-matters">Why This Session Matters</h2>
<p><strong>Python geospatial skills are the foundation of ALL AI/ML workflows in Earth Observation.</strong></p>
<p>You cannot: - Train a model without loading training data ✗ - Preprocess satellite images without raster operations ✗ - Validate results without vector boundaries ✗ - Deploy solutions without understanding data formats ✗</p>
<p><strong>This session gives you the superpowers to:</strong> - Handle Sentinel-2 imagery like a pro ✓ - Work with Philippine administrative boundaries ✓ - Prepare analysis-ready datasets ✓ - Build production-ready EO applications ✓</p>
<hr>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">Prerequisites</h2>
<ul>
<li>Basic Python knowledge (variables, loops, functions)</li>
<li>Google account for Colab access</li>
<li>Completion of Sessions 1-2 (Copernicus overview, AI/ML concepts)</li>
</ul>
<hr>
</section>
<section id="session-structure" class="level2">
<h2 class="anchored" data-anchor-id="session-structure">Session Structure</h2>
<p><strong>Part 1:</strong> Environment Setup (10 min) <strong>Part 2:</strong> Python Basics Recap (10 min) <strong>Part 3:</strong> GeoPandas for Vector Data (40 min) <strong>Part 4:</strong> Rasterio for Raster Data (50 min) <strong>Part 5:</strong> Combined Operations (30 min)</p>
<p><strong>Total:</strong> ~2 hours with exercises</p>
<hr>
</section>
<section id="part-1-environment-setup" class="level2">
<h2 class="anchored" data-anchor-id="part-1-environment-setup">Part 1: Environment Setup</h2>
<section id="mount-google-drive" class="level3">
<h3 class="anchored" data-anchor-id="mount-google-drive">1.1 Mount Google Drive</h3>
<p>We’ll use Google Drive to: - Access sample datasets - Save outputs and results - Share data between sessions</p>
<div id="cell-3" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mount Google Drive</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">'/content/drive'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create working directory</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>work_dir <span class="op">=</span> <span class="st">'/content/drive/MyDrive/CoPhil_Training'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>os.makedirs(work_dir, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>os.makedirs(<span class="ss">f'</span><span class="sc">{</span>work_dir<span class="sc">}</span><span class="ss">/outputs'</span>, exist_ok<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Google Drive mounted successfully!"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"✓ Working directory: </span><span class="sc">{</span>work_dir<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="install-required-packagescore-geospatial-libraries--geopandas---vector-data-shapefiles-geojson--rasterio---raster-data-geotiff-satellite-imagery--shapely---geometric-operations--pyproj---coordinate-reference-systems--pystac-client---search-satellite-imagery-catalogs-stac-api--planetary-computer---access-microsoft-planetary-computer-datainstallation-time-1-2-minutes" class="level3">
<h3 class="anchored" data-anchor-id="install-required-packagescore-geospatial-libraries--geopandas---vector-data-shapefiles-geojson--rasterio---raster-data-geotiff-satellite-imagery--shapely---geometric-operations--pyproj---coordinate-reference-systems--pystac-client---search-satellite-imagery-catalogs-stac-api--planetary-computer---access-microsoft-planetary-computer-datainstallation-time-1-2-minutes">1.2 Install Required Packages<strong>Core geospatial libraries:</strong>- <strong><code>geopandas</code></strong> - Vector data (shapefiles, GeoJSON)- <strong><code>rasterio</code></strong> - Raster data (GeoTIFF, satellite imagery)- <strong><code>shapely</code></strong> - Geometric operations- <strong><code>pyproj</code></strong> - Coordinate reference systems- <strong><code>pystac-client</code></strong> - Search satellite imagery catalogs (STAC API)- <strong><code>planetary-computer</code></strong> - Access Microsoft Planetary Computer data<strong>Installation time:</strong> 1-2 minutes</h3>
<div id="cell-5" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install geospatial libraries (suppress output for cleaner notebook)!pip install geopandas rasterio shapely pyproj matplotlib contextily pystac-client planetary-computer -qprint("✓ All packages installed successfully!")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="import-libraries-and-verify-installation" class="level3">
<h3 class="anchored" data-anchor-id="import-libraries-and-verify-installation">1.3 Import Libraries and Verify Installation</h3>
<div id="cell-7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core scientific libraries</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Patch</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Geospatial libraries</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rasterio</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.plot <span class="im">import</span> show</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.mask <span class="im">import</span> mask</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.warp <span class="im">import</span> calculate_default_transform, reproject, Resampling</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point, Polygon, box</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress warnings for cleaner output</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set visualization defaults for professional-looking plots</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.dpi'</span>] <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.labelsize'</span>] <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'axes.titlesize'</span>] <span class="op">=</span> <span class="dv">13</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'xtick.labelsize'</span>] <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'ytick.labelsize'</span>] <span class="op">=</span> <span class="dv">9</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'legend.fontsize'</span>] <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print versions</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ All libraries imported successfully!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Library Versions:"</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • NumPy: </span><span class="sc">{</span>np<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Pandas: </span><span class="sc">{</span>pd<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • GeoPandas: </span><span class="sc">{</span>gpd<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Rasterio: </span><span class="sc">{</span>rasterio<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  • Matplotlib: </span><span class="sc">{</span>plt<span class="sc">.</span>matplotlib<span class="sc">.</span>__version__<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="part-2-python-basics-quick-recap" class="level2">
<h2 class="anchored" data-anchor-id="part-2-python-basics-quick-recap">Part 2: Python Basics Quick Recap</h2>
<p>Before diving into geospatial operations, let’s review Python fundamentals you’ll encounter throughout this notebook.</p>
<p><strong>If you’re comfortable with Python, feel free to skim this section.</strong></p>
<section id="data-types-and-structures" class="level3">
<h3 class="anchored" data-anchor-id="data-types-and-structures">2.1 Data Types and Structures</h3>
<div id="cell-9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Strings - text data</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>province_name <span class="op">=</span> <span class="st">"Palawan"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>region <span class="op">=</span> <span class="st">"MIMAROPA"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Numbers - integers and floats</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>population <span class="op">=</span> <span class="dv">1200000</span>  <span class="co"># integer</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>area_km2 <span class="op">=</span> <span class="fl">14649.73</span>   <span class="co"># float (decimal)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Lists - ordered collections (can be modified)</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>philippine_islands <span class="op">=</span> [<span class="st">"Luzon"</span>, <span class="st">"Visayas"</span>, <span class="st">"Mindanao"</span>]</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>band_numbers <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">8</span>]  <span class="co"># Sentinel-2 bands</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionaries - key-value pairs</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>province_data <span class="op">=</span> {</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name"</span>: <span class="st">"Palawan"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"capital"</span>: <span class="st">"Puerto Princesa"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"population"</span>: <span class="dv">1200000</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"area_km2"</span>: <span class="fl">14649.73</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"coordinates"</span>: [<span class="fl">118.73</span>, <span class="fl">9.85</span>]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Accessing data</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Province: </span><span class="sc">{</span>province_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"First island: </span><span class="sc">{</span>philippine_islands[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Capital: </span><span class="sc">{</span>province_data[<span class="st">'capital'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Population density: </span><span class="sc">{</span>population <span class="op">/</span> area_km2<span class="sc">:.1f}</span><span class="ss"> people/km²"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="control-structures---loops-and-conditionals" class="level3">
<h3 class="anchored" data-anchor-id="control-structures---loops-and-conditionals">2.2 Control Structures - Loops and Conditionals</h3>
<div id="cell-11" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For loops - iterate over collections</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Philippine Island Groups:"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> island <span class="kw">in</span> philippine_islands:</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  • </span><span class="sc">{</span>island<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># If-elif-else - conditional execution</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>ndvi_value <span class="op">=</span> <span class="fl">0.65</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> ndvi_value <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    vegetation_class <span class="op">=</span> <span class="st">"Water/Bare soil"</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ndvi_value <span class="op">&lt;</span> <span class="fl">0.2</span>:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    vegetation_class <span class="op">=</span> <span class="st">"Sparse vegetation"</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ndvi_value <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    vegetation_class <span class="op">=</span> <span class="st">"Moderate vegetation"</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    vegetation_class <span class="op">=</span> <span class="st">"Dense vegetation"</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">NDVI = </span><span class="sc">{</span>ndvi_value<span class="sc">}</span><span class="ss"> → </span><span class="sc">{</span>vegetation_class<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># List comprehension - compact way to create lists</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>band_names <span class="op">=</span> [<span class="ss">f"Band_</span><span class="sc">{</span>b<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> b <span class="kw">in</span> band_numbers]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Band names: </span><span class="sc">{</span>band_names<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="functions---reusable-code-blocks" class="level3">
<h3 class="anchored" data-anchor-id="functions---reusable-code-blocks">2.3 Functions - Reusable Code Blocks</h3>
<div id="cell-13" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ndvi(nir, red):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate Normalized Difference Vegetation Index.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">    NDVI = (NIR - Red) / (NIR + Red)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">    -----------</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">    nir : array-like</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">        Near-infrared band values</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">    red : array-like</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">        Red band values</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">    --------</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">    ndvi : array-like</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">        NDVI values (-1 to 1)</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to float to avoid integer division</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    nir <span class="op">=</span> nir.astype(<span class="bu">float</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    red <span class="op">=</span> red.astype(<span class="bu">float</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate NDVI, handling division by zero</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    denominator <span class="op">=</span> nir <span class="op">+</span> red</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    ndvi <span class="op">=</span> np.where(denominator <span class="op">!=</span> <span class="dv">0</span>, (nir <span class="op">-</span> red) <span class="op">/</span> denominator, <span class="dv">0</span>)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ndvi</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>nir_test <span class="op">=</span> np.array([<span class="dv">5000</span>, <span class="dv">3000</span>, <span class="dv">1000</span>])</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>red_test <span class="op">=</span> np.array([<span class="dv">1500</span>, <span class="dv">1200</span>, <span class="dv">900</span>])</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_ndvi(nir_test, red_test)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"NDVI Calculation Test:"</span>)</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(result)):</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  NIR=</span><span class="sc">{</span>nir_test[i]<span class="sc">}</span><span class="ss">, Red=</span><span class="sc">{</span>red_test[i]<span class="sc">}</span><span class="ss"> → NDVI=</span><span class="sc">{</span>result[i]<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>—## Part 3: GeoPandas for Vector Data<strong>GeoPandas</strong> extends pandas for geospatial vector data (points, lines, polygons).### Why GeoPandas?- ✓ Read/write multiple formats (Shapefile, GeoJSON, KML, etc.)- ✓ Spatial operations (intersection, buffer, union)- ✓ Coordinate reference system (CRS) transformations- ✓ Easy visualization- ✓ Integration with pandas (filtering, grouping, etc.)### 3.1 Loading Real Philippine Administrative BoundariesWe’ll load actual Philippine province boundaries from <strong>Natural Earth Data</strong>, a public domain dataset maintained by cartographers worldwide.<strong>Data Source:</strong> https://www.naturalearthdata.com/ <strong>License:</strong> Public Domain <strong>Coverage:</strong> Global administrative boundaries</p>
<div id="cell-15" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Philippine provinces from Natural Earth Dataprint("Loading Philippine administrative boundaries from Natural Earth...")print("This may take a moment on first load (downloading ~2MB)...\n")# Natural Earth Admin 1 (provinces/states) - 10m resolutionurl = "https://naciscdn.org/naturalearth/10m/cultural/ne_10m_admin_1_states_provinces.zip"# Read all provinces worldwideworld_provinces = gpd.read_file(url)# Filter for Philippines onlyphilippines_gdf = world_provinces[world_provinces['admin'] == 'Philippines'].copy()# Select and rename relevant columns for clarityphilippines_gdf = philippines_gdf[['name', 'region', 'geometry']].copy()philippines_gdf.columns = ['Province', 'Region', 'geometry']# Add approximate population data for major provinces (2020 estimates)# Source: Philippine Statistics Authority (PSA)pop_data = {    'Metropolitan Manila': 13484462,    'Cebu': 5155000,    'Pangasinan': 3163000,    'Bulacan': 3708000,    'Cavite': 4344000,    'Laguna': 3382000,    'Rizal': 3330000,    'Batangas': 2908000,    'Pampanga': 2609000,    'Negros Occidental': 2623000,    'Palawan': 939594,    'Davao del Sur': 2804000,    'Iloilo': 2092000,    'Cagayan': 1268000}# Map population dataphilippines_gdf['Population'] = philippines_gdf['Province'].map(pop_data)# Fill missing population with estimated averageavg_pop = 800000philippines_gdf['Population'] = philippines_gdf['Population'].fillna(avg_pop)# Calculate area in km² using accurate projected CRSphilippines_utm = philippines_gdf.to_crs('EPSG:32651')  # UTM Zone 51Nphilippines_gdf['Area_km2'] = philippines_utm.geometry.area / 1e6# Calculate population densityphilippines_gdf['Density'] = philippines_gdf['Population'] / philippines_gdf['Area_km2']# Add island group classificationdef classify_island_group(province_name):    """Classify provinces into island groups based on location"""    luzon = ['Metropolitan Manila', 'Bulacan', 'Cavite', 'Laguna', 'Rizal', 'Batangas',              'Pampanga', 'Pangasinan', 'Cagayan', 'Nueva Ecija', 'Tarlac', 'Zambales',             'Bataan', 'Aurora', 'Nueva Vizcaya', 'Quirino', 'Isabela', 'Ifugao',             'Benguet', 'La Union', 'Ilocos Norte', 'Ilocos Sur', 'Abra', 'Kalinga',             'Mountain Province', 'Apayao', 'Albay', 'Camarines Norte', 'Camarines Sur',             'Catanduanes', 'Masbate', 'Sorsogon', 'Marinduque', 'Occidental Mindoro',             'Oriental Mindoro', 'Palawan', 'Romblon']        visayas = ['Cebu', 'Bohol', 'Negros Occidental', 'Negros Oriental', 'Iloilo',                'Aklan', 'Antique', 'Capiz', 'Guimaras', 'Leyte', 'Southern Leyte',               'Samar', 'Eastern Samar', 'Northern Samar', 'Biliran', 'Siquijor']        if any(luzon_prov in province_name for luzon_prov in luzon):        return 'Luzon'    elif any(visayas_prov in province_name for visayas_prov in visayas):        return 'Visayas'    else:        return 'Mindanao'philippines_gdf['Island_Group'] = philippines_gdf['Province'].apply(classify_island_group)print("✓ Philippine provinces loaded successfully!")print(f"  Total provinces: {len(philippines_gdf)}")print(f"  CRS: {philippines_gdf.crs.name}")print(f"  Island groups: {philippines_gdf['Island_Group'].unique()}")print(f"\nSample provinces:")display(philippines_gdf[['Province', 'Region', 'Island_Group', 'Population', 'Area_km2']].head(10))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="inspecting-the-geodataframe" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-the-geodataframe">3.2 Inspecting the GeoDataFrame</h3>
<div id="cell-17" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first few rows</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"First 3 provinces:"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>display(philippines_gdf.head(<span class="dv">3</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data types</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Column data types:"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(philippines_gdf.dtypes)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Summary statistics:"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>display(philippines_gdf[[<span class="st">'Population'</span>, <span class="st">'Area_km2'</span>, <span class="st">'Density'</span>]].describe())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-18" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordinate Reference System (CRS) information</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CRS Details:"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Name: </span><span class="sc">{</span>philippines_gdf<span class="sc">.</span>crs<span class="sc">.</span>name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  EPSG Code: </span><span class="sc">{</span>philippines_gdf<span class="sc">.</span>crs<span class="sc">.</span>to_epsg()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Units: </span><span class="sc">{</span>philippines_gdf<span class="sc">.</span>crs<span class="sc">.</span>axis_info[<span class="dv">0</span>]<span class="sc">.</span>unit_name<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bounds (extent)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>bounds <span class="op">=</span> philippines_gdf.total_bounds</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Geographic Extent:"</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min Longitude: </span><span class="sc">{</span>bounds[<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="ss">°"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min Latitude:  </span><span class="sc">{</span>bounds[<span class="dv">1</span>]<span class="sc">:.2f}</span><span class="ss">°"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max Longitude: </span><span class="sc">{</span>bounds[<span class="dv">2</span>]<span class="sc">:.2f}</span><span class="ss">°"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max Latitude:  </span><span class="sc">{</span>bounds[<span class="dv">3</span>]<span class="sc">:.2f}</span><span class="ss">°"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="filtering-and-querying-vector-data" class="level3">
<h3 class="anchored" data-anchor-id="filtering-and-querying-vector-data">3.3 Filtering and Querying Vector Data</h3>
<div id="cell-20" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by attribute: Select provinces in Mindanao</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>mindanao <span class="op">=</span> philippines_gdf[philippines_gdf[<span class="st">'Island_Group'</span>] <span class="op">==</span> <span class="st">'Mindanao'</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mindanao Provinces:"</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mindanao[[<span class="st">'Province'</span>, <span class="st">'Population'</span>, <span class="st">'Area_km2'</span>]])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by condition: High-density provinces</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>high_density <span class="op">=</span> philippines_gdf[philippines_gdf[<span class="st">'Density'</span>] <span class="op">&gt;</span> <span class="dv">1000</span>]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">High Density Provinces (&gt;1000 people/km²):"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(high_density[[<span class="st">'Province'</span>, <span class="st">'Density'</span>]].sort_values(<span class="st">'Density'</span>, ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple conditions: Large AND populous</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>major_provinces <span class="op">=</span> philippines_gdf[</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    (philippines_gdf[<span class="st">'Population'</span>] <span class="op">&gt;</span> <span class="dv">1000000</span>) <span class="op">&amp;</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    (philippines_gdf[<span class="st">'Area_km2'</span>] <span class="op">&gt;</span> <span class="dv">5000</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Major Provinces (&gt;1M pop AND &gt;5000 km²):"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(major_provinces[[<span class="st">'Province'</span>, <span class="st">'Population'</span>, <span class="st">'Area_km2'</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="spatial-operations" class="level3">
<h3 class="anchored" data-anchor-id="spatial-operations">3.4 Spatial Operations</h3>
<div id="cell-22" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate centroids for all provincesphilippines_gdf['centroid'] = philippines_gdf.geometry.centroidprint("Centroid coordinates (first 10 provinces):")for idx, row in philippines_gdf.head(10).iterrows():    print(f"  {row['Province']:&lt;30} ({row['centroid'].x:.3f}, {row['centroid'].y:.3f})")# Create buffer around Metropolitan Manila (50km radius)manila = philippines_gdf[philippines_gdf['Province'] == 'Metropolitan Manila']if len(manila) &gt; 0:    # Project to UTM for accurate buffering (meters)    manila_utm = manila.to_crs('EPSG:32651')  # UTM Zone 51N    manila_buffer_utm = manila_utm.buffer(50000)  # 50km buffer in meters    manila_buffer = manila_buffer_utm.to_crs('EPSG:4326')  # Back to geographic        print(f"\n✓ Created 50km buffer around Metropolitan Manila")    print(f"  Original area: {manila['Area_km2'].values[0]:.0f} km²")        # Calculate buffer area (approximate)    buffer_area_km2 = manila_buffer_utm.area.values[0] / 1e6    print(f"  Buffer area: {buffer_area_km2:.0f} km²")        # Find provinces that intersect with Manila buffer    philippines_gdf_utm = philippines_gdf.to_crs('EPSG:32651')    intersects = philippines_gdf_utm.geometry.intersects(manila_buffer_utm.geometry.values[0])    nearby_provinces = philippines_gdf[intersects]['Province'].tolist()        print(f"\nProvinces within 50km of Manila:")    for prov in nearby_provinces:        print(f"  • {prov}")else:    print("\n⚠ Metropolitan Manila not found in dataset")    print("  Proceeding with other spatial operations...")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizing-vector-data" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-vector-data">3.5 Visualizing Vector Data</h3>
<div id="cell-24" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization with basemap - Philippine Provincesimport contextily as ctxfig, ax = plt.subplots(figsize=(14, 12))# Project to Web Mercator for basemap compatibilityphilippines_web = philippines_gdf.to_crs(epsg=3857)# Plot provincesphilippines_web.plot(    ax=ax,    color='lightblue',    edgecolor='darkblue',    linewidth=1.5,    alpha=0.5)# Add basemap (OpenStreetMap)ctx.add_basemap(    ax,    source=ctx.providers.OpenStreetMap.Mapnik,    zoom=6,    alpha=0.6)# Add province labels (for major provinces)major_provinces = philippines_web[philippines_web['Population'] &gt; 2000000]for idx, row in major_provinces.iterrows():    centroid = row['geometry'].centroid    ax.annotate(        text=row['Province'],        xy=(centroid.x, centroid.y),        ha='center',        fontsize=9,        fontweight='bold',        color='darkred',        bbox=dict(boxstyle='round,pad=0.3', facecolor='white', edgecolor='darkred', alpha=0.7)    )ax.set_title('Philippine Provinces with OpenStreetMap Basemap',              fontsize=14, fontweight='bold', pad=20)ax.set_xlabel('Longitude', fontsize=11)ax.set_ylabel('Latitude', fontsize=11)ax.set_axis_off()  # Hide axis for cleaner mapplt.tight_layout()plt.show()print("✓ Map with basemap created!")print("  Basemap source: OpenStreetMap (Mapnik)")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-25" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choropleth map - Population with basemapfig, ax = plt.subplots(figsize=(14, 12))# Project to Web Mercatorphilippines_web = philippines_gdf.to_crs(epsg=3857)# Plot choroplethphilippines_web.plot(    ax=ax,    column='Population',    cmap='YlOrRd',    edgecolor='black',    linewidth=0.8,    legend=True,    alpha=0.7,    legend_kwds={        'label': 'Population',        'orientation': 'vertical',        'shrink': 0.6,        'pad': 0.05    })# Add basemapctx.add_basemap(    ax,    source=ctx.providers.CartoDB.Positron,  # Light basemap for better contrast    zoom=6,    alpha=0.4)ax.set_title('Philippine Provinces by Population (with Basemap)',              fontsize=14, fontweight='bold', pad=20)ax.set_axis_off()plt.tight_layout()plt.show()print("✓ Choropleth map with basemap created!")print("  Basemap: CartoDB Positron (light theme)")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-26" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Categorical map - Island Groups with basemapfig, ax = plt.subplots(figsize=(14, 12))# Project to Web Mercatorphilippines_web = philippines_gdf.to_crs(epsg=3857)# Define colors for island groupsisland_colors = {'Luzon': '#2ecc71', 'Visayas': '#3498db', 'Mindanao': '#e74c3c'}philippines_web['color'] = philippines_web['Island_Group'].map(island_colors)# Plot provinces by island groupphilippines_web.plot(    ax=ax,    color=philippines_web['color'],    edgecolor='black',    linewidth=0.8,    alpha=0.6)# Add basemapctx.add_basemap(    ax,    source=ctx.providers.Stamen.TonerLite,    zoom=6,    alpha=0.5)# Create custom legendlegend_elements = [    Patch(facecolor='#2ecc71', edgecolor='black', label='Luzon'),    Patch(facecolor='#3498db', edgecolor='black', label='Visayas'),    Patch(facecolor='#e74c3c', edgecolor='black', label='Mindanao')]ax.legend(handles=legend_elements, loc='upper left', title='Island Group',          fontsize=11, title_fontsize=12, frameon=True, fancybox=True, shadow=True)ax.set_title('Philippine Island Groups with Basemap',              fontsize=14, fontweight='bold', pad=20)ax.set_axis_off()plt.tight_layout()plt.show()print("✓ Island group map with basemap created!")print("  Basemap: Stamen Toner Lite")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exercise-1-select-and-plot-your-home-province" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-select-and-plot-your-home-province">📝 Exercise 1: Select and Plot Your Home Province</h3>
<p><strong>Task:</strong> 1. Select a province from the GeoDataFrame 2. Calculate its population density 3. Create a focused map showing only that province 4. Add informative labels</p>
<p><strong>Hint:</strong> Use boolean filtering: <code>gdf[gdf['Province'] == 'YourProvince']</code></p>
<div id="cell-28" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Example solution (uncomment and modify):</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># my_province = philippines_gdf[philippines_gdf['Province'] == 'Palawan']</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># density = my_province['Population'].values[0] / my_province['Area_km2'].values[0]</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(10, 8))</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># my_province.plot(ax=ax, color='green', edgecolor='black', linewidth=2, alpha=0.6)</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_title(f"{my_province['Province'].values[0]} Province\nDensity: {density:.1f} people/km²",</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#              fontsize=14, fontweight='bold')</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<details>
<summary>
<b>Click to see solution</b>
</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select Palawan</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>my_province <span class="op">=</span> philippines_gdf[philippines_gdf[<span class="st">'Province'</span>] <span class="op">==</span> <span class="st">'Palawan'</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate density</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>pop <span class="op">=</span> my_province[<span class="st">'Population'</span>].values[<span class="dv">0</span>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>area <span class="op">=</span> my_province[<span class="st">'Area_km2'</span>].values[<span class="dv">0</span>]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>density <span class="op">=</span> pop <span class="op">/</span> area</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>my_province.plot(</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    color<span class="op">=</span><span class="st">'forestgreen'</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    edgecolor<span class="op">=</span><span class="st">'darkgreen'</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.6</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Add info text</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>info_text <span class="op">=</span> <span class="ss">f"Population: </span><span class="sc">{</span>pop<span class="sc">:,}</span><span class="ch">\n</span><span class="ss">Area: </span><span class="sc">{</span>area<span class="sc">:.0f}</span><span class="ss"> km²</span><span class="ch">\n</span><span class="ss">Density: </span><span class="sc">{</span>density<span class="sc">:.1f}</span><span class="ss"> people/km²"</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">0.02</span>, <span class="fl">0.98</span>, info_text,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        verticalalignment<span class="op">=</span><span class="st">'top'</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.8</span>))</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="ss">f"</span><span class="sc">{</span>my_province[<span class="st">'Province'</span>]<span class="sc">.</span>values[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> Province"</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Longitude (°E)'</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Latitude (°N)'</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>ax.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<p>—## Part 4: Rasterio for Raster Data<strong>Rasterio</strong> is the go-to library for working with raster/gridded data like satellite imagery.### Why Rasterio?- ✓ Read/write GeoTIFF and other raster formats- ✓ NumPy integration for fast array operations- ✓ Handles multi-band imagery (Sentinel-2 has 13 bands!)- ✓ Georeferencing and coordinate transformations- ✓ Masking, clipping, resampling, reprojection### 4.1 Loading Real Sentinel-2 Data from Cloud StorageWe’ll use <strong>Microsoft Planetary Computer</strong> or <strong>Element84 Earth Search</strong> to access real Sentinel-2 imagery over Palawan.<strong>Why cloud access?</strong>- No need to manually download large files- Access to entire Sentinel-2 archive- Data is already processed to L2A (bottom-of-atmosphere)- Cloud-optimized GeoTIFF format for efficient streaming</p>
<div id="cell-31" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pystac_client <span class="im">import</span> Clientimport planetary_computerprint(<span class="st">"Searching for Sentinel-2 imagery over Palawan, Philippines..."</span>)<span class="bu">print</span>(<span class="st">"This may take a moment to query the catalog and access cloud data...</span><span class="ch">\n</span><span class="st">"</span>)<span class="co"># Define area of interest - Palawan bounding boxpalawan_bbox = [118.5, 8.5, 119.5, 11.5]  # [min_lon, min_lat, max_lon, max_lat]# Open Microsoft Planetary Computer STAC catalogcatalog = Client.open(    "https://planetarycomputer.microsoft.com/api/stac/v1",    modifier=planetary_computer.sign_inplace  # Handles authentication)# Search for Sentinel-2 L2A imagerysearch = catalog.search(    collections=["sentinel-2-l2a"],    bbox=palawan_bbox,    datetime="2024-01-01/2024-12-31",  # Full year 2024    query={"eo:cloud_cover": {"lt": 10}}  # Less than 10% cloud cover)# Get itemsitems = list(search.items())print(f"✓ Found {len(items)} Sentinel-2 scenes with &lt;10% cloud cover")if len(items) == 0:    print("⚠ No suitable imagery found. Expanding search criteria...")    # Fallback: relax cloud cover constraint    search = catalog.search(        collections=["sentinel-2-l2a"],        bbox=palawan_bbox,        datetime="2024-01-01/2024-12-31",        query={"eo:cloud_cover": {"lt": 30}}  # Less than 30% cloud cover    )    items = list(search.items())    print(f"✓ Found {len(items)} scenes with &lt;30% cloud cover")# Select the least cloudy sceneitems_sorted = sorted(items, key=lambda x: x.properties.get("eo:cloud_cover", 100))selected_item = items_sorted[0]# Print scene informationprint(f"\n{'='*70}")print("SELECTED SENTINEL-2 SCENE")print(f"{'='*70}")print(f"  Scene ID: {selected_item.id}")print(f"  Date: {selected_item.datetime.strftime('%Y-%m-%d %H:%M:%S UTC')}")print(f"  Cloud Cover: {selected_item.properties.get('eo:cloud_cover', 'N/A'):.2f}%")print(f"  Platform: {selected_item.properties.get('platform', 'Sentinel-2')}")print(f"  Processing Level: L2A (Bottom-of-Atmosphere)")# Print available bandsprint(f"\nAvailable Bands:")bands_needed = ['B02', 'B03', 'B04', 'B08']for band in bands_needed:    if band in selected_item.assets:        print(f"  • {band}: {selected_item.assets[band].title}")print(f"{'='*70}\n")# Store the selected item for next cellssentinel_item = selected_item</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="writing-real-sentinel-2-subset-to-local-filelets-save-this-subset-as-a-multi-band-geotiff-for-later-use." class="level3">
<h3 class="anchored" data-anchor-id="writing-real-sentinel-2-subset-to-local-filelets-save-this-subset-as-a-multi-band-geotiff-for-later-use.">4.2 Writing Real Sentinel-2 Subset to Local FileLet’s save this subset as a multi-band GeoTIFF for later use.</h3>
<div id="cell-33" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.windows <span class="im">import</span> Windowprint(<span class="st">"Loading Sentinel-2 bands from cloud storage..."</span>)<span class="bu">print</span>(<span class="st">"Reading subset of data for performance (1000x1000 pixels)</span><span class="ch">\n</span><span class="st">"</span>)<span class="co"># Get signed URLs for the bands we needband_blue_url = sentinel_item.assets["B02"].href  # Blue (10m)band_green_url = sentinel_item.assets["B03"].href  # Green (10m)band_red_url = sentinel_item.assets["B04"].href  # Red (10m)band_nir_url = sentinel_item.assets["B08"].href  # NIR (10m)# Define window to read (subset for performance)# We'll read a 1000x1000 pixel window from the center# This represents approximately 10km x 10km at 10m resolution# Open one band to get dimensionswith rasterio.open(band_red_url) as src:    full_height, full_width = src.height, src.width        # Calculate center window    window_size = min(1000, full_width, full_height)  # 1000x1000 or smaller if image is smaller    col_off = (full_width - window_size) // 2    row_off = (full_height - window_size) // 2        window = Window(col_off, row_off, window_size, window_size)        print(f"Full scene dimensions: {full_width} x {full_height} pixels")    print(f"Reading subset: {window_size} x {window_size} pixels")    print(f"Window location: row {row_off}, col {col_off}\n")        # Store metadata for later    transform = src.window_transform(window)    crs = src.crs    bounds = src.window_bounds(window)# Load each band with the same windowprint("Loading bands...")with rasterio.open(band_blue_url) as src:    band_blue = src.read(1, window=window)print("  ✓ Blue (B02) loaded")with rasterio.open(band_green_url) as src:    band_green = src.read(1, window=window)print("  ✓ Green (B03) loaded")with rasterio.open(band_red_url) as src:    band_red = src.read(1, window=window)print("  ✓ Red (B04) loaded")with rasterio.open(band_nir_url) as src:    band_nir = src.read(1, window=window)print("  ✓ NIR (B08) loaded")# Store for convenienceblue = band_bluegreen = band_greenred = band_rednir = band_nir# Store dimensionsheight, width = red.shapeprint(f"\n✓ Real Sentinel-2 bands loaded successfully!")print(f"  Dimensions: {width} x {height} pixels")print(f"  Bands: Blue (B02), Green (B03), Red (B04), NIR (B08)")print(f"  Resolution: 10m per pixel")print(f"  Coverage: ~{(width*10)/1000:.1f}km x {(height*10)/1000:.1f}km")print(f"  Location: Palawan, Philippines")print(f"  CRS: {crs}")print(f"  Bounds: {bounds}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-34" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save real Sentinel-2 subset as multi-band GeoTIFFraster_path = '/tmp/palawan_sentinel2_real.tif'# Create raster profileprofile = {    'driver': 'GTiff',    'height': height,    'width': width,    'count': 4,  # 4 bands    'dtype': blue.dtype,    'crs': crs,    'transform': transform,    'compress': 'lzw',    'nodata': 0}# Write all bands to filewith rasterio.open(raster_path, 'w', **profile) as dst:    dst.write(blue, 1)    dst.write(green, 2)    dst.write(red, 3)    dst.write(nir, 4)        # Set band descriptions    dst.set_band_description(1, 'Blue (B02)')    dst.set_band_description(2, 'Green (B03)')    dst.set_band_description(3, 'Red (B04)')    dst.set_band_description(4, 'NIR (B08)')print(f"✓ Real Sentinel-2 subset saved: {raster_path}")print(f"  File size: {os.path.getsize(raster_path) / 1024 / 1024:.2f} MB")print(f"  Bands: 4 (Blue, Green, Red, NIR)")print(f"  This file demonstrates saving cloud-streamed data locally")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="saving-real-data-subset-as-local-geotifffor-convenience-and-to-demonstrate-file-io-operations-lets-save-this-real-sentinel-2-subset-as-a-local-geotiff-file." class="level3">
<h3 class="anchored" data-anchor-id="saving-real-data-subset-as-local-geotifffor-convenience-and-to-demonstrate-file-io-operations-lets-save-this-real-sentinel-2-subset-as-a-local-geotiff-file.">4.3 Saving Real Data Subset as Local GeoTIFFFor convenience and to demonstrate file I/O operations, let’s save this real Sentinel-2 subset as a local GeoTIFF file.</h3>
<div id="cell-36" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">### 4.4 Opening and Inspecting Raster MetadataNow let's reopen the saved file and inspect its metadata, demonstrating best practices for raster file handling.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-37" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We already have the band data loaded from cloud storage# Let's verify the arrays we're working withprint("Band Arrays (loaded from Microsoft Planetary Computer):")print(f"  Blue (B02):  shape={blue.shape}, dtype={blue.dtype}")print(f"  Green (B03): shape={green.shape}, dtype={green.dtype}")print(f"  Red (B04):   shape={red.shape}, dtype={red.dtype}")print(f"  NIR (B08):   shape={nir.shape}, dtype={nir.dtype}")print(f"\nData characteristics:")print(f"  Dimensions: {height} rows × {width} columns")print(f"  Total pixels: {height * width:,}")print(f"  Coverage area: ~{(width*10)/1000:.1f}km × {(height*10)/1000:.1f}km")print(f"  Pixel resolution: 10m")# Note: We can also read these from the saved GeoTIFF file if needed# with rasterio.open(raster_path) as src:#     blue_from_file = src.read(1)#     green_from_file = src.read(2)#     etc.</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reading-raster-data-as-numpy-arrays" class="level3">
<h3 class="anchored" data-anchor-id="reading-raster-data-as-numpy-arrays">4.5 Reading Raster Data as NumPy Arrays</h3>
<div id="cell-39" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics for each band (using real Sentinel-2 data)bands_dict = {    'Blue (B02)': blue,    'Green (B03)': green,    'Red (B04)': red,    'NIR (B08)': nir}print("="*80)print("BAND STATISTICS - REAL SENTINEL-2 DATA")print("(Surface Reflectance, 0-10000 scale)")print("="*80)print(f"{'Band':&lt;15} {'Min':&gt;8} {'Max':&gt;8} {'Mean':&gt;10} {'Median':&gt;10} {'Std Dev':&gt;10}")print("-"*80)for band_name, band_data in bands_dict.items():    print(f"{band_name:&lt;15} "          f"{band_data.min():&gt;8} "          f"{band_data.max():&gt;8} "          f"{band_data.mean():&gt;10.1f} "          f"{np.median(band_data):&gt;10.1f} "          f"{band_data.std():&gt;10.1f}")print("="*80)# Calculate percentiles for Red bandprint("\nPercentile Analysis (Red band):")percentiles = [5, 25, 50, 75, 95]values = np.percentile(red, percentiles)for p, v in zip(percentiles, values):    print(f"  {p}th percentile: {v:.0f}")print("\n✓ These are real spectral values from Palawan, Philippines!")print("  Values reflect actual surface conditions on the acquisition date")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="calculating-band-statisticslets-examine-the-real-spectral-signatures-from-palawan" class="level3">
<h3 class="anchored" data-anchor-id="calculating-band-statisticslets-examine-the-real-spectral-signatures-from-palawan">4.6 Calculating Band StatisticsLet’s examine the real spectral signatures from Palawan:</h3>
<div id="cell-41" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize NIR band (grayscale) - using real Sentinel-2 datafig, ax = plt.subplots(figsize=(12, 10))# Convert to reflectance (0-1 scale)nir_refl = nir / 10000.0im = ax.imshow(nir_refl, cmap='gray', vmin=0, vmax=0.6)cbar = plt.colorbar(im, ax=ax, shrink=0.8)cbar.set_label('NIR Reflectance', fontsize=11)ax.set_title('Real Sentinel-2 Near-Infrared Band (B08) - Palawan',              fontsize=14, fontweight='bold', pad=15)ax.set_xlabel('Column (pixel)', fontsize=11)ax.set_ylabel('Row (pixel)', fontsize=11)# Add explanation textexplanation = (    "NIR (Near-Infrared) - Real Data:\n"    "• Bright = High reflectance (vegetation)\n"    "• Dark = Low reflectance (water, bare soil)\n"    "• Pattern shows actual land cover")ax.text(0.02, 0.98, explanation,        transform=ax.transAxes,        fontsize=9,        verticalalignment='top',        bbox=dict(boxstyle='round', facecolor='white', alpha=0.9))plt.tight_layout()plt.show()print("✓ This is real NIR data from Microsoft Planetary Computer!")print("  Bright areas indicate healthy vegetation over Palawan")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizing-single-bands" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-single-bands">4.7 Visualizing Single Bands</h3>
<div id="cell-43" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate statistics for each band</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>bands_dict <span class="op">=</span> {</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Blue (B2)'</span>: blue,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Green (B3)'</span>: green,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Red (B4)'</span>: red,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'NIR (B8)'</span>: nir</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BAND STATISTICS (Sentinel-2 Reflectance, 0-10000 scale)"</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Band'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Min'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Max'</span><span class="sc">:&gt;8}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Mean'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Median'</span><span class="sc">:&gt;10}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'Std Dev'</span><span class="sc">:&gt;10}</span><span class="ss">"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> band_name, band_data <span class="kw">in</span> bands_dict.items():</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>band_name<span class="sc">:&lt;15}</span><span class="ss"> "</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>band_data<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:&gt;8}</span><span class="ss"> "</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>band_data<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:&gt;8}</span><span class="ss"> "</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>band_data<span class="sc">.</span>mean()<span class="sc">:&gt;10.1f}</span><span class="ss"> "</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>np<span class="sc">.</span>median(band_data)<span class="sc">:&gt;10.1f}</span><span class="ss"> "</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>          <span class="ss">f"</span><span class="sc">{</span>band_data<span class="sc">.</span>std()<span class="sc">:&gt;10.1f}</span><span class="ss">"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentiles</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Percentile Analysis (Red band):"</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>percentiles <span class="op">=</span> [<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">95</span>]</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.percentile(red, percentiles)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p, v <span class="kw">in</span> <span class="bu">zip</span>(percentiles, values):</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">th percentile: </span><span class="sc">{</span>v<span class="sc">:.0f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizing-single-bands-1" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-single-bands-1">4.6 Visualizing Single Bands</h3>
<div id="cell-45" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">### 4.8 Creating RGB True Color Composite</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-46" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize all 4 bands in subplots</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>axes <span class="op">=</span> axes.flatten()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>bands_to_plot <span class="op">=</span> [</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    (blue, <span class="st">'Blue (B2)'</span>, <span class="st">'Blues'</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    (green, <span class="st">'Green (B3)'</span>, <span class="st">'Greens'</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    (red, <span class="st">'Red (B4)'</span>, <span class="st">'Reds'</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    (nir, <span class="st">'NIR (B8)'</span>, <span class="st">'gray'</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, (band, title, cmap) <span class="kw">in</span> <span class="bu">enumerate</span>(bands_to_plot):</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    im <span class="op">=</span> axes[idx].imshow(band <span class="op">/</span> <span class="fl">10000.0</span>, cmap<span class="op">=</span>cmap, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_title(title, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_xlabel(<span class="st">'Column'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    axes[idx].set_ylabel(<span class="st">'Row'</span>, fontsize<span class="op">=</span><span class="dv">9</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(im, ax<span class="op">=</span>axes[idx], fraction<span class="op">=</span><span class="fl">0.046</span>, pad<span class="op">=</span><span class="fl">0.04</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">'Sentinel-2 Multispectral Bands - Palawan'</span>, </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">15</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, y<span class="op">=</span><span class="fl">0.995</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="false-color-compositesfalse-color-composites-use-non-visible-bands-to-highlight-specific-features." class="level3">
<h3 class="anchored" data-anchor-id="false-color-compositesfalse-color-composites-use-non-visible-bands-to-highlight-specific-features.">4.9 False Color CompositesFalse color composites use <strong>non-visible</strong> bands to highlight specific features.</h3>
<div id="cell-48" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate NDVI using real Sentinel-2 datandvi = calculate_ndvi(nir, red)# Print statisticsprint("="*60)print("NDVI STATISTICS - REAL SENTINEL-2 DATA")print("="*60)print(f"Minimum:   {ndvi.min():.4f}")print(f"Maximum:   {ndvi.max():.4f}")print(f"Mean:      {ndvi.mean():.4f}")print(f"Median:    {np.median(ndvi):.4f}")print(f"Std Dev:   {ndvi.std():.4f}")print("="*60)# Calculate area by vegetation class# Note: For real data we need to calculate pixel area from transformres_x_meters = abs(transform[0])  # meters per pixelres_y_meters = abs(transform[4])  # meters per pixelpixel_area_km2 = (res_x_meters * res_y_meters) / 1e6  # Convert to km²water_pixels = np.sum(ndvi &lt; 0)sparse_pixels = np.sum((ndvi &gt;= 0) &amp; (ndvi &lt; 0.2))moderate_pixels = np.sum((ndvi &gt;= 0.2) &amp; (ndvi &lt; 0.5))dense_pixels = np.sum((ndvi &gt;= 0.5) &amp; (ndvi &lt; 0.8))very_dense_pixels = np.sum(ndvi &gt;= 0.8)print("\nVegetation Cover Analysis (Real Data from Palawan):")print(f"  Water/Bare (&lt;0):       {water_pixels:&gt;6} pixels ({water_pixels * pixel_area_km2:.1f} km²)")print(f"  Sparse (0-0.2):        {sparse_pixels:&gt;6} pixels ({sparse_pixels * pixel_area_km2:.1f} km²)")print(f"  Moderate (0.2-0.5):    {moderate_pixels:&gt;6} pixels ({moderate_pixels * pixel_area_km2:.1f} km²)")print(f"  Dense (0.5-0.8):       {dense_pixels:&gt;6} pixels ({dense_pixels * pixel_area_km2:.1f} km²)")print(f"  Very Dense (&gt;0.8):     {very_dense_pixels:&gt;6} pixels ({very_dense_pixels * pixel_area_km2:.1f} km²)")# Calculate vegetation percentageveg_pixels = moderate_pixels + dense_pixels + very_dense_pixelstotal_pixels = width * heightveg_percentage = (veg_pixels / total_pixels) * 100print(f"\n✓ Overall Vegetation Coverage: {veg_percentage:.1f}%")print(f"  Based on real Sentinel-2 imagery from Microsoft Planetary Computer")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="calculating-ndvi-normalized-difference-vegetation-indexndvi-is-the-most-important-vegetation-index-in-remote-sensing.ndvi-fracnir---rednir-redinterpretation---1-to-0-water-bare-soil-snow--0-to-0.2-sparse-vegetation-rock--0.2-to-0.5-shrubs-grassland--0.5-to-0.8-dense-vegetation-healthy-crops--0.8-to-1-very-dense-vegetation-tropical-forest" class="level3">
<h3 class="anchored" data-anchor-id="calculating-ndvi-normalized-difference-vegetation-indexndvi-is-the-most-important-vegetation-index-in-remote-sensing.ndvi-fracnir---rednir-redinterpretation---1-to-0-water-bare-soil-snow--0-to-0.2-sparse-vegetation-rock--0.2-to-0.5-shrubs-grassland--0.5-to-0.8-dense-vegetation-healthy-crops--0.8-to-1-very-dense-vegetation-tropical-forest">4.10 Calculating NDVI (Normalized Difference Vegetation Index)<strong>NDVI is THE most important vegetation index in remote sensing.</strong><span class="math display">\[NDVI = \frac{NIR - Red}{NIR + Red}\]</span><strong>Interpretation:</strong>- <strong>-1 to 0</strong>: Water, bare soil, snow- <strong>0 to 0.2</strong>: Sparse vegetation, rock- <strong>0.2 to 0.5</strong>: Shrubs, grassland- <strong>0.5 to 0.8</strong>: Dense vegetation, healthy crops- <strong>0.8 to 1</strong>: Very dense vegetation (tropical forest)</h3>
<div id="cell-50" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># False Color Composite: NIR-Red-Green (Vegetation appears bright red)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>false_color_nrg <span class="op">=</span> np.dstack([nir, red, green]) <span class="op">/</span> <span class="fl">10000.0</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply stretch</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>p2, p98 <span class="op">=</span> np.percentile(false_color_nrg, (<span class="dv">2</span>, <span class="dv">98</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>false_color_nrg_stretched <span class="op">=</span> np.clip((false_color_nrg <span class="op">-</span> p2) <span class="op">/</span> (p98 <span class="op">-</span> p2), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>ax.imshow(false_color_nrg_stretched)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'False Color Composite (NIR-R-G) - Vegetation Analysis'</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Column'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Row'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>legend_text <span class="op">=</span> (</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"False Color Interpretation:</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"• Bright Red = Dense vegetation</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"• Pink/Light Red = Moderate vegetation</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"• Dark Blue/Black = Water</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"• Gray/White = Urban, bare soil</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Band Assignment:</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"R = NIR (B8), G = Red (B4), B = Green (B3)"</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">1.02</span>, <span class="fl">0.5</span>, legend_text,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        verticalalignment<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'lightgray'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>))</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Why False Color?"</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  • Vegetation reflects STRONGLY in NIR (invisible to human eye)"</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  • By mapping NIR to Red channel, vegetation appears bright red"</span>)</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  • Makes vegetation identification much easier!"</span>)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  • Critical for agriculture, forestry, and NRM applications"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="calculating-ndvi-normalized-difference-vegetation-index" class="level3">
<h3 class="anchored" data-anchor-id="calculating-ndvi-normalized-difference-vegetation-index">4.9 Calculating NDVI (Normalized Difference Vegetation Index)</h3>
<p><strong>NDVI is THE most important vegetation index in remote sensing.</strong></p>
<p><span class="math display">\[NDVI = \frac{NIR - Red}{NIR + Red}\]</span></p>
<p><strong>Interpretation:</strong> - <strong>-1 to 0</strong>: Water, bare soil, snow - <strong>0 to 0.2</strong>: Sparse vegetation, rock - <strong>0.2 to 0.5</strong>: Shrubs, grassland - <strong>0.5 to 0.8</strong>: Dense vegetation, healthy crops - <strong>0.8 to 1</strong>: Very dense vegetation (tropical forest)</p>
<div id="cell-52" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">### 4.11 NDVI Histogram and Distribution Analysis</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-53" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize NDVI</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use diverging colormap (red-yellow-green)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.imshow(ndvi, cmap<span class="op">=</span><span class="st">'RdYlGn'</span>, vmin<span class="op">=-</span><span class="fl">0.2</span>, vmax<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>cbar <span class="op">=</span> plt.colorbar(im, ax<span class="op">=</span>ax, shrink<span class="op">=</span><span class="fl">0.8</span>, extend<span class="op">=</span><span class="st">'both'</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>cbar.set_label(<span class="st">'NDVI'</span>, fontsize<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add horizontal lines for class boundaries</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>cbar.ax.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>cbar.ax.axhline(y<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'orange'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>cbar.ax.axhline(y<span class="op">=</span><span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'yellow'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>cbar.ax.axhline(y<span class="op">=</span><span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'darkgreen'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'NDVI - Normalized Difference Vegetation Index'</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>, pad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'Column (pixel)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'Row (pixel)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Add interpretation legend</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>legend_text <span class="op">=</span> (</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NDVI Interpretation:</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt; 0 (Red/Brown)</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  Water, bare soil</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0 - 0.2 (Orange/Yellow)</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  Sparse vegetation</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0.2 - 0.5 (Light Green)</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  Moderate vegetation</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"0.5 - 0.8 (Green)</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  Dense vegetation</span><span class="ch">\n\n</span><span class="st">"</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="st">"&gt; 0.8 (Dark Green)</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"  Very dense vegetation"</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>ax.text(<span class="fl">1.15</span>, <span class="fl">0.5</span>, legend_text,</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>        transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>        fontsize<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>        verticalalignment<span class="op">=</span><span class="st">'center'</span>,</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>        bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">'round'</span>, facecolor<span class="op">=</span><span class="st">'white'</span>, alpha<span class="op">=</span><span class="fl">0.9</span>),</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>        family<span class="op">=</span><span class="st">'monospace'</span>)</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="ndvi-histogram-and-distribution-analysis" class="level3">
<h3 class="anchored" data-anchor-id="ndvi-histogram-and-distribution-analysis">4.10 NDVI Histogram and Distribution Analysis</h3>
<div id="cell-55" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive histogram</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">6</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax1.hist(ndvi.flatten(), bins<span class="op">=</span><span class="dv">100</span>, color<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, edgecolor<span class="op">=</span><span class="st">'darkgreen'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ax1.axvline(ndvi.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Mean: </span><span class="sc">{</span>ndvi<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>ax1.axvline(np.median(ndvi), color<span class="op">=</span><span class="st">'blue'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f'Median: </span><span class="sc">{</span>np<span class="sc">.</span>median(ndvi)<span class="sc">:.3f}</span><span class="ss">'</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add class boundary lines</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="dv">0</span>, color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="fl">0.2</span>, color<span class="op">=</span><span class="st">'orange'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="fl">0.5</span>, color<span class="op">=</span><span class="st">'yellow'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>ax1.axvline(<span class="fl">0.8</span>, color<span class="op">=</span><span class="st">'darkgreen'</span>, linestyle<span class="op">=</span><span class="st">':'</span>, linewidth<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'NDVI Value'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Frequency (pixel count)'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'NDVI Distribution'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>box_data <span class="op">=</span> [ndvi[ndvi <span class="op">&lt;</span> <span class="dv">0</span>].flatten(),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            ndvi[(ndvi <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="op">&amp;</span> (ndvi <span class="op">&lt;</span> <span class="fl">0.2</span>)].flatten(),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>            ndvi[(ndvi <span class="op">&gt;=</span> <span class="fl">0.2</span>) <span class="op">&amp;</span> (ndvi <span class="op">&lt;</span> <span class="fl">0.5</span>)].flatten(),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>            ndvi[(ndvi <span class="op">&gt;=</span> <span class="fl">0.5</span>) <span class="op">&amp;</span> (ndvi <span class="op">&lt;</span> <span class="fl">0.8</span>)].flatten(),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>            ndvi[ndvi <span class="op">&gt;=</span> <span class="fl">0.8</span>].flatten()]</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>bp <span class="op">=</span> ax2.boxplot(box_data, </span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>                 labels<span class="op">=</span>[<span class="st">'Water</span><span class="ch">\n</span><span class="st">(&lt;0)'</span>, <span class="st">'Sparse</span><span class="ch">\n</span><span class="st">(0-0.2)'</span>, <span class="st">'Moderate</span><span class="ch">\n</span><span class="st">(0.2-0.5)'</span>, </span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'Dense</span><span class="ch">\n</span><span class="st">(0.5-0.8)'</span>, <span class="st">'Very Dense</span><span class="ch">\n</span><span class="st">(&gt;0.8)'</span>],</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>                 patch_artist<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Color boxes</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'brown'</span>, <span class="st">'orange'</span>, <span class="st">'yellow'</span>, <span class="st">'green'</span>, <span class="st">'darkgreen'</span>]</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> patch, color <span class="kw">in</span> <span class="bu">zip</span>(bp[<span class="st">'boxes'</span>], colors):</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    patch.set_facecolor(color)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    patch.set_alpha(<span class="fl">0.6</span>)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'NDVI Value'</span>, fontsize<span class="op">=</span><span class="dv">11</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'NDVI by Vegetation Class'</span>, fontsize<span class="op">=</span><span class="dv">13</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>, axis<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="exercise-2-calculate-and-visualize-ndwi-water-index" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-calculate-and-visualize-ndwi-water-index">📝 Exercise 2: Calculate and Visualize NDWI (Water Index)</h3>
<p><strong>NDWI (Normalized Difference Water Index)</strong> is used to detect water bodies.</p>
<p><span class="math display">\[NDWI = \frac{Green - NIR}{Green + NIR}\]</span></p>
<p><strong>Task:</strong> 1. Write a function to calculate NDWI 2. Calculate NDWI from the Green and NIR bands 3. Create a visualization showing water bodies 4. Calculate statistics (min, max, mean)</p>
<p><strong>Hints:</strong> - NDWI &gt; 0.3: Water - NDWI 0 to 0.3: Wetlands/moist soil - NDWI &lt; 0: Dry land/vegetation</p>
<div id="cell-57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># YOUR CODE HERE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Write NDWI function</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># def calculate_ndwi(green, nir):</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     Calculate Normalized Difference Water Index.</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     NDWI = (Green - NIR) / (Green + NIR)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     """</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     # Your code here</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     pass</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate NDWI</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ndwi = calculate_ndwi(green, nir)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Visualize</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(12, 10))</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># im = ax.imshow(ndwi, cmap='Blues', vmin=-0.5, vmax=0.5)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # Add colorbar, title, labels</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Calculate statistics</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"NDWI Statistics:")</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># print(f"  Min: {ndwi.min():.3f}")</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># # ... etc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-58" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.mask <span class="im">import</span> mask <span class="im">as</span> rasterio_mask<span class="co"># Select Palawan provincepalawan_gdf = philippines_gdf[philippines_gdf['Province'] == 'Palawan']# Get geometry in format rasterio expects (GeoJSON-like)palawan_geom = [palawan_gdf.geometry.values[0].__geo_interface__]# Open the saved raster file and clip to Palawan boundarywith rasterio.open(raster_path) as src:    # Clip raster to Palawan boundary    out_image, out_transform = rasterio_mask(src, palawan_geom, crop=True, filled=True)    out_meta = src.meta.copy()# Update metadataout_meta.update({    "height": out_image.shape[1],    "width": out_image.shape[2],    "transform": out_transform})print("✓ Real Sentinel-2 data clipped to Palawan boundary!")print(f"  Original size: {height} x {width} pixels")print(f"  Clipped size:  {out_image.shape[1]} x {out_image.shape[2]} pixels")print(f"  Reduction:     {(1 - (out_image.shape[1] * out_image.shape[2]) / (height * width)) * 100:.1f}%")# Extract clipped bands (remember: 0-indexed, so band 1=index 0)clipped_blue = out_image[0, :, :]clipped_green = out_image[1, :, :]clipped_red = out_image[2, :, :]clipped_nir = out_image[3, :, :]# Calculate NDVI for clipped area using real dataclipped_ndvi = calculate_ndvi(clipped_nir, clipped_red)print(f"\nClipped NDVI statistics (real Palawan vegetation):")print(f"  Mean: {clipped_ndvi.mean():.3f}")print(f"  Min:  {clipped_ndvi.min():.3f}")print(f"  Max:  {clipped_ndvi.max():.3f}")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="part-5-combined-operations---vector-and-raster-integration" class="level2">
<h2 class="anchored" data-anchor-id="part-5-combined-operations---vector-and-raster-integration">Part 5: Combined Operations - Vector and Raster Integration</h2>
<p><strong>The real power of geospatial analysis comes from combining vector and raster data.</strong></p>
<p>Common workflows: - Clip raster to administrative boundaries - Extract statistics per province/region - Overlay boundaries on satellite imagery - Sample raster values at point locations</p>
<section id="clipping-raster-to-vector-boundary" class="level3">
<h3 class="anchored" data-anchor-id="clipping-raster-to-vector-boundary">5.1 Clipping Raster to Vector Boundary</h3>
<div id="cell-60" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.mask <span class="im">import</span> mask <span class="im">as</span> rasterio_mask</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select Palawan province</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>palawan_gdf <span class="op">=</span> philippines_gdf[philippines_gdf[<span class="st">'Province'</span>] <span class="op">==</span> <span class="st">'Palawan'</span>]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get geometry in format rasterio expects (GeoJSON-like)</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>palawan_geom <span class="op">=</span> [palawan_gdf.geometry.values[<span class="dv">0</span>].__geo_interface__]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Open raster and clip</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> rasterio.<span class="bu">open</span>(raster_path) <span class="im">as</span> src:</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clip raster to Palawan boundary</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    out_image, out_transform <span class="op">=</span> rasterio_mask(src, palawan_geom, crop<span class="op">=</span><span class="va">True</span>, filled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    out_meta <span class="op">=</span> src.meta.copy()</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Update metadata</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>out_meta.update({</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"height"</span>: out_image.shape[<span class="dv">1</span>],</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"width"</span>: out_image.shape[<span class="dv">2</span>],</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"transform"</span>: out_transform</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Raster clipped to Palawan boundary!"</span>)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Original size: </span><span class="sc">{</span>height<span class="sc">}</span><span class="ss"> x </span><span class="sc">{</span>width<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Clipped size:  </span><span class="sc">{</span>out_image<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> x </span><span class="sc">{</span>out_image<span class="sc">.</span>shape[<span class="dv">2</span>]<span class="sc">}</span><span class="ss"> pixels"</span>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Reduction:     </span><span class="sc">{</span>(<span class="dv">1</span> <span class="op">-</span> (out_image.shape[<span class="dv">1</span>] <span class="op">*</span> out_image.shape[<span class="dv">2</span>]) <span class="op">/</span> (height <span class="op">*</span> width)) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract clipped bands</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>clipped_red <span class="op">=</span> out_image[<span class="dv">2</span>, :, :]</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>clipped_nir <span class="op">=</span> out_image[<span class="dv">3</span>, :, :]</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate NDVI for clipped area</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>clipped_ndvi <span class="op">=</span> calculate_ndvi(clipped_nir, clipped_red)</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Clipped NDVI statistics:"</span>)</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean: </span><span class="sc">{</span>clipped_ndvi<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min:  </span><span class="sc">{</span>clipped_ndvi<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max:  </span><span class="sc">{</span>clipped_ndvi<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.3f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-61" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create combined visualization using real Sentinel-2 datafig, ax = plt.subplots(figsize=(14, 12))# Get bounds from the transform and dimensionsminx = bounds[0]maxx = bounds[2]miny = bounds[1]maxy = bounds[3]extent = [minx, maxx, miny, maxy]# Display NDVI from real data as backgroundim = ax.imshow(ndvi, cmap='RdYlGn', vmin=-0.2, vmax=0.9,               extent=extent, origin='upper')# Overlay province boundariesphilippines_gdf.boundary.plot(ax=ax, edgecolor='blue', linewidth=2, label='Province Boundaries')# Highlight Palawanpalawan_gdf.boundary.plot(ax=ax, edgecolor='red', linewidth=3, label='Palawan (highlighted)')# Add colorbarcbar = plt.colorbar(im, ax=ax, shrink=0.7, pad=0.02)cbar.set_label('NDVI (Real Sentinel-2 Data)', fontsize=12)ax.set_xlabel('Longitude (°E)', fontsize=11)ax.set_ylabel('Latitude (°N)', fontsize=11)ax.set_title('Real NDVI Data with Province Boundaries Overlay - Palawan',             fontsize=14, fontweight='bold', pad=20)ax.legend(loc='upper right', fontsize=10)ax.grid(True, alpha=0.3, linestyle='--')plt.tight_layout()plt.show()print("✓ Combined vector-raster visualization created!")print("  Using real Sentinel-2 NDVI from Microsoft Planetary Computer")print("  This demonstrates spatial integration of real satellite data with vector boundaries")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="overlay-vector-boundaries-on-raster" class="level3">
<h3 class="anchored" data-anchor-id="overlay-vector-boundaries-on-raster">5.2 Overlay Vector Boundaries on Raster</h3>
<div id="cell-63" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.features <span class="im">import</span> rasterizefrom rasterio.transform <span class="im">import</span> rowcol<span class="co"># Simple approach: Sample NDVI at province centroids using real Sentinel-2 data# For full zonal statistics, use rasterstats library (not installed by default)def sample_raster_at_point(lon, lat, raster_array, transform_obj):    """    Sample raster value at given coordinates.    """    from rasterio.transform import rowcol        # Convert geographic to pixel coordinates    row, col = rowcol(transform_obj, lon, lat)        # Check bounds    if 0 &lt;= row &lt; raster_array.shape[0] and 0 &lt;= col &lt; raster_array.shape[1]:        return raster_array[row, col]    else:        return np.nan# Sample NDVI at each province centroidndvi_values = []for idx, row in philippines_gdf.iterrows():    centroid = row['centroid']    ndvi_val = sample_raster_at_point(centroid.x, centroid.y, ndvi, transform)    ndvi_values.append(ndvi_val)philippines_gdf['NDVI_Centroid'] = ndvi_valuesprint("="*70)print("MEAN NDVI BY PROVINCE (sampled from real Sentinel-2 data)")print("="*70)print(f"{'Province':&lt;25} {'NDVI':&gt;10} {'Vegetation Class':&gt;20}")print("-"*70)for idx, row in philippines_gdf.iterrows():    ndvi_val = row['NDVI_Centroid']    if np.isnan(ndvi_val):        veg_class = "Outside raster"    elif ndvi_val &lt; 0:        veg_class = "Water/Bare"    elif ndvi_val &lt; 0.2:        veg_class = "Sparse"    elif ndvi_val &lt; 0.5:        veg_class = "Moderate"    elif ndvi_val &lt; 0.8:        veg_class = "Dense"    else:        veg_class = "Very Dense"        print(f"{row['Province']:&lt;25} {ndvi_val:&gt;10.3f} {veg_class:&gt;20}")print("="*70)print("\n✓ NDVI values sampled from real Microsoft Planetary Computer data")print("Note: For accurate zonal statistics covering full polygons,")print("      use the rasterstats library (provides mean, median, min, max per polygon)")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="zonal-statistics---calculate-mean-ndvi-per-province" class="level3">
<h3 class="anchored" data-anchor-id="zonal-statistics---calculate-mean-ndvi-per-province">5.3 Zonal Statistics - Calculate Mean NDVI per Province</h3>
<div id="cell-65" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save NDVI calculated from real Sentinel-2 data as GeoTIFFndvi_path = f'{work_dir}/outputs/palawan_ndvi_real.tif'# Create metadata profilendvi_meta = {    'driver': 'GTiff',    'height': height,    'width': width,    'count': 1,    'dtype': 'float32',    'crs': crs,    'transform': transform,    'compress': 'lzw',    'nodata': -9999}with rasterio.open(ndvi_path, 'w', **ndvi_meta) as dst:    dst.write(ndvi.astype('float32'), 1)    dst.set_band_description(1, 'NDVI from Real Sentinel-2 L2A')print(f"✓ Real NDVI saved: {ndvi_path}")# Save updated GeoDataFrame with NDVI valuesvector_path = f'{work_dir}/outputs/provinces_with_real_ndvi.geojson'# Create a copy for saving (to avoid modifying original)gdf_to_save = philippines_gdf.copy()# Convert centroid geometry column to coordinatesif 'centroid' in gdf_to_save.columns:    gdf_to_save['centroid_lon'] = gdf_to_save['centroid'].x    gdf_to_save['centroid_lat'] = gdf_to_save['centroid'].y    gdf_to_save = gdf_to_save.drop(columns=['centroid'])# Save to GeoJSONgdf_to_save.to_file(vector_path, driver='GeoJSON')print(f"✓ Vector data with NDVI saved: {vector_path}")print(f"  Attributes saved: Province, Region, Island_Group, Population, Area, Density, NDVI_Centroid")print(f"  Centroid coordinates saved as: centroid_lon, centroid_lat")print(f"\n✓ All outputs saved to: {work_dir}/outputs/")print(f"  NDVI values are from REAL Sentinel-2 data acquired from Microsoft Planetary Computer!")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="saving-results" class="level3">
<h3 class="anchored" data-anchor-id="saving-results">5.4 Saving Results</h3>
<div id="cell-67" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BEST PRACTICES FOR MEMORY MANAGEMENT:</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"1. ALWAYS use context managers (with statements):"</span>)<span class="bu">print</span>(<span class="st">"   ✓ with rasterio.open('file.tif') as src:"</span>)<span class="bu">print</span>(<span class="st">"       data = src.read()"</span>)<span class="bu">print</span>(<span class="st">"   ✗ src = rasterio.open('file.tif')  # Don't forget to close!</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"2. Read only what you need:"</span>)<span class="bu">print</span>(<span class="st">"   ✓ band = src.read(1)  # Single band"</span>)<span class="bu">print</span>(<span class="st">"   ✗ all_bands = src.read()  # All bands (if you only need one)</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"3. Use windowed reading for large files (as we did for Palawan data):"</span>)<span class="bu">print</span>(<span class="st">"   from rasterio.windows import Window"</span>)<span class="bu">print</span>(<span class="st">"   window = Window(0, 0, 1000, 1000)  # 1000x1000 subset"</span>)<span class="bu">print</span>(<span class="st">"   data = src.read(1, window=window)"</span>)<span class="bu">print</span>(<span class="st">"   ✓ We used this to load only 1000x1000 pixels instead of the full scene!</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"4. Process in chunks for very large datasets:"</span>)<span class="bu">print</span>(<span class="st">"   for ji, window in src.block_windows(1):"</span>)<span class="bu">print</span>(<span class="st">"       data = src.read(1, window=window)"</span>)<span class="bu">print</span>(<span class="st">"       # Process chunk"</span>)<span class="bu">print</span>(<span class="st">"       # Write result</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"5. Delete large arrays when done:"</span>)<span class="bu">print</span>(<span class="st">"   del large_array"</span>)<span class="bu">print</span>(<span class="st">"   import gc; gc.collect()  # Force garbage collection</span><span class="ch">\n</span><span class="st">"</span>)<span class="bu">print</span>(<span class="st">"6. Use cloud-optimized data sources:"</span>)<span class="bu">print</span>(<span class="st">"   ✓ Microsoft Planetary Computer, AWS Open Data"</span>)<span class="bu">print</span>(<span class="st">"   ✓ Cloud-optimized GeoTIFF (COG) format"</span>)<span class="bu">print</span>(<span class="st">"   ✓ Stream only the data you need without downloading entire files"</span>)<span class="bu">print</span>(<span class="st">"   ✓ This is how we accessed real Sentinel-2 data in this notebook!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="part-6-best-practices-and-common-pitfalls" class="level2">
<h2 class="anchored" data-anchor-id="part-6-best-practices-and-common-pitfalls">Part 6: Best Practices and Common Pitfalls</h2>
<section id="memory-management" class="level3">
<h3 class="anchored" data-anchor-id="memory-management">6.1 Memory Management</h3>
<div id="cell-69" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BEST PRACTICES FOR MEMORY MANAGEMENT:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. ALWAYS use context managers (with statements):"</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   ✓ with rasterio.open('file.tif') as src:"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"       data = src.read()"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   ✗ src = rasterio.open('file.tif')  # Don't forget to close!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"2. Read only what you need:"</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   ✓ band = src.read(1)  # Single band"</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   ✗ all_bands = src.read()  # All bands (if you only need one)</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"3. Use windowed reading for large files:"</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   from rasterio.windows import Window"</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   window = Window(0, 0, 1000, 1000)  # 1000x1000 subset"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   data = src.read(1, window=window)</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"4. Process in chunks for very large datasets:"</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   for ji, window in src.block_windows(1):"</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"       data = src.read(1, window=window)"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"       # Process chunk"</span>)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"       # Write result</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5. Delete large arrays when done:"</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   del large_array"</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   import gc; gc.collect()  # Force garbage collection"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="crs-alignment---critical" class="level3">
<h3 class="anchored" data-anchor-id="crs-alignment---critical">6.2 CRS Alignment - CRITICAL!</h3>
<div id="cell-71" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"CRS (Coordinate Reference System) ALIGNMENT:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ALWAYS check CRS before combining data!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Check and align CRS</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Step 1: Check CRS"</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Vector CRS: </span><span class="sc">{</span>philippines_gdf<span class="sc">.</span>crs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Raster CRS: </span><span class="sc">{</span>src<span class="sc">.</span>crs<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Step 2: Reproject if needed"</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  if vector.crs != raster.crs:"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      vector = vector.to_crs(raster.crs)"</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      print('Vector reprojected!')</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COMMON CRS IN PHILIPPINES:"</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:4326  - WGS84 Geographic (lat/lon in degrees)"</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:32651 - WGS84 / UTM Zone 51N (meters, for Luzon/Visayas)"</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:32652 - WGS84 / UTM Zone 52N (meters, for Mindanao)"</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:3123  - PRS92 / Philippines Zone I"</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:3124  - PRS92 / Philippines Zone II"</span>)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  EPSG:3125  - PRS92 / Philippines Zone III</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"PRO TIP: Use UTM for accurate area/distance calculations!"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="handling-nodata-values" class="level3">
<h3 class="anchored" data-anchor-id="handling-nodata-values">6.3 Handling NoData Values</h3>
<div id="cell-73" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"HANDLING NODATA VALUES:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for nodata value</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Current raster nodata value: </span><span class="sc">{</span>src<span class="sc">.</span>nodata<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 1: Read with masked=True"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  data = src.read(1, masked=True)  # Returns np.ma.MaskedArray"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  valid_mean = data.mean()  # Automatically ignores nodata"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 2: Manual masking"</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  data = src.read(1)"</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  if src.nodata is not None:"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      valid_data = data[data != src.nodata]"</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"      valid_mean = valid_data.mean()"</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Method 3: NumPy masked arrays"</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  import numpy.ma as ma"</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  masked_data = ma.masked_equal(data, src.nodata)"</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  valid_mean = masked_data.mean()"</span>)</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">WHY IT MATTERS:"</span>)</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  NoData pixels can skew statistics if not handled!"</span>)</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"  Example: mean() of [100, 100, -9999] = -3266 (WRONG!)"</span>)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"           mean() excluding nodata = 100 (CORRECT!)"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="common-errors-and-solutions" class="level3">
<h3 class="anchored" data-anchor-id="common-errors-and-solutions">6.4 Common Errors and Solutions</h3>
<div id="cell-75" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"COMMON ERRORS AND SOLUTIONS:</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. 'ValueError: cannot set EPSG:4326 CRS'"</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: CRS already set or incompatible"</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: gdf.set_crs('EPSG:4326', allow_override=True)</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"2. 'IndexError: index 1 is out of bounds'"</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: Trying to read band that doesn't exist"</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: Check src.count before reading"</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        bands = src.read([1, 2, 3])  # Read multiple</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"3. 'TypeError: integer argument expected, got float'"</span>)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: Pixel coordinates must be integers"</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: row, col = int(row), int(col)</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"4. 'MemoryError: Unable to allocate array'"</span>)</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: Trying to load massive raster into memory"</span>)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: Use windowed reading or downsample"</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        data = src.read(1, out_shape=(500, 500))</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5. 'RuntimeWarning: invalid value encountered in divide'"</span>)</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: Division by zero in NDVI/NDWI calculation"</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: Use np.where() to handle zero denominators"</span>)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        ndvi = np.where(denom != 0, (nir-red)/denom, 0)</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"6. 'GeoDataFrame.to_file() slow for large datasets'"</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   CAUSE: Shapefile format is slow"</span>)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   FIX: Use GeoPackage or GeoJSON"</span>)</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"        gdf.to_file('data.gpkg', driver='GPKG')  # Faster!</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">70</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="summary-and-key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="summary-and-key-takeaways">Summary and Key Takeaways</h2>
<section id="what-youve-learned-today" class="level3">
<h3 class="anchored" data-anchor-id="what-youve-learned-today">What You’ve Learned Today:</h3>
<section id="geopandas-for-vector-data" class="level4">
<h4 class="anchored" data-anchor-id="geopandas-for-vector-data">1. <strong>GeoPandas for Vector Data</strong></h4>
<p>✓ Loading and inspecting shapefiles/GeoJSON<br>
✓ Filtering by attributes and spatial queries<br>
✓ CRS transformations and projections<br>
✓ Creating professional maps and visualizations<br>
✓ Spatial operations (buffer, intersection, union)</p>
</section>
<section id="rasterio-for-raster-data" class="level4">
<h4 class="anchored" data-anchor-id="rasterio-for-raster-data">2. <strong>Rasterio for Raster Data</strong></h4>
<p>✓ Reading multi-band satellite imagery<br>
✓ Extracting metadata and band information<br>
✓ Processing bands as NumPy arrays<br>
✓ Calculating statistics and percentiles<br>
✓ Creating RGB and false color composites</p>
</section>
<section id="vegetation-indices" class="level4">
<h4 class="anchored" data-anchor-id="vegetation-indices">3. <strong>Vegetation Indices</strong></h4>
<p>✓ NDVI calculation and interpretation<br>
✓ NDWI for water body detection<br>
✓ Histogram analysis and thresholding<br>
✓ Land cover classification based on indices</p>
</section>
<section id="integrated-workflows" class="level4">
<h4 class="anchored" data-anchor-id="integrated-workflows">4. <strong>Integrated Workflows</strong></h4>
<p>✓ Clipping rasters to vector boundaries<br>
✓ Overlaying vectors on rasters<br>
✓ Zonal statistics (per-province analysis)<br>
✓ Saving results in multiple formats</p>
</section>
<section id="best-practices" class="level4">
<h4 class="anchored" data-anchor-id="best-practices">5. <strong>Best Practices</strong></h4>
<p>✓ Memory management techniques<br>
✓ CRS alignment (CRITICAL!)<br>
✓ NoData value handling<br>
✓ Error prevention and debugging</p>
<hr>
</section>
</section>
<section id="why-this-matters-for-aiml" class="level3">
<h3 class="anchored" data-anchor-id="why-this-matters-for-aiml">Why This Matters for AI/ML</h3>
<p><strong>These skills are ESSENTIAL for:</strong></p>
<ol type="1">
<li><strong>Data Preparation</strong>
<ul>
<li>Loading training data (labeled polygons)</li>
<li>Preprocessing satellite imagery</li>
<li>Creating feature layers for models</li>
</ul></li>
<li><strong>Feature Engineering</strong>
<ul>
<li>Calculating spectral indices (NDVI, NDWI, etc.)</li>
<li>Extracting texture features</li>
<li>Creating multi-temporal composites</li>
</ul></li>
<li><strong>Model Training</strong>
<ul>
<li>Sampling training pixels</li>
<li>Creating validation datasets</li>
<li>Balancing class distributions</li>
</ul></li>
<li><strong>Result Analysis</strong>
<ul>
<li>Visualizing model predictions</li>
<li>Calculating accuracy metrics</li>
<li>Validating against ground truth</li>
</ul></li>
<li><strong>Deployment</strong>
<ul>
<li>Processing new satellite scenes</li>
<li>Generating operational products</li>
<li>Creating decision support maps</li>
</ul></li>
</ol>
<hr>
</section>
<section id="philippine-eo-applications" class="level3">
<h3 class="anchored" data-anchor-id="philippine-eo-applications">Philippine EO Applications</h3>
<p><strong>You can now build applications for:</strong></p>
<p><strong>Disaster Risk Reduction (DRR):</strong> - Flood extent mapping using NDWI - Landslide susceptibility analysis - Typhoon damage assessment</p>
<p><strong>Climate Change Adaptation (CCA):</strong> - Vegetation health monitoring (NDVI) - Drought impact assessment - Coastal erosion detection</p>
<p><strong>Natural Resource Management (NRM):</strong> - Forest cover monitoring - Agricultural land mapping - Marine protected area monitoring</p>
<hr>
</section>
</section>
<section id="next-session-google-earth-engine-python-api" class="level2">
<h2 class="anchored" data-anchor-id="next-session-google-earth-engine-python-api">Next Session: Google Earth Engine Python API</h2>
<p><strong>Session 4 will cover:</strong> - Accessing petabytes of satellite data in the cloud - Processing Sentinel-1 and Sentinel-2 at scale - Cloud masking and temporal compositing - Exporting data for ML workflows - Integrating GEE with local Python analysis</p>
<p><strong>Preview:</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ee</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ee.Initialize()</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Access entire Sentinel-2 archive</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> ee.ImageCollection(<span class="st">'COPERNICUS/S2_SR_HARMONIZED'</span>) <span class="op">\</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    .filterBounds(palawan) <span class="op">\</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    .filterDate(<span class="st">'2024-01-01'</span>, <span class="st">'2024-12-31'</span>) <span class="op">\</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">map</span>(mask_clouds)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create cloud-free composite</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>composite <span class="op">=</span> s2.median()</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate NDVI at planetary scale!</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>ndvi <span class="op">=</span> composite.normalizedDifference([<span class="st">'B8'</span>, <span class="st">'B4'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<section id="documentation" class="level3">
<h3 class="anchored" data-anchor-id="documentation">Documentation</h3>
<ul>
<li><strong>GeoPandas:</strong> https://geopandas.org/</li>
<li><strong>Rasterio:</strong> https://rasterio.readthedocs.io/</li>
<li><strong>NumPy:</strong> https://numpy.org/doc/</li>
<li><strong>Matplotlib:</strong> https://matplotlib.org/</li>
</ul>
</section>
<section id="tutorials" class="level3">
<h3 class="anchored" data-anchor-id="tutorials">Tutorials</h3>
<ul>
<li><strong>Carpentries Geospatial Python:</strong> https://carpentries-incubator.github.io/geospatial-python/</li>
<li><strong>Earth Data Science:</strong> https://www.earthdatascience.org/</li>
<li><strong>Python for Geospatial Analysis:</strong> https://www.tomasbeuzen.com/python-for-geospatial-analysis/</li>
</ul>
</section>
<section id="philippine-data-sources" class="level3">
<h3 class="anchored" data-anchor-id="philippine-data-sources">Philippine Data Sources</h3>
<ul>
<li><strong>PhilSA:</strong> https://philsa.gov.ph/</li>
<li><strong>NAMRIA Geoportal:</strong> https://www.geoportal.gov.ph/</li>
<li><strong>DOST-ASTI DATOS:</strong> https://asti.dost.gov.ph/</li>
<li><strong>HDX Philippines:</strong> https://data.humdata.org/group/phl</li>
<li><strong>HazardHunterPH:</strong> https://hazardhunter.georisk.gov.ph/</li>
</ul>
</section>
<section id="books" class="level3">
<h3 class="anchored" data-anchor-id="books">Books</h3>
<ul>
<li><em>Geoprocessing with Python</em> (Garrard)</li>
<li><em>Learning Geospatial Analysis with Python</em> (Lawhead)</li>
<li><em>Python for Data Analysis</em> (McKinney)</li>
</ul>
<hr>
</section>
</section>
<section id="practice-exercises-optional-homework" class="level2">
<h2 class="anchored" data-anchor-id="practice-exercises-optional-homework">Practice Exercises (Optional Homework)</h2>
<p>To reinforce your learning:</p>
<section id="exercise-a-multi-province-analysis" class="level3">
<h3 class="anchored" data-anchor-id="exercise-a-multi-province-analysis">Exercise A: Multi-Province Analysis</h3>
<p>Calculate and compare NDVI statistics for all provinces in one island group.</p>
</section>
<section id="exercise-b-time-series-simulation" class="level3">
<h3 class="anchored" data-anchor-id="exercise-b-time-series-simulation">Exercise B: Time-Series Simulation</h3>
<p>Create multiple synthetic images representing different seasons and analyze NDVI changes.</p>
</section>
<section id="exercise-c-custom-index" class="level3">
<h3 class="anchored" data-anchor-id="exercise-c-custom-index">Exercise C: Custom Index</h3>
<p>Research and implement another vegetation index (EVI, SAVI, or MSAVI).</p>
</section>
<section id="exercise-d-real-data" class="level3">
<h3 class="anchored" data-anchor-id="exercise-d-real-data">Exercise D: Real Data</h3>
<p>Download actual Sentinel-2 data from Copernicus Data Space and apply these techniques.</p>
</section>
<section id="exercise-e-water-detection" class="level3">
<h3 class="anchored" data-anchor-id="exercise-e-water-detection">Exercise E: Water Detection</h3>
<p>Use NDWI to create a binary water mask and calculate total water area.</p>
<hr>
</section>
</section>
<section id="clean-up" class="level2">
<h2 class="anchored" data-anchor-id="clean-up">Clean Up</h2>
<div id="cell-78" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Close raster file</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>src.close()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean up temporary files (optional)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>temp_files <span class="op">=</span> [raster_path]</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> temp_files:</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.exists(f):</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>        os.remove(f)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Removed: </span><span class="sc">{</span>f<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">✓ Cleanup complete!"</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Your outputs are saved in: </span><span class="sc">{</span>work_dir<span class="sc">}</span><span class="ss">/outputs/"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="congratulations" class="level1">
<h1>🎉 Congratulations!</h1>
<p>You’ve completed <strong>Day 1, Session 3</strong> of the CoPhil AI/ML Training!</p>
<section id="you-now-have-the-skills-to" class="level3">
<h3 class="anchored" data-anchor-id="you-now-have-the-skills-to">You now have the skills to:</h3>
<p>✅ Work with vector data using GeoPandas<br>
✅ Process satellite imagery with Rasterio<br>
✅ Calculate vegetation indices (NDVI, NDWI)<br>
✅ Combine vector and raster data<br>
✅ Create professional visualizations<br>
✅ Apply best practices for geospatial Python</p>
</section>
<section id="these-are-the-foundational-skills-for-all-aiml-work-in-earth-observation" class="level3">
<h3 class="anchored" data-anchor-id="these-are-the-foundational-skills-for-all-aiml-work-in-earth-observation">These are the <strong>foundational skills</strong> for ALL AI/ML work in Earth Observation!</h3>
<p><strong>Ready for Session 4?</strong> We’ll take these skills to the cloud with Google Earth Engine!</p>
<hr>
<p><em>🤖 Generated with Claude Code for CoPhil Digital Space Campus</em></p>
<p><em>EU-Philippines Copernicus Capacity Support Programme</em></p>
<p><em>Data-Centric AI for Earth Observation</em></p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="cophil-training-v1.0" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../day1/notebooks/notebook2.html" class="pagination-link" aria-label="Notebook 2: Google Earth Engine">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Notebook 2: Google Earth Engine</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../day1/notebooks/Day1_Session4_Google_Earth_Engine.html" class="pagination-link" aria-label="Day 1, Session 4: Google Earth Engine Python API">
        <span class="nav-page-text">Day 1, Session 4: Google Earth Engine Python API</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>CoPhil EO AI/ML Training Programme</p>
</div>   
    <div class="nav-footer-center">
<p>Funded by the European Union - Global Gateway Initiative</p>
</div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:skotsopoulos@neuralio.ai">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://philsa.gov.ph">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>